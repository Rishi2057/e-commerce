var CS_CONF={projectId:1795,status:1,hostnames:["bestbuy.com"],crossDomainTracking:0,crossDomainSingleIframeTracking:0,consentRequired:1,allowSubdomains:1,visitorCookieTimeout:34164e6,sampleRate:100,replayRecordingRate:0,validationRate:10,lastTrackingDraw:1645469968,trackerDomain:"c.contentsquare.net",recordingDomain:"r.contentsquare.net",useMalkaPipeline:1,ed:"l.contentsquare.net/log/web",eMerchandisingEnabled:1,mouseMoveHeatmapEnabled:1,autoInsightsEnabled:0,jsErrorsEnabled:0,customErrorsEnabled:0,jsCustomErrorsEnabled:0,apiErrorsEnabled:0,customHashIdEnabled:0,recordingEncryptionEnabled:0,recordingEncryptionPublicKey:null,recordingEncryptionPublicKeyId:0,secureCookiesEnabled:0,triggerSessionReplayEnabled:0,triggerSessionReplayRegex:"(.*com\\/site\\/questions\\/.*|.*com\\/site\\/reviews\\/.*)",dynamicIdRegex:"^.+-\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}$",whitelistedAttributes:[],replayRecordingUnmaskedUrlRegex:null,replayRecordingUnmaskedUrlRegexRules:[],replayRecordingMaskedUrlRegexRules:[],replayRecordingMaskedUrlRegex:null,anonymisationMethod:"replayRecordingUnmaskedUrlRegex",tagDeploymentMode:"CONTENTSQUARE",experimental:null,iframesTracking:0,textVisibilityEnabled:0,cookielessTrackingEnabled:0,malkaUrlEnabled:1,malkaEtrEnabled:0,pathComputationRules:{reliableSelectors:[],uniqueAttributes:[],uniqueCssSelectors:[]},asyncSerializerEnabled:1,pendingInactivityTimeout:5e3,accessibilityEnabled:0,uxaDomain:"app.contentsquare.com",webviewsTrackingEnabled:0,useStaticResourceManager:1,performanceTimingOptions:{withResource:!1,withNavigation:!1},replayConsentRequiredForSession:0,displayAdOptions:null,taskSchedulerOptions:{enabled:1},malkaQuotaServiceDomain:"q-aeu1.contentsquare.net",malkaRecordingDomain:"k-aeu1.contentsquare.net",staticResourceManagerDomain:"srm.ba.contentsquare.net"},CS_INTEGRATIONS_CONF={"opinion-lab":{}};!function(t){var e={};function s(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(i,n,function(e){return t[e]}.bind(null,n));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=1)}([function(t){t.exports=JSON.parse('{"name":"@contentsquare/integration-opinion-lab-contentsquare","version":"2.10.4","scripts":{"build:snippet":"webpack"}}')},function(t,e,s){"use strict";function i(t,e){try{t()}catch(t){window._uxa=window._uxa||[],_uxa.push(["logSnippetError",e,t.message])}}function n(t){return"object"==typeof t&&null!==t}function r(t,e){if(n(window.CS_INTEGRATIONS_CONF)&&n(window.CS_INTEGRATIONS_CONF[t]))return window.CS_INTEGRATIONS_CONF[t][e]}s.r(e);var o,a=s(0),h=a.name,c=a.version,l=function(t){var e,s,n,r;if(i((function(){var i=t.name;n=t.version;var o=i.replace("@contentsquare/integration-","");e=o+"-"+n;var a="-contentsquare";r=new RegExp(a+"$").test(o),s=o.replace(/-contentsquare([^-contentsquare]*)$/,"$1"),r||(a="-cap",r=new RegExp(a+"$").test(o),s=o.replace(/-cap([^-cap]*)$/,"$1"))}),"Shared-Function-readPackageJSON"),r)return{snippetBuildName:e,parameterName:s,snippetVersion:n}}(a);l&&(o=l.parameterName,h=l.snippetBuildName,c=l.snippetVersion),i((function(){window._uxa=window._uxa||[],CS_CONF.integrations=CS_CONF.integrations||[],CS_CONF.integrations.push("Verint (OpinionLab) - v"+c);var t=!1;window.self!=window.top&&(t=CS_CONF.iframesTracking);var e="";"DUAL_COLLECTION"===CS_CONF.tagDeploymentMode&&CS_CONF.ptcPartition?e="M2PCT":"DUAL_COLLECTION"!==CS_CONF.tagDeploymentMode||CS_CONF.ptcPartition?"LOAD_CLICKTALE_PTC"===CS_CONF.tagDeploymentMode?e="M2":"CONTENTSQUARE"===CS_CONF.tagDeploymentMode&&(e="CS"):e="M2PCS";var s=r(o,"settings"),n=!1,a="";s&&(s.indexOf("sendArtificialPageviews")>-1&&(n=!0),s.indexOf("setReplayLinkToFirstPV")>-1&&(a=0));var l=!1;function u(t,e,s,i){t="FB_OL_"+t,_uxa.push(["trackDynamicVariable",{key:t,value:e}]),l&&"etr"===s&&_uxa.push(["trackEventTriggerRecording","@ETS@"+t]),i&&n&&_uxa.push(["trackPageview",window.location.pathname+"?"+i])}function d(){for(var t=0,e=document.domain,s=e.split("."),i="_cs_tld"+(new Date).getTime();t<s.length-1&&-1==document.cookie.indexOf(i+"="+i);)e=s.slice(-1-++t).join("."),document.cookie=i+"="+i+";domain="+e+";SameSite=None;Secure";return document.cookie=i+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;domain="+e+";",e}function p(t){for(var e=t+"=",s=document.cookie.split(";"),i=0;i<s.length;i++){for(var n=s[i];" "==n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(e))return n.substring(e.length,n.length)}return""}function g(){var t={contentsquare_integration:p("_cs_s"),vendor:"opinion-lab"};window.opener?window.opener.postMessage(t,"*"):self!=top&&window.top.postMessage(t,"*")}function m(t){return t.toString().replace(/[^\w. ]/gi,(function(t){return"&#"+t.charCodeAt(0)+";"}))}if(document.location.host.indexOf("opinionlab.com")>-1){if(!t&&window.olData&&(olData.clickTaleUID||olData.contentsquareIDs)){var f="";if((f="M2PCT"===e?olData.clickTaleUID:olData.contentsquareIDs)&&"null"!=f){var y=f.split("~"),E=y[0],S=y[1],v=y[2],w=y[3],R=d();E&&S&&v&&(w?document.cookie="_cs_optout="+w+";domain="+R+";path=/;SameSite=None;Secure":(document.cookie="_cs_optout=;domain="+R+";path=/;expires=Thu, 01-Jan-1970 00:00:01 GMT;SameSite=None;Secure",document.cookie="_cs_optout=;path=/;expires=Thu, 01-Jan-1970 00:00:01 GMT;SameSite=None;Secure",document.cookie="_cs_optout=;domain=."+document.location.host+";path=/;expires=Thu, 01-Jan-1970 00:00:01 GMT;SameSite=None;Secure"),document.cookie="_cs_id="+E+";domain="+R+";path=/;SameSite=None;Secure",document.cookie="_cs_s="+S+";domain="+R+";path=/;SameSite=None;Secure",document.cookie="_cs_c="+v+";domain="+R+";path=/;SameSite=None;Secure")}}function A(){if(!t){var e=p("_cs_s");if(e&&e.indexOf(".T.")>-1)var s=setInterval((function(){(e=p("_cs_s"))&&-1===e.indexOf(".T.")&&(clearInterval(s),g())}),500);else g()}setTimeout((function(){l=_uxa.push(["isRecording"])}),500)}u("Feedback Displayed (All Surveys)","true"),_uxa.push(["afterPageView",function(t){i((function(){A()}),h)}]),window.addEventListener("message",(function(t){"https://secure.opinionlab.com"==t.origin&&i((function(){var e=t.data,s=JSON.parse(e);if("ClicktaleOpinionLab_Submitted"===s.message||"ContentsquareOpinionLab_Submitted"===s.message){var i=s.ccid||"";u("Feedback Submitted","Survey ID : "+i,"etr","cs_opinionlab=feedback_submitted_"+i);var n=s.responseId;n&&u("Response ID ("+i+")",n);var r=s.overallRating;r&&u("Overall Rating ("+i+")",parseInt(r));var o=s.usabilityRating;o&&u("Usability Rating ("+i+")",parseInt(o));var a=s.designRating;a&&u("Design Rating ("+i+")",parseInt(a));var h=s.contentRating;h&&u("Content Rating ("+i+")",parseInt(h));for(var c=Object.keys(s),l=1;l<c.length;l++)if(c[l].indexOf("answer")>-1){var d=s[c[l]],p="";d&&"0"!=d&&(isNaN(d)||(p=" Rating"),u("Custom Answer "+[l]+p+" ("+i+")",d))}}}),h)}))}else{function T(s){if(!t){function g(t){var e=t.data;e&&e.contentsquare_integration&&"opinion-lab"===e.vendor&&i((function(){const t=e.contentsquare_integration,i=t.split("."),n=Number(i[i.length-1]),r=new Date(n).toUTCString();if(window.CS_CONF&&CS_CONF.allowSubdomains){const e=d();document.cookie="_cs_s="+m(t)+";expires="+r+";domain="+e+";path=/"}else document.cookie="_cs_s="+m(t)+";expires="+r+";path=/";T(s)}),h)}window.removeEventListener("message",g),window.addEventListener("message",g)}function n(){var t=p("_cs_id"),i=p("_cs_c"),n=p("_cs_optout"),h=t+"~"+c+"~"+i+"~"+n;if("M2PCT"===e){var u=CS_CONF.ptcPartition,d=CS_CONF.ptcGuid;localStorage.setItem("CTuserID",h),localStorage.setItem("CTpartition",u),localStorage.setItem("CTguid",d),sessionStorage.setItem("CTuserID",h),sessionStorage.setItem("CTpartition",u),sessionStorage.setItem("CTguid",d)}else{var g="";"M2PCS"===e?g=CS_CONF.ptcGuid:(g=r(o,"tagid"))&&(g=g.trim()),localStorage.setItem("CSid",h),localStorage.setItem("CStagID",g),sessionStorage.setItem("CSid",h),sessionStorage.setItem("CStagID",g)}if(l=_uxa.push(["isRecording"])){var m=function(t,e,s){t||(t="missingFromDynamicSnippet");var i=e;if(isNaN(i)&&(e=0),s){var n=s.sessionKey.split("."),r=s.projectId,o=n[0],a=n[1],h=s.pageNumber,c=h-e;return e>=h&&(c=h),0===i&&(c=1),"https://app.contentsquare.com/quick-playback/index.html?pid="+r+"&uu="+o+"&sn="+a+"&pvid="+c+"&recordingType=cs&vd="+t}}("ol",a,s);m&&("M2PCT"===e?(localStorage.setItem("CTrecordingLink",m),sessionStorage.setItem("CTrecordingLink",m)):(localStorage.setItem("CSreplayLink",m),sessionStorage.setItem("CSreplayLink",m)))}else"M2PCT"===e?(localStorage.setItem("CTrecordingLink","Contensquare Not Recording"),sessionStorage.setItem("CTrecordingLink","Contensquare Not Recording")):(localStorage.setItem("CSreplayLink","Contensquare Not Recording"),sessionStorage.setItem("CSreplayLink","Contensquare Not Recording"))}var c=p("_cs_s");if(c&&c.indexOf(".T.")>-1)var u=setInterval((function(){(c=p("_cs_s"))&&-1===c.indexOf(".T.")&&(clearInterval(u),n())}),500);else n()}function _(t){T(t)}_uxa.push(["afterPageView",function(t){i((function(){_(t)}),h)}])}}),h)}]),(()=>{"use strict";var t={d:(e,s)=>{for(var i in s)t.o(s,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:s[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{getRequestParameters:()=>Eo});const s="cs-native-frame",i={navigatorProperties:[{propertyName:"sendBeacon",binding:navigator}],nodeProperties:["childNodes","parentNode","nextSibling","firstChild"],elementProperties:["shadowRoot"],elementPropertiesValues:["matches","mozMatchesSelector","msMatchesSelector","oMatchesSelector","webkitMatchesSelector"],eventProperties:["target"],imageProperties:["src"],constructors:{Date:"csDate",JSON:"csJSON",Array:"csArray",String:"csString",URL:"csURL",MutationObserver:"csMutationObserver",screen:"csScreen"}};function n(t){Object.keys(i.constructors).forEach((e=>{window[i.constructors[e]]=t[e]instanceof Function&&null==t[e].prototype?t[e].bind(window):t[e]})),function(t){window.csquerySelector={1:t.Element.prototype.querySelector,9:t.Document.prototype.querySelector,11:t.DocumentFragment.prototype.querySelector},window.csquerySelectorAll={1:t.Element.prototype.querySelectorAll,9:t.Document.prototype.querySelectorAll,11:t.DocumentFragment.prototype.querySelectorAll}}(t),("Prototype"in window||/^((?!chrome|android).)*safari/i.test(navigator.userAgent))&&(window.csMutationObserver=window.WebKitMutationObserver||window.MutationObserver),r("csNode",i.nodeProperties,t.Node.prototype,"get"),r("csElement",i.elementProperties,t.Element.prototype,"get"),r("csElement",i.elementPropertiesValues,t.Element.prototype,"value",!1),r("csHTMLImageElement",i.imageProperties,t.HTMLImageElement.prototype,"set"),r("csEvent",i.eventProperties,t.Event.prototype,"get"),r("csNavigator",i.navigatorProperties,t.navigator,"value")}function r(t,e,s,i,n=!0){e.forEach((e=>{const r="string"!=typeof e&&"binding"in e,o=r?e.propertyName:e;(n||o in s)&&(window[`${t+o}`]=function(t,e,s){const i=function(t,e){let s,i=t;for(;i&&!(s=Object.getOwnPropertyDescriptor(i,e));)i=Object.getPrototypeOf(i);return s}(t,e);if(!i)return function(){return this[e]};switch(s){case"get":return i.get;case"set":return i.set;case"value":return i.value}}(s,o,i),r&&(window[`${t+o}`]=window[`${t+o}`].bind(e.binding)))}))}function o(t,e){window.CSProtectnativeFunctionsLogs=window.CSProtectnativeFunctionsLogs||{},window.CSProtectnativeFunctionsLogs[t]=e}if(!function(){try{const t=function(){const t=document.createElement("iframe");t.id=s,t.setAttribute("hidden",""),t.setAttribute("title","Intentionally blank"),t.setAttribute("sandbox","allow-same-origin");const e=document.createElement("cs-native-frame-holder");if(e.setAttribute("hidden",""),document.body.appendChild(e),Boolean(Element.prototype.attachShadow)){const s=e.attachShadow({mode:"closed"});return s.innerHTML=t.outerHTML,s.firstElementChild.contentWindow}return e.innerHTML=t.outerHTML,e.firstElementChild.contentWindow}();return!!t&&(window.CSPureWindow=t,n(window.CSPureWindow),!0)}catch(t){return o("Warning",`failed to copy references from pure iframe: ${t.message}`),!1}}())try{n(window)}catch(mr){o("Critical",`failed to copy references from window: ${mr.message}`)}function a(t){return h(csString.prototype.toLowerCase.call(t.localName))}function h(t){return csString.prototype.replace.call(t,/([#;&,.+*~':"!^$[\]()<=>|/%?@`{}\\ ])/g,"\\$1")}function c(t){return 1===t.nodeType}function l(t){return 3===t.nodeType}function u(t){return c(t)&&"source"===t.localName}function d(t){return null!==t&&c(t)&&"picture"===t.localName}function p(t){return c(t)&&"a"===t.localName}function g(t){return function(t){return c(t)&&"link"===t.localName}(t)&&-1!==csString.prototype.indexOf.call(t.rel,"stylesheet")}function m(t){return c(t)&&"img"===t.localName}function f(t){return c(t)&&"style"===t.localName}function y(t){return c(t)&&"input"===t.localName}function E(t){return c(t)&&"textarea"===t.localName}function S(t){return c(t)&&"script"===t.localName}function v(t){return c(t)&&"ownerSVGElement"in t}function w(t){return c(t)&&"select"===t.localName}function R(t){switch(t.nodeType){case 9:case 11:return!0;default:return!1}}function A(t){return 9===t.nodeType}function T(t){return R(t)&&"host"in t&&"mode"in t}function _(t){return c(t)&&!!csElementshadowRoot.apply(t)&&T(csElementshadowRoot.apply(t))}const b=["annotation-xml","color-profile","font-face","font-face-src","font-face-uri","font-face-format","font-face-name","missing-glyph"],C="detached";function N(t){let e=t;const s=[e];for(;null!==csNodeparentNode.apply(e);)e=csNodeparentNode.apply(e),csArray.prototype.push.call(s,e);return O(e)&&csArray.prototype.push.call(s,C),{ancestors:s,selectionRoot:e}}function O(t){return V.isValidElement(t)}const I=window.csElementmatches||window.csElementmatchesSelector||window.csElementmozMatchesSelector||window.csElementmsMatchesSelector||window.csElementoMatchesSelector||window.csElementwebkitMatchesSelector;function P(t,e){return!!e&&csArray.prototype.some.call(e,(e=>I.call(t,e)))}const k=[/\d{4}/,/^ember\d+$/],L="data-cs-override-id";function D(t,e,s,i){const n=i.dynamicIdRegex||null,r=i.dynamicElementNameRegex;let o=a(t);if(r&&r.test(t.localName)&&(o=csString.prototype.replace.call(o,r,"$1@")),function(t,e){const s=M(t);return s&&csString.prototype.match.call(s,/^[\w-]+$/)&&x(L,s,e)}(t,s)){const e=M(t);return{hasUniqueIdentifier:!0,elementSelector:`${o}[${L}="${e}"]`}}const c=function(t,e,s){if(!s.uniqueAttributes)return{success:!1};for(const i of s.uniqueAttributes){const s=t.getAttribute(i);if(null!==s&&x(i,s,e))return{attributeName:i,attributeValue:s,success:!0}}return{success:!1}}(t,s,i);if(c.success)return{hasUniqueIdentifier:!0,elementSelector:`${o}#UA[${c.attributeName}="${c.attributeValue}"]`};const l=function(t,e,s){if(s.uniqueCssSelectors)for(const i of s.uniqueCssSelectors)if(I.call(t,i)&&U(i,e))return i}(t,s,i);if(l)return{hasUniqueIdentifier:!0,elementSelector:`${o}#UCS[${l}]`};const u=function(t){const e=t.getAttribute("id");return e?h(e):e}(t);if(function(t,e,s,i){return e&&!function(t){return null!==M(t)}(t)&&!function(t,e,s){return t.hasAttribute("data-cs-dynamic-id")||function(t,e){let s=!1;return t&&e&&(s=e.test(t)),t&&(csArray.prototype.some.call(k,(e=>e.test(t)))||s)}(e,s)}(t,e,i)&&function(t,e){return t&&x("id",t,e)}(e,s)}(t,u,s,n))return{hasUniqueIdentifier:!0,elementSelector:`${o}#${u}`};const d=function(t,e){if(e.reliableSelectors)for(const s of e.reliableSelectors)if(I.call(t,s))return s}(t,i);if(d){const s=function(t,e,s){if(t===C||9===t.nodeType)return 0;let i=0,n=e.previousElementSibling;for(;n;)I.call(n,s)&&(i+=1),n=n.previousElementSibling;return i}(e,t,d);return{hasUniqueIdentifier:!1,elementSelector:`${o}[${d}](${s})`}}const p=function(t,e,s){if(t===C||9===t.nodeType)return 0;const i=s.dynamicElementNameRegex,n=!!(null==i?void 0:i.test(e.localName)),r=a(e);let o=0,h=e.previousElementSibling;for(;h;)(a(h)===r||n&&(null==i?void 0:i.test(h.localName)))&&!P(h,s.reliableSelectors)&&(o+=1),h=h.previousElementSibling;return o}(e,t,i);return{hasUniqueIdentifier:!1,elementSelector:`${o}:eq(${p})`}}function M(t){return t.getAttribute(L)}function x(t,e,s){try{return 1===window.csquerySelectorAll[s.nodeType].call(s,`[${t}="${e}"]`).length}catch(t){if("SyntaxError"!==t.name)throw t}return!1}function U(t,e){try{return 1===window.csquerySelectorAll[e.nodeType].call(e,t).length}catch(t){if("SyntaxError"!==t.name)throw t}return!1}function $(t,e,s){const i=csArray.prototype.shift.call(t);if(0===t.length)return z(i,s);const n=i,r=t[0],{elementSelector:o,hasUniqueIdentifier:a}=D(n,r,e,s);if(!s.fullPath&&a)return`${z(t[t.length-1],s)}${o}`;const h=$(t,e,s);return`${h?`${h}>`:""}${o}`}function z(t,e){if(t===C)return"|detached|";if(t.host){const{ancestors:s,selectionRoot:i}=N(t.host);return`${$(s,i,e)}|shadow-root|`}return 11===t.nodeType?"|fragment|":""}var V;!function(t){function e(t){return!!t&&"localName"in t&&"getAttribute"in t&&"hasAttribute"in t&&"parentNode"in t}function s(t){return t&&"jquery"in t&&1===t.length?t[0]:t}t.INVALID_ELEMENT="INVALID_ELEMENT",t.isValidElement=e,t.getElementPath=function(i,n={fullPath:!1,dynamicIdRegex:null}){const r=s(i);if(r===document)return"";if(!e(r))return t.INVALID_ELEMENT;const{ancestors:o,selectionRoot:a}=N(r);return $(o,a,n)},t.getElementPathAndFirstAnchorParent=function(i,n={fullPath:!1,dynamicIdRegex:null}){const r=s(i);if(r===document)return{path:"",firstAnchorParent:null};if(!e(r))return{path:t.INVALID_ELEMENT,firstAnchorParent:null};const{firstAnchorParent:o,ancestors:a,selectionRoot:h}=function(t){let e=t;const s=[e];let i=null;for(;null!==csNodeparentNode.apply(e);)null===i&&p(e)&&(i=e),csArray.prototype.push.call(s,csNodeparentNode.apply(e)),e=csNodeparentNode.apply(e);return O(e)&&csArray.prototype.push.call(s,C),{firstAnchorParent:i,ancestors:s,selectionRoot:e}}(r);return{path:$(a,h,n),firstAnchorParent:o}}}(V||(V={})),window.CSPathComputation=window.CSPathComputation||V;const W=Number.MAX_SAFE_INTEGER||9007199254740991;function B(){}function H(t,e){return 0===csString.prototype.lastIndexOf.call(t,e,0)}const F=34164e6,q={percentage:()=>Math.floor(1e4*Math.random())/100,boolean(t){return this.percentage()<t},integer:(t=W)=>Math.floor(Math.random()*t)},G="function"==typeof Symbol?Symbol("json"):null,Y=G?function(t){if(t[G])return t[G];if(csArray.isArray(t)){if(0===t.length)return"[]";let e="["+Y(t[0]);for(let s=1;s<t.length;s++)e+=","+Y(t[s]);return e+="]"}return t[G]=csJSON.stringify(t)}:csJSON.stringify;class Z{constructor(t){var e,s;this.trackerDomain=t.trackerDomain,this.loggerDomain=t.ed,this.minLogLevel=t.logLevel,this.projectId=t.projectId,this.status=t.status,this.hostnames=t.hostnames,this.iframesTracking=!!t.iframesTracking,this.crossDomainTracking=!!t.crossDomainTracking,this.crossDomainSingleIframeTracking=!!t.crossDomainSingleIframeTracking,this.consentRequired=!!t.consentRequired,this.allowSubdomains=!!t.allowSubdomains,this.visitorCookieTimeout=t.visitorCookieTimeout||F,this.sampleRate=t.sampleRate,this.replayRecordingRate=t.replayRecordingRate,this.validationRate=t.validationRate,this.lastTrackingDraw=t.lastTrackingDraw||1,this.useHttps=!0,this.eMerchandisingEnabled=t.eMerchandisingEnabled,this.mouseMoveHeatmapEnabled=t.mouseMoveHeatmapEnabled,this.jsErrorsEnabled=t.jsErrorsEnabled,this.apiErrors={enabled:null!==(e=t.apiErrorsEnabled)&&void 0!==e?e:0,...t.apiErrors},this.customErrors={enabled:null!==(s=t.customErrorsEnabled)&&void 0!==s?s:0,...t.customErrors},this.jsCustomErrorsEnabled=t.jsCustomErrorsEnabled,this.triggerSessionReplayEnabled=t.triggerSessionReplayEnabled,this.triggerSessionReplayRegex=this.t(t.triggerSessionReplayRegex),this.dynamicIdRegex=t.dynamicIdRegex?new RegExp(t.dynamicIdRegex):null,this.whitelistedAttributes=t.whitelistedAttributes||[],this.replayRecordingUnmaskedUrlRegex=this.t(t.replayRecordingUnmaskedUrlRegex),this.replayRecordingMaskedUrlRegex=this.t(t.replayRecordingMaskedUrlRegex),this.replayRecordingMaskedUrlRegexRules=t.replayRecordingMaskedUrlRegexRules||null,this.replayRecordingUnmaskedUrlRegexRules=t.replayRecordingUnmaskedUrlRegexRules||null,this.anonymisationMethod=t.anonymisationMethod||null,this.tagDeploymentMode=t.tagDeploymentMode,this.dualCollectionTagDomain=t.dualCollectionTagDomain||null,this.ptcDomain=t.ptcDomain||null,this.ptcGuid=t.ptcGuid||null,this.secureCookiesEnabled=!!t.secureCookiesEnabled,this.ptcSha512=t.ptcSha512||null,this.ptcSnapshotPath=t.ptcSnapshotPath||null,this.emitDebugEvents=!1,this.malkaQuotaServiceDomain=t.malkaQuotaServiceDomain||null,this.staticResourceManagerDomain=t.staticResourceManagerDomain||null,this.malkaRecordingDomain=t.malkaRecordingDomain||null,this.textVisibilityEnabled=t.textVisibilityEnabled,this.experimental=t.experimental||{},this.malkaEtrEnabled=!!t.malkaEtrEnabled,this.malkaUrlEnabled=!!t.malkaUrlEnabled,this.cookielessTrackingEnabled=t.cookielessTrackingEnabled,this.customHashIdEnabled=!!t.customHashIdEnabled,this.encryptionEnabled=!!t.recordingEncryptionEnabled,this.encryptionPublicKey=t.recordingEncryptionPublicKey||null,this.pathComputationRules=t.pathComputationRules||{},t.pathComputationRules&&""===t.pathComputationRules.dynamicElementNameRegex&&(this.pathComputationRules.dynamicElementNameRegex=null),t.pathComputationRules&&t.pathComputationRules.dynamicElementNameRegex&&(this.pathComputationRules.dynamicElementNameRegex=new RegExp(t.pathComputationRules.dynamicElementNameRegex)),this.asyncSerializerEnabled=!!t.asyncSerializerEnabled,this.encryptionPublicKeyId=t.recordingEncryptionPublicKeyId,this.pendingInactivityTimeout=t.pendingInactivityTimeout||5e3,this.accessibilityEnabled=!!t.accessibilityEnabled,this.useStaticResourceManager=!!t.useStaticResourceManager,t.taskSchedulerOptions&&(this.taskSchedulerOptions={...t.taskSchedulerOptions,enabled:!!t.taskSchedulerOptions.enabled}),this.uxaDomain=t.uxaDomain,this.performanceTimingOptions=t.performanceTimingOptions,this.replayConsentRequiredForSession=!!t.replayConsentRequiredForSession,this.isWebView=!1,t.displayAdOptions&&t.displayAdOptions.length&&(this.displayAdOptions=t.displayAdOptions)}getTrackerUri(){return`${this.i()}://${this.trackerDomain}`}getRecordingUri(){return`${this.i()}://${this.malkaRecordingDomain}`}getQuotaServiceUri(){return`${this.i()}://${this.malkaQuotaServiceDomain}`}getLoggerUri(){return`${this.i()}://${this.loggerDomain}`}getStaticResourceManagerUri(){return`${this.i()}://${this.staticResourceManagerDomain}`}i(){return this.useHttps?"https":"http"}isProjectActive(){return 1===this.status}processOptionOverrides(t){t&&t.forEach&&t.forEach((([t,...e])=>{if("setOption"===t){const[t,s]=e;this.h(t,s)}}))}h(t,e){"trackerDomain"===t&&(this.trackerDomain=e),"loggerDomain"===t&&(this.loggerDomain=e),"malkaRecordingDomain"===t&&(this.malkaRecordingDomain=e),"malkaQuotaServiceDomain"===t&&(this.malkaQuotaServiceDomain=e),"staticResourceManagerDomain"===t&&(this.staticResourceManagerDomain=e),"minLogLevel"===t&&(this.minLogLevel=e),"useHttps"===t&&(this.useHttps=!!e),"isWebView"===t&&(this.isWebView=e)}t(t){return t?this.u(t):null}getRequestParameters(){return{pid:`${this.projectId}`}}updateDynamicFields(t,e){"emitDebugEvents"===t&&(this.emitDebugEvents=e),"minLogLevel"===t&&(this.minLogLevel=e)}u(t){try{const e=/^\/(.*)\/([gim]*)$/.exec(t);if(e){const[,t,s]=e;return new RegExp(`^${t}$`,s)}return new RegExp(`^${t}$`)}catch(t){return null}}isHeaderCollectionActive(){var t,e;return this.apiErrors.collectStandardHeaders||!!(null===(t=this.apiErrors.validCustomHeaders)||void 0===t?void 0:t.length)||!!(null===(e=this.apiErrors.plainCustomHeaders)||void 0===e?void 0:e.length)}}class j{constructor(t,e){this.A=t,this._=e}init(){this.R=this.A!==this.A.top,this.S=this._.isWebView&&this.A===this.A.top,this._.iframesTracking&&this.R||this.S?this.T=!1:this.T=!0}isInIframeContext(){return this.R}isTopWindowTracker(){return this.T}isInWebViewContext(){return this.S}}var X,K;!function(t){t.debug="debug",t.warn="warn",t.error="error",t.critical="critical"}(X||(X={})),function(t){t.toQuery=function(t){return csArray.prototype.join.call(csArray.prototype.map.call(Object.keys(t),(e=>`${encodeURIComponent(e)}=${encodeURIComponent(t[e])}`)),"&")}}(K||(K={}));class Q{constructor(t,e){this.domainUri=t,this.path=e,this.beforeRequestCallbacks=[],this.afterRequestCallbacks=[]}setRequestParametersProviders(...t){this.requestParametersProviders=t}before(t){csArray.prototype.push.call(this.beforeRequestCallbacks,t)}after(t){csArray.prototype.push.call(this.afterRequestCallbacks,t)}retrieveParameters(){return this.requestParametersProviders?csArray.prototype.reduce.call(csArray.prototype.map.call(this.requestParametersProviders,(t=>t.getRequestParameters())),((t,e)=>({...t,...e}))):{}}}class J extends Q{constructor(t,e){super(t,e)}send(){csArray.prototype.forEach.call(this.beforeRequestCallbacks,(t=>t()));const t=this.retrieveParameters();this.I(t);const e=K.toQuery(t);this.P(e),csArray.prototype.forEach.call(this.afterRequestCallbacks,(t=>t()))}P(t){const e=new window.Image(1,1);e.onload=B,e.onerror=B,csHTMLImageElementsrc.call(e,`${this.domainUri}${this.path?`/${this.path}`:""}?${t}`)}I(t){t.r=csString.prototype.slice.call(`${Math.random()}`,2,8)}}class tt{constructor(t,e){this.V=t,this.C=e}init(){this.N=new J(this.V.getLoggerUri()),this.N.setRequestParametersProviders(this,this.C)}send(t){this.O=t,this.N.send()}getRequestParameters(){return{a:this.O.app,l:this.O.level,m:this.O.message,s:this.O.stacktrace}}}const et=/[a-zA-Z0-9._%+-]+(?:@|%40|%2540)[a-zA-Z0-9.%-_]+((?:\.|%2[eE])[a-zA-Z0-9-]+)+/g,st=/[a-zA-Z0-9+_-](?:@|%40|%2540)/,it="([-A-Za-z0-9+/=_]|=[^=]|={3,})+",nt=new RegExp(`(ey${it}\\.ey${it}\\.${it})`,"g"),rt=/[0-9]{4}/,ot=/(^|[^a-zA-Z0-9*.,-])([45*][0-9*]{3}([ -]?)[0-9*]{4}\3[0-9*]{4}\3[0-9*]{4})($|[^a-zA-Z0-9*.,-])/g;class at{anonymizePII(t){return"string"==typeof t&&(t=this.anonymizeEmail(t)),t}anonymizeEmail(t){return st.test(t)?csString.prototype.replace.call(t,et,"CS_ANONYMIZED_EMAIL"):t}anonymizeCreditCard(t){return rt.test(t)?csString.prototype.replace.call(t,ot,((t,e,s,i,n)=>{if(-1===csString.prototype.indexOf.call(s,"*")){const e=i.length?csArray.prototype.join.call(csString.prototype.split.call(s,i),""):s;if(!this.k(e))return t}return`${e}CS_ANONYMIZED_PII${n}`})):t}k(t){const e=parseInt(t[t.length-1]);let s=0;for(let e=t.length-2;e>=0;e--){let i=parseInt(t[e]);e%2==0&&(i*=2),s+=Math.floor(i/10)+i%10}return 10-s%10===e}anonymizeJwt(t){return csString.prototype.replace.call(t,nt,"CS_ANONYMIZED_JWT")}anonymizeFields(t,e){return csArray.prototype.forEach.call(e,(e=>{t[e]=this.anonymizeEmail(t[e])})),t}}const ht=()=>void 0!==window.performance&&window.performance.now?window.performance.timing.navigationStart+Math.round(window.performance.now()):csDate.now();function ct(){return Math.floor(ht()/1e3)}function lt(t,e){return 0===csString.prototype.lastIndexOf.call(t,e,0)}function ut(t,e){return-1!==csString.prototype.indexOf.call(t,e,t.length-e.length)}class dt{constructor(t,e){this.$=t,this.L=e}getRequestParameters(){return{d:`${ht()}`,p:this.L.anonymizePII(window.location.href),...this.$.getRequestParameters(),v:"13.89.2"}}}function pt(t){return yt(t)&&("number"==typeof t||t instanceof Number)&&!isNaN(t)}function gt(t){return t===parseInt(t,10)}function mt(t){return yt(t)&&("string"==typeof t||t instanceof csString)}function ft(t){return"object"==typeof t}function yt(t){return void 0!==t}function Et(t){return yt(t)&&null!==t}function St(t){return"function"==typeof t}function vt(t){return t instanceof Element}function wt(t){return t instanceof Error}const Rt="snippet-",At="implementation-snippet-";var Tt,_t;!function(t){t.IMPLEMENTATION="implementation",t.DYNAMIC="dynamic"}(Tt||(Tt={})),function(t){t[t.debug=0]="debug",t[t.warn=1]="warn",t[t.error=2]="error",t[t.critical=3]="critical"}(_t||(_t={}));class bt{constructor(t,e,s){this.M=e,this.L=new at,this.D=_t[X.warn],this.D=_t[t.minLogLevel||X.warn],this.N=s||new tt(t,new dt(t,this.L)),this.U={[X.debug]:[],[X.warn]:[],[X.error]:[],[X.critical]:[]},this.F={implementation:{},dynamic:{}},this.N.init()}send(t,e="",s=X.warn){if(!this.B(s,e))return;csArray.prototype.push.call(this.U[s],e||"");const i={message:this.H(t,e),stacktrace:this.q(t),app:"uxa",level:s};this.N.send(i)}H(t,e){let s=wt(t)?this.L.anonymizePII(t.message||t.toString()):t;return e&&(s+=` ErrorCode: ${e}`),s}q(t){return wt(t)?`${t.stack||"No stacktrace"} ${this.j()}`:this.j()}j(){const t=this.M.getVisitorService(),e=null==t?void 0:t.getVisitor();if(!e)return"No context";const s=this.M.getSessionService(),i=s&&s.getSession(),n={userId:e.id,sessionNumber:e.visitsCount,pageNumber:i&&i.pageNumber};return csJSON.stringify(n)}B(t,e){if(_t[t]<this.D)return!1;if(0===(null==e?void 0:csString.prototype.indexOf.call(e,At,0)))return this.G(e,Tt.IMPLEMENTATION);if(0===(null==e?void 0:csString.prototype.indexOf.call(e,Rt,0)))return this.G(e,Tt.DYNAMIC);const s=this.U[t];return!(s.length>=5||e&&csArray.prototype.some.call(s,(t=>t===e)))}G(t,e){return t in this.F[e]?!(this.F[e][t]>=5||(this.F[e][t]+=1,0)):(this.F[e][t]=1,!0)}}const Ct="undefined"==typeof window,Nt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:process;function Ot(t,e){return void 0!==Nt[t]?Nt[t]:e}const It=!Ct&&document.createElement("a"),Pt=/(:443|:80)$/;function kt(t){return It?(It.href=t,It.href):""}function Lt(t){const e=xt(t);return null===e?"":decodeURIComponent(e.hostname)}function Dt(t,e){return csArray.prototype.some.call(e,(e=>ut(t,`.${e}`)||t===e||""===e))}function Mt(t){return csString.prototype.replace.call(t,Pt,"")}function xt(t){return It&&(lt(t,"http://")||lt(t,"https://"))?(It.href=t,{hash:It.hash,host:Mt(It.host),hostname:It.hostname,href:It.href,origin:It.origin?It.origin:Mt(`${It.protocol}//${It.host}`),pathname:(e=It.pathname,"/"===e[0]?e:`/${e}`),port:It.port,protocol:It.protocol,search:It.search}):null;var e}const Ut="CS_IFRAME_MESSAGE";var $t,zt,Vt,Wt;!function(t){t.AfterPageView="afterPageView",t.GetSessionKey="getSessionKey"}($t||($t={})),function(t){t.Parent="parent",t.Child="child"}(zt||(zt={})),function(t){t.Discovery="discovery",t.Stop="stop",t.RecordingStatus="recordingStatus",t.RecordingEvent="recordingEvent",t.EndOfBufferedMessages="endOfBufferedMessages",t.ChildLogMessage="childLogMessage",t.AnalysisEvent="analysisEvent",t.JavascriptError="javascriptError",t.ApiError="apiError",t.Assets="assets",t.DetailedApiError="detailedApiError",t.EmerchandisingMessage="emerchandisingMessage",t.Commands="commands",t.IntegrationCallback="integrationCallback",t.StaticResource="staticResource",t.TrackingContextResultMessage="trackingContextResultMessage",t.TrackingContextRequestMessage="trackingContextRequestMessage",t.CustomError="customError"}(Vt||(Vt={})),function(t){t.buildBaseMessage=function(t,e,s,i){const n={type:t,from:e,pid:s,signature:Ut};return void 0!==i&&i>=0&&(n.id=i),n},t.isMessageValid=function(t,e,s,i){const n=Lt(t.origin);return!!t.data&&!!t.data.type&&t.data.signature===Ut&&t.data.from===e&&t.data.pid===s&&Dt(n,i)},t.sendPostMessage=function(t,e,s,i){i?t.postMessage(s,e,i):t.postMessage(s,e)},t.getNewChannelMessage=function(){return new MessageChannel},t.sendChannelMessage=function(t,e){t.postMessage(e)},t.closeChannelPort=function(t){t.close()}}(Wt||(Wt={}));class Bt{constructor(t){this.$=t}send(t,e="",s=X.warn){const i={message:t,errorCode:e,level:s},n=Wt.buildBaseMessage(Vt.ChildLogMessage,zt.Child,this.$.projectId);n.content=i,Wt.sendPostMessage(window.parent,"*",n)}}class Ht{setContext(t,e){this.Z=t,this.W=e}getVisitorService(){return this.Z}getSessionService(){return this.W}}const Ft=["t.contentsquare.net","clicktale"];window.addEventListener("error",(t=>{"string"!=typeof t.filename||!csArray.prototype.some.call(Ft,(e=>csString.prototype.indexOf.call(t.filename,e)>-1))||csString.prototype.indexOf.call(t.filename,"blob")>-1&&(null==t.message?void 0:csString.prototype.indexOf.call(t.message,"importScripts"))>-1||qt.error(`Uncaught jsError: filename: ${t.filename} - lineno: ${t.lineno} - colno: ${t.colno} - message: ${t.message} `)}));class qt{constructor(){}static whiteListFilename(t){csArray.prototype.push.call(Ft,t)}static setStrategy(t){qt.K=t}static computeIsActive(t){qt.Y=q.boolean(t),qt.Y?qt.J=q.boolean(10):qt.J=!1}static isLoggingActive(){return qt.Y}static getStrategy(){return qt.K}static debug(t,e=""){qt.Y&&this.K.send(t,e,X.debug)}static warn(t,e=""){qt.Y&&this.K.send(t,e,X.warn)}static error(t,e=""){qt.Y&&this.K.send(t,e,X.error)}static critical(t,e=""){qt.Y&&this.K.send(t,e,X.critical)}static tryToExecute(t,e){return(...s)=>{try{const i=e(...s);return yt(window.Promise)&&i instanceof window.Promise?i.then((t=>t),(e=>this.error(e,t))):i}catch(e){try{this.error(e,t)}catch{}}}}static isPerfLoggingActive(){return qt.J}}qt.Y=!1,qt.J=!1;let Gt={debug(...t){},warn(...t){},error(...t){},critical(...t){}};const Yt=t=>(e,s,i)=>{const n=(null==s?void 0:s.toString())||"",r=t||`${e.constructor&&e.constructor.name}.${n}`;if(i){const t=i.value;i.value=function(...e){return function(t,e){return(...s)=>{try{const i=e(...s);return yt(window.Promise)&&i instanceof window.Promise?i.then((t=>t),(e=>Gt.error(e,t))):i}catch(e){try{Gt.error(e,t)}catch{}}}}(r,t.bind(this))(...e)}}};function Zt(t,e,s,i){var n,r=arguments.length,o=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,s,i);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(o=(r<3?n(o):r>3?n(e,s,o):n(e,s))||o);return r>3&&o&&Object.defineProperty(e,s,o),o}var jt,Xt,Kt,Qt;Object.create,Object.create,function(t){function e(t){const e=new RegExp(`(^|;)[ ]*${t}=([^;]*)`).exec(document.cookie);return e?decodeURIComponent(e[2]):null}function s(e,s,n,r,o,a){const h=encodeURIComponent(`${s}`),c=n===t.CURRENT_DOMAIN?void 0:n,l=i(r);let u=`${e}=${h}${l?`;expires=${l.toUTCString()}`:""};path=/${Et(c)?`;domain=${c}`:""}`;return yt(o)&&o!==Kt.NotSet&&(u=`${u};SameSite=${o}`),yt(a)&&a===Qt.Yes&&(u=`${u};Secure`),document.cookie=u,!0}function i(t){return pt(t)?new csDate(ht()+t):t}function n(t,i){e(t)&&s(t,"",i,new csDate(0)),e(t)&&s(t,"",i,new csDate(0),Kt.None,Qt.Yes)}t.CURRENT_DOMAIN="CURRENT_DOMAIN",t.get=e,t.set=s,t.toExpireDate=i,t.remove=n,t.isCookiePresent=function(){return document.cookie.length>0},t.getRootDomain=function(t,i){const r="_cs_root-domain";let o=e(r);if(null!==o&&"1"!==o)return o;const a=csString.prototype.split.call(window.location.hostname,".");let h=csArray.prototype.pop.call(a);for(;a.length&&(null===o||"1"===o);)h=csArray.prototype.join.call([csArray.prototype.pop.call(a),h],"."),s(r,h,h,void 0,t,i),o=e(r);return n(r,h),h}}(jt||(jt={})),function(t){t.browserIsSafariV12=function(){return window.navigator.vendor&&csString.prototype.indexOf.call(window.navigator.vendor,"Apple")>-1&&window.navigator.appVersion&&csString.prototype.indexOf.call(window.navigator.appVersion,"Version/12.")>-1}}(Xt||(Xt={})),function(t){t.None="None",t.Lax="Lax",t.NotSet="X"}(Kt||(Kt={})),function(t){t[t.Yes=1]="Yes",t[t.No=0]="No"}(Qt||(Qt={}));class Jt{constructor(t,e,s){this.$=t,this.X=e,this.tt=s,this.st=!1,this.it=Kt.NotSet,this.et=Qt.No}getSameSiteFlag(){return this.it}getSecureFlag(){return this.et}getDomain(){return this.nt}getRootDomain(){return this.ht}init(){if(this.$.cookielessTrackingEnabled)return;const t=this.ot(),e=this.ut();this.st=this.lt(t,e),this.st?(this.it=t,this.et=e):this.$.secureCookiesEnabled&&"https:"===this.X.getUrlProtocol()&&(this.et=Qt.Yes),this.ht=this.ft(),this.nt=this.wt(this.ht)}lt(t,e){return!Xt.browserIsSafariV12()&&(jt.set(Jt.COOKIE_TEST_FOR_SAME_SITE,"Test same site",Jt.CURRENT_DOMAIN,void 0,t,e),!!jt.get(Jt.COOKIE_TEST_FOR_SAME_SITE)&&(jt.remove(Jt.COOKIE_TEST_FOR_SAME_SITE,Jt.CURRENT_DOMAIN),!0))}ot(){return"http:"===this.X.getUrlProtocol()?Kt.Lax:this.tt.isSameSiteNoneSecureNeeded()||this.$.crossDomainTracking?Kt.None:Kt.Lax}ut(){return"http:"===this.X.getUrlProtocol()?Qt.No:this.$.secureCookiesEnabled||this.$.crossDomainTracking||this.tt.isSameSiteNoneSecureNeeded()?Qt.Yes:Qt.No}isSameSiteSupported(){return this.st}set(t,e,s){const i=jt.toExpireDate(s);jt.set(t,e,this.nt,i,this.getSameSiteFlag(),this.getSecureFlag())}get(t){const e=new RegExp(`(^|;)[ ]*${t}=([^;]*)`).exec(document.cookie);return e?decodeURIComponent(e[2]):null}delete(t,e){const s=e||this.nt;jt.remove(t,s)}ft(){const t=this.tt.isSameSiteNoneSecureNeeded()&&this.isSameSiteSupported(),e=t?Kt.None:void 0,s=t?Qt.Yes:void 0;return jt.getRootDomain(e,s)}wt(t){return this.$.allowSubdomains?t:jt.CURRENT_DOMAIN}}Jt.CURRENT_DOMAIN="CURRENT_DOMAIN",Jt.COOKIE_TEST_FOR_SAME_SITE="_cs_same_site";const te="_cs_t";class ee{constructor(t,e){this.Et=t,this.$=e,this.yt=!1,this.At=!1}init(){if(!this.$.cookielessTrackingEnabled&&this.Et.isTopWindowTracker()&&"cookie"in document){if(!this.Et.isInIframeContext()&&jt.isCookiePresent())return this.yt=!0,void(this.At=!1);if(jt.set(te,"1",jt.CURRENT_DOMAIN),null!==jt.get(te))return this.yt=!0,this.At=!1,void jt.remove(te,jt.CURRENT_DOMAIN);jt.set(te,"1",jt.CURRENT_DOMAIN,void 0,Kt.None,Qt.Yes),null!==jt.get(te)&&(this.yt=!0,this.At=!0,jt.remove(te,jt.CURRENT_DOMAIN))}}areCookiesEnabled(){return this.yt}isSameSiteNoneSecureNeeded(){return this.At}}class se{constructor(t,e){this.$=t,this.tt=e}canTrack(){return this.$.isProjectActive()&&this.gt()&&this.vt()&&this._t()}canTrackInChild(){return this.$.isProjectActive()&&this.Rt()&&(this.vt()||this.St())}_t(){return this.$.cookielessTrackingEnabled?function(){const t="CSSessionStorageTest";try{return sessionStorage.setItem(t,t),sessionStorage.getItem(t)===t&&(sessionStorage.removeItem(t),!0)}catch{return!1}}():this.tt.areCookiesEnabled()}vt(){return Dt(window.location.hostname,this.$.hostnames)}gt(){return!this.Tt()&&this.It()}Rt(){return!this.Tt()&&this.Pt()}St(){return H(window.location.href,"about:srcdoc")&&"about:"===window.location.protocol&&""===window.location.hostname}Tt(){return"visibilityState"in document&&"prerender"===document.visibilityState}It(){return this.bt()&&!!window.localStorage}Pt(){return this.bt()}bt(){return"pageXOffset"in window&&"pageYOffset"in window&&"onpagehide"in window&&"JSON"in window&&"parse"in window.csJSON&&"stringify"in window.csJSON&&"addEventListener"in window&&"removeEventListener"in window&&"Node"in window&&"filter"in csArray.prototype&&"forEach"in csArray.prototype&&"querySelectorAll"in document&&"now"in csDate&&"keys"in Object&&"performance"in window&&"Map"in window&&"Set"in window}}class ie{constructor(t){this.Vt=!1,this.Ct=new Map,this.Nt=new Map,this.Ot=new Map,this.kt="CS_WORKER_SIGNATURE";const e=`\n    const algorithm = ${t.algorithm};\n    const compressor = (${t.getCompressorSourceCode()})();\n    (()=>{"use strict";var e,t;!function(e){e.UNCOMPRESSED="0",e.GZIP="2"}(e||(e={}));class s{constructor(e){this.queryParams={},this.headers={},this.handleRecoveredRequests=e=>{for(const t of e){const{metadata:e,events:s}=t;this.send(s,e)}},this.endpoint=e.endpoint,this.compressionOpts=e.compressionOpts,this.recoveryStorage=e.recoveryStorage,this.recoveryStorage&&this.recoveryStorage.recover(this.handleRecoveredRequests)}setQueryParams(e){Object.keys(e).forEach((t=>{this.queryParams[t]=e[t]}))}removeQueryParams(e){e?e.forEach((e=>{delete this.queryParams[e]})):this.queryParams={}}send(t,s){const r=s||{...this.queryParams},a=!("ct"in r),o="string"!=typeof t&&!this.isArrayBuffer(t);"ct"in r||(this.compressionOpts&&a?r.ct=this.compressionOpts.compressionType:r.ct=e.UNCOMPRESSED);const i=o?JSON.stringify(t):t,n=Object.keys(r).map((e=>\`\${encodeURIComponent(e)}=\${encodeURIComponent(r[e])}\`)).join("&"),h=\`\${this.endpoint}?\${n}\`;this.compressionOpts&&a&&"string"==typeof i?this.compressionOpts.compressor(i,this.compressionOpts.compressionOutputType,(e=>this.doSend(h,r,e))):this.doSend(h,r,i)}onLoad(e){this.onLoadCallback=e}onError(e){this.onErrorCallback=e}onTimeout(e,t){this.onTimeoutCallback=e,this.timeout=t}abort(){this.abortCurrentXhrCall&&this.abortCurrentXhrCall()}setRequestHeader(e,t){this.headers[e]=t}getQueryParams(){return this.queryParams}isArrayBuffer(e){return e&&void 0!==e.byteLength}doSend(e,t,s){const r=new XMLHttpRequest,a=Object.keys(t).map((e=>\`\${encodeURIComponent(e)}=\${encodeURIComponent(t[e])}\`)).join("&");r.open("POST",e),r.onload=()=>{if(this.recoveryStorage&&this.recoveryStorage.recover(this.handleRecoveredRequests),this.onLoadCallback){const e={params:t,responseText:r.responseText,status:r.status};this.onLoadCallback(e)}},r.onerror=()=>{this.recoveryStorage&&this.recoveryStorage.save({key:a,metadata:t,events:s}),this.onErrorCallback&&this.onErrorCallback({params:t})},this.timeout&&this.onTimeoutCallback&&(r.timeout=this.timeout,r.ontimeout=()=>{this.onTimeoutCallback()}),this.abortCurrentXhrCall=()=>r.abort(),Object.keys(this.headers).forEach((e=>{r.setRequestHeader(e,this.headers[e])})),r.send(s)}}class r{constructor(e){this.maxStoredBytes=e,this.storageBytesUsed=0}addString(e){this.storageBytesUsed+=2*e.length}addArrayBuffer(e){this.storageBytesUsed+=e.byteLength}isThresholdReached(){return this.storageBytesUsed>this.maxStoredBytes}reset(){this.storageBytesUsed=0}}class a{constructor(e){this.ramStorage={},this.byteSizeCounter=new r(e)}save({key:e,metadata:t,events:s}){this.byteSizeCounter.isThresholdReached()||(this.byteSizeCounter.addString(e),"string"==typeof s?this.byteSizeCounter.addString(s):this.byteSizeCounter.addArrayBuffer(s),this.byteSizeCounter.isThresholdReached()||(this.ramStorage[e]={metadata:t,events:s}))}recover(e){const t=[];this.getStorageKeys().forEach((e=>{const s=this.ramStorage[e];void 0!==s&&(delete s.metadata.datatype,t.push(s),this.removeItem(e))})),0!==t.length&&(e(t),this.byteSizeCounter.reset())}getStorageKeys(){return Object.keys(this.ramStorage)}removeItem(e){delete this.ramStorage[e]}}!function(e){e[e.NOT_STARTED=0]="NOT_STARTED",e[e.OPEN_IN_PROGRESS=1]="OPEN_IN_PROGRESS",e[e.OPEN_FAILED=2]="OPEN_FAILED",e[e.READY=3]="READY"}(t||(t={}));class o{constructor(e,s,a){this.storageName=e,this.onOpenError=a,this.cacheState=t.NOT_STARTED,this.toBeSavedBuffer=[],this.recoveryInProgress=0,this.origin=self.origin,this.context="object"==typeof window?"":"worker-",this.byteSizeCounter=new r(s),this.init()}async init(){await this.openCache(),this.cacheState===t.READY?this.flushToBeSavedBuffer():this.onOpenError(this.toBeSavedBuffer)}flushToBeSavedBuffer(){this.toBeSavedBuffer.forEach((e=>{this.save(e)})),this.toBeSavedBuffer=[]}async save(e){try{if(this.cacheState===t.OPEN_IN_PROGRESS)return void this.toBeSavedBuffer.push(e);if(this.cacheState!==t.READY)return;if(this.byteSizeCounter.isThresholdReached())return;const{key:s,metadata:r,events:a}=e;if(this.byteSizeCounter.addString(s),"string"==typeof a?this.byteSizeCounter.addString(a):this.byteSizeCounter.addArrayBuffer(a),this.byteSizeCounter.isThresholdReached())return;await this.cache.put(\`\${this.origin}/\${s}\`,new Response(a,{headers:r}))}catch{}}async recover(e){(this.cache||(await this.openCache(),this.cacheState===t.READY))&&this.doRecover(e)}async openCache(){try{this.cacheState=t.OPEN_IN_PROGRESS,this.cache=await self.caches.open(\`\${this.context}\${this.storageName}\`),this.cacheState=t.READY}catch{this.cacheState=t.OPEN_FAILED}}async doRecover(e){try{if(this.recoveryInProgress++,this.recoveryInProgress>1)return;const t=await this.cache.keys();if(0===t.length)return;const s=(await this.cache.matchAll()).map((e=>{const t={};e.headers.forEach(((e,s)=>{t[s]=e})),delete t["content-type"];const s=t.datatype;return delete t.datatype,"json"===s||"base64"===s?e.text().then((e=>({metadata:t,events:e}))):e.arrayBuffer().then((e=>({metadata:t,events:e})))})),r=await Promise.all(s);await Promise.all(t.map((e=>this.cache.delete(e)))),e(r),this.byteSizeCounter.reset()}catch{}finally{this.recoveryInProgress--}}}class i{constructor(e){self.caches?this.setCachesStrategy(e):this.setRamStorageStrategy()}save(e){this.storageStrategy.save(e)}recover(e){this.storageStrategy.recover(e)}setCachesStrategy(e){this.storageStrategy=new o(e,i.MAX_SIZE,(e=>{this.setRamStorageStrategy(e)}))}setRamStorageStrategy(e){this.storageStrategy=new a(i.MAX_SIZE),e&&e.forEach((e=>{this.storageStrategy.save(e)}))}}i.MAX_SIZE=16777216,function(){const e="CS_WORKER_SIGNATURE",t=new Map,r=new i("csPersisted");function a(a){var o;if((o=a)&&o.WORKER_SIGNATURE===e)switch(a.type){case"CreatePostRequest":{const{endpoint:o,compressionOutputType:i,useRetry:n}=a,h={endpoint:o};i&&(h.compressionOpts={compressor,compressionOutputType:i,compressionType:algorithm}),n&&(h.recoveryStorage=r);const c=new s(h);t.set(o,c),c.onLoad((t=>{const s={type:"onLoad",endpoint:o,response:t,WORKER_SIGNATURE:e};self.postMessage(s)})),c.onError((t=>{const s={type:"onError",endpoint:o,response:t,WORKER_SIGNATURE:e};self.postMessage(s)}))}break;case"SetQueryParams":{const{endpoint:e,queryParams:s}=a,r=t.get(e);r&&r.setQueryParams(s)}break;case"RemoveQueryParams":{const{endpoint:e,queryParams:s}=a,r=t.get(e);r&&r.removeQueryParams(s)}break;case"Send":{const{endpoint:e,payload:s,queryParams:r}=a,o=t.get(e);o&&o.send(s,r)}break;case"Abort":{const{endpoint:e}=a,s=t.get(e);s&&s.abort()}break;case"SetHeader":{const{endpoint:e,headerName:s,headerValue:r}=a,o=t.get(e);o&&o.setRequestHeader(s,r)}break;case"SetTimeout":{const{endpoint:s,timeout:r}=a,o=t.get(s);o&&o.onTimeout((()=>{const t={type:"onTimeout",endpoint:s,WORKER_SIGNATURE:e};self.postMessage(t)}),r)}break;default:throw new Error(JSON.stringify(a))}}self.addEventListener("message",(function(e){e.data.getReader?async function(e,t){const s=e.getReader();for(;;){const{done:e,value:r}=await s.read();if(e)break;t(r)}}(e.data,a):a(e.data)}))}()})();`;try{this.$t=this.Lt(e),this.Vt=!0,this.xt()&&(this.Mt=new ReadableStream({start:t=>{this.Dt=t}}),this.$t.postMessage(this.Mt,[this.Mt]),this.postMessage=this.postMessageAsTransferable)}catch(t){this.Vt=!1}}postMessage(t){t.WORKER_SIGNATURE=this.kt,this.$t.postMessage(t)}postMessageAsTransferable(t){t.WORKER_SIGNATURE=this.kt,this.Dt.enqueue(t)}Lt(t){const e=window.csURL||window.webkitURL,s=window.Blob,i=window.Worker,n=new s([t],{type:"application/javascript"}),r=e.createObjectURL(n);qt.whiteListFilename(r);const o=new i(r);return o.onmessage=t=>{const{type:e,endpoint:s,WORKER_SIGNATURE:i}=t.data;if(i===this.kt)if("onLoad"===e){const{response:e}=t.data,i=this.Ct.get(s);i&&i(e)}else if("onError"===e){const{response:e}=t.data,i=this.Nt.get(s);i&&i(e)}else if("onTimeout"===e){const t=this.Ot.get(s);t&&t()}},o}registerOnLoadCallback(t,e){this.Ct.set(t,e)}registerOnErrorCallback(t,e){this.Nt.set(t,e)}registerOnTimeoutCallback(t,e){this.Ot.set(t,e)}isSupported(){return this.Vt}xt(){try{const t=new ReadableStream;return structuredClone(t,{transfer:[t]}),!0}catch{return!1}}}class ne{constructor(t){this.Ut={},this.zt=t.endpoint,this.Ft=t.networkWorker,this.Bt=t.compressionOutputType,this.Ht=t.useRetry,this.Ft.postMessage({type:"CreatePostRequest",endpoint:this.zt,compressionOutputType:this.Bt,useRetry:this.Ht})}setQueryParams(t){this.Ft.postMessage({type:"SetQueryParams",endpoint:this.zt,queryParams:t}),csArray.prototype.forEach.call(Object.keys(t),(e=>{this.Ut[e]=t[e]}))}getQueryParams(){return this.Ut}removeQueryParams(t){this.Ft.postMessage({type:"RemoveQueryParams",endpoint:this.zt,queryParams:t}),t&&csArray.prototype.forEach.call(t,(t=>{delete this.Ut[t]}))}send(t,e){this.Ft.postMessage({type:"Send",endpoint:this.zt,payload:t,queryParams:e})}abort(){this.Ft.postMessage({type:"Abort",endpoint:this.zt})}onLoad(t){this.Ft.registerOnLoadCallback(this.zt,t)}onError(t){this.Ft.registerOnErrorCallback(this.zt,t)}setRequestHeader(t,e){this.Ft.postMessage({type:"SetHeader",endpoint:this.zt,headerName:t,headerValue:e})}onTimeout(t,e){this.Ft.registerOnTimeoutCallback(this.zt,t),this.Ft.postMessage({type:"SetTimeout",endpoint:this.zt,timeout:e})}}var re,oe,ae,he,ce;!function(t){t.UNCOMPRESSED="0",t.GZIP="2"}(re||(re={}));class le{constructor(t){this.onError=t}}class ue{constructor(t){this.Ut={},this.qt={},this.jt=t=>{for(const e of t){const{metadata:t,events:s}=e;this.send(s,t)}},this.zt=t.endpoint,this.Gt=t.compressionOpts,this.Zt=t.recoveryStorage,this.Zt&&this.Zt.recover(this.jt)}setQueryParams(t){Object.keys(t).forEach((e=>{this.Ut[e]=t[e]}))}removeQueryParams(t){t?t.forEach((t=>{delete this.Ut[t]})):this.Ut={}}send(t,e){const s=e||{...this.Ut},i=!("ct"in s),n="string"!=typeof t&&!this.Wt(t);"ct"in s||(this.Gt&&i?s.ct=this.Gt.compressionType:s.ct=re.UNCOMPRESSED);const r=n?JSON.stringify(t):t,o=Object.keys(s).map((t=>`${encodeURIComponent(t)}=${encodeURIComponent(s[t])}`)).join("&"),a=`${this.zt}?${o}`;this.Gt&&i&&"string"==typeof r?this.Gt.compressor(r,this.Gt.compressionOutputType,(t=>this.Kt(a,s,t))):this.Kt(a,s,r)}onLoad(t){this.Yt=t}onError(t){this.Qt=t}onTimeout(t,e){this.Jt=t,this.Xt=e}abort(){this.ss&&this.ss()}setRequestHeader(t,e){this.qt[t]=e}getQueryParams(){return this.Ut}Wt(t){return t&&void 0!==t.byteLength}Kt(t,e,s){const i=new XMLHttpRequest,n=Object.keys(e).map((t=>`${encodeURIComponent(t)}=${encodeURIComponent(e[t])}`)).join("&");i.open("POST",t),i.onload=()=>{if(this.Zt&&this.Zt.recover(this.jt),this.Yt){const t={params:e,responseText:i.responseText,status:i.status};this.Yt(t)}},i.onerror=()=>{this.Zt&&this.Zt.save({key:n,metadata:e,events:s}),this.Qt&&this.Qt({params:e})},this.Xt&&this.Jt&&(i.timeout=this.Xt,i.ontimeout=()=>{this.Jt()}),this.ss=()=>i.abort(),Object.keys(this.qt).forEach((t=>{i.setRequestHeader(t,this.qt[t])})),i.send(s)}}class de{constructor(t){this.es=t,this.Ft=new ie(this.es)}create(t,e,s,i){if(this.Ft.isSupported()&&e)return new ne({networkWorker:this.Ft,endpoint:t,compressionOutputType:s,useRetry:!!i});{const e=s?{compressor:this.es.compress,compressionOutputType:s,compressionType:this.es.algorithm}:void 0;return new ue({endpoint:t,compressionOpts:e,recoveryStorage:i})}}}class pe{constructor(t,e,s,i,n){this.Z=t,this.W=e,this.ns=s,this.rs=i,this.$=n}get(){return{exclusion:this.ns.getAppliedTrackingDraw(),visitor:this.Z.getVisitor(),session:this.W.getSession(),cvars:this.rs.getCustomVariablesSession()}}apply(t){t&&(t.exclusion?this.exclude():this.include(t))}exclude(){this.ns.exclude(this.$),this.Z.removeVisitor(),this.W.removeSession(),this.rs.removeCustomVariablesSession()}include(t){this.ns.removeExclusion(),this.Z.setVisitor(t.visitor),t.session?this.W.setSession(t.session):this.W.removeSession(),t.cvars?this.rs.setCustomVariableSession(t.cvars):this.rs.removeCustomVariablesSession()}}function ge(t,e=!0){t.boundElement.addEventListener(t.type,t.listener,e)}function me(t,e=!0){t.boundElement.removeEventListener(t.type,t.listener,e)}function fe(t,e=0){const s=Math.pow(10,e);return Math.round(t*s)/s}function ye(t,e){"number"==typeof e&&(e={wait:e});const s=e.wait;if(e.ignoreThrottledCalls){let e=0;return function(...i){const n=ht();if(n-e>s)return e=n,t.apply(this,i)}}let i,n,r=[],o=null,a=0;const h=()=>{a=ht(),o=null,n=t.apply(i,r)},c=function(...e){const c=ht(),l=s-(c-a);return i=null!=this?this:window,r=[...e],l<=0||l>s?(a=c,n=t.apply(i,r),o?(window.clearTimeout(o),o=null):r=[]):o||(o=window.setTimeout(h,l)),n};return c.cancel=()=>{o&&(window.clearTimeout(o),a=0,o=null,r=[])},c.flushPending=()=>{o&&(window.clearTimeout(o),h())},c}!function(t){t[t.MUTATION_INSERT=1]="MUTATION_INSERT",t[t.MUTATION_REMOVE=2]="MUTATION_REMOVE",t[t.MUTATION_ATTRIBUTE=3]="MUTATION_ATTRIBUTE",t[t.MUTATION_CHARACTER_DATA=4]="MUTATION_CHARACTER_DATA",t[t.INITIAL_DOM=5]="INITIAL_DOM",t[t.SCROLL=6]="SCROLL",t[t.CLICK=8]="CLICK",t[t.RESIZE=9]="RESIZE",t[t.INPUT_CHECKABLE=10]="INPUT_CHECKABLE",t[t.INPUT_SELECT=11]="INPUT_SELECT",t[t.INPUT_TEXT=12]="INPUT_TEXT",t[t.HASH_CHANGE=13]="HASH_CHANGE",t[t.UNANONYMIZED_CONSENT_GRANTED=14]="UNANONYMIZED_CONSENT_GRANTED",t[t.UNANONYMIZED_CONSENT_WITHDRAWN=15]="UNANONYMIZED_CONSENT_WITHDRAWN",t[t.MOUSE_OVER=16]="MOUSE_OVER",t[t.VISIBILITY_CHANGE=17]="VISIBILITY_CHANGE",t[t.STYLESHEET_RULE_INSERT=18]="STYLESHEET_RULE_INSERT",t[t.STATIC_RESOURCE_URL=19]="STATIC_RESOURCE_URL",t[t.PERFORMANCE_TIMINGS=20]="PERFORMANCE_TIMINGS",t[t.ATTACH_SHADOW=22]="ATTACH_SHADOW",t[t.STYLESHEET_CSS_TEXT_UPDATE=23]="STYLESHEET_CSS_TEXT_UPDATE",t[t.JAVASCRIPT_ERROR=26]="JAVASCRIPT_ERROR",t[t.PAGE_EVENT=27]="PAGE_EVENT",t[t.API_ERROR=28]="API_ERROR",t[t.TEXT_VISIBILITY=29]="TEXT_VISIBILITY",t[t.MUTATION_ENCRYPTED_CHARACTER_DATA=30]="MUTATION_ENCRYPTED_CHARACTER_DATA",t[t.INPUT_ENCRYPTED_TEXT=31]="INPUT_ENCRYPTED_TEXT",t[t.KEY_DOWN=32]="KEY_DOWN",t[t.KEY_UP=33]="KEY_UP",t[t.CLIPBOARD_COMMAND=34]="CLIPBOARD_COMMAND",t[t.STYLESHEET_RULE_DELETE=37]="STYLESHEET_RULE_DELETE",t[t.USER_IDENTIFIER=38]="USER_IDENTIFIER",t[t.TOUCH_START=41]="TOUCH_START",t[t.TOUCH_MOVE=42]="TOUCH_MOVE",t[t.TOUCH_END=43]="TOUCH_END",t[t.GESTURE_RECOGNITION=44]="GESTURE_RECOGNITION",t[t.POINTER_DOWN=47]="POINTER_DOWN",t[t.POINTER_MOVE=48]="POINTER_MOVE",t[t.POINTER_UP=49]="POINTER_UP",t[t.CUSTOM_ERROR=50]="CUSTOM_ERROR",t[t.CUSTOM_ELEMENT_REGISTRATION=54]="CUSTOM_ELEMENT_REGISTRATION",t[t.REGISTER_ADOPTED_STYLE_SHEET=60]="REGISTER_ADOPTED_STYLE_SHEET",t[t.SET_ADOPTED_STYLE_SHEETS=61]="SET_ADOPTED_STYLE_SHEETS",t[t.ADOPTED_STYLESHEET_RULE_INSERT=62]="ADOPTED_STYLESHEET_RULE_INSERT",t[t.ADOPTED_STYLESHEET_RULE_DELETE=63]="ADOPTED_STYLESHEET_RULE_DELETE",t[t.SCREEN_RESIZE=65]="SCREEN_RESIZE",t[t.RESOURCE_HASHES=66]="RESOURCE_HASHES",t[t.PERFORMANCE_NAVIGATION_TIMING=67]="PERFORMANCE_NAVIGATION_TIMING",t[t.PERFORMANCE_RESOURCE_TIMING=68]="PERFORMANCE_RESOURCE_TIMING",t[t.RECORDING_INFO_EVENT=72]="RECORDING_INFO_EVENT",t[t.TEXT_REF=73]="TEXT_REF",t[t.TOUCH_CANCEL=74]="TOUCH_CANCEL",t[t.MUTATION_MOVE=75]="MUTATION_MOVE"}(oe||(oe={})),function(t){t[t.RECORDING_CONSENT_FOR_SESSION_GRANTED=1]="RECORDING_CONSENT_FOR_SESSION_GRANTED",t[t.RECORDING_CONSENT_FOR_SESSION_WITHDRAWN=2]="RECORDING_CONSENT_FOR_SESSION_WITHDRAWN"}(ae||(ae={})),function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right",t[t.Fourth=3]="Fourth",t[t.Fifth=4]="Fifth"}(he||(he={})),function(t){t[t.SWIPE=0]="SWIPE",t[t.PINCH_IN=1]="PINCH_IN",t[t.PINCH_OUT=2]="PINCH_OUT",t[t.LONG_PRESS=3]="LONG_PRESS",t[t.TAP=4]="TAP",t[t.DOUBLE_TAP=5]="DOUBLE_TAP"}(ce||(ce={}));const Ee=t=>(e,s,i)=>{i.value=ye(i.value,t)};var Se,ve;!function(t){t[t.SPACE=0]="SPACE",t[t.ENTER=1]="ENTER",t[t.BACKSPACE=2]="BACKSPACE",t[t.DELETE=3]="DELETE",t[t.ARROWUP=4]="ARROWUP",t[t.ARROWDOWN=5]="ARROWDOWN",t[t.ARROWLEFT=6]="ARROWLEFT",t[t.ARROWRIGHT=7]="ARROWRIGHT",t[t.CAPSLOCK=8]="CAPSLOCK",t[t.SHIFT=9]="SHIFT",t[t.TAB=10]="TAB",t[t.ALPHANUMERICAL=11]="ALPHANUMERICAL",t[t.ESCAPE=12]="ESCAPE",t[t.END=13]="END",t[t.ALT=14]="ALT",t[t.CTRL=15]="CTRL",t[t.META=16]="META"}(Se||(Se={})),function(t){t[t.COPY=0]="COPY",t[t.CUT=1]="CUT",t[t.PASTE=2]="PASTE"}(ve||(ve={}));class we{static isEmpty(){return 0===we.hs.length}static add(t){csArray.prototype.push.call(we.hs,...t)}static getAll(){return we.hs}static clear(){we.hs=[]}}we.hs=[];let Re=50,Ae=.1,Te=!1;const _e=[];let be=[];const Ce=function(t){return function(e,s,i){const n=i.value;i.value=function(){if(!Te)return i.value=n,n.apply(this,arguments);!function(t){csArray.prototype.push.call(_e,t),performance.mark(`${t}-start`)}(t);const e=n.apply(this,arguments);return function(t){const e=performance.measure(t,`${t}-start`);if(!e)return;const s=e.duration;s>=Ae&&csArray.prototype.push.call(be,{mName:t,mDuration:+s.toFixed(2)}),csArray.prototype.pop.call(_e),0===_e.length&&(s>Re&&we.add(be),be=[])}(t),e}}};function Ne(t){const e=csEventtarget.apply(t);return e&&c(e)&&csElementshadowRoot.apply(e)&&t.composedPath?t.__csOriginalTarget||t.composedPath()[0]:e}function Oe(){return(t,e,s)=>{const i=s.value;s.value=function(t,e){!1===(null==t?void 0:t.isTrusted)&&Oe.enabled||i.call(this,t,e)}}}Oe.enabled=!0;const Ie=!!window.chrome,Pe="data-cs-scroll-container";var ke;!function(t){t.isEventOnScrollContainer=function(t){return!!(Et(t)&&function(t){try{if(Et(csEventtarget.apply(t)))return!0}catch{}return!1}(t)&&vt(csEventtarget.apply(t))&&null!==csEventtarget.apply(t).getAttribute(Pe))},t.getScrollContainer=function(){return window.csquerySelector[document.nodeType].call(document,`[${Pe}]`)}}(ke||(ke={}));class Le{constructor(t,e){this.cs=t,this.us=e,this.ls=new Set,this.ds=[],this.fs=[{type:"pointerup",listener:t=>this.pointerUpListener(t),boundElement:document},{type:"pointermove",listener:t=>this.pointerMoveListener(t),boundElement:document},{type:"pointerdown",listener:t=>this.pointerDownListener(t),boundElement:document}],this.ws=[{type:"touchstart",listener:t=>this.touchStartListener(t),boundElement:document},{type:"touchmove",listener:t=>this.touchMoveListener(t),boundElement:document},{type:"touchend",listener:t=>this.touchEndCancelListener(t),boundElement:document},{type:"touchcancel",listener:t=>this.touchEndCancelListener(t),boundElement:document}],this.ps=[{type:"click",listener:t=>this.clickListener(t),boundElement:document},{type:"keyup",listener:t=>this.keyUpListener(t),boundElement:document},{type:"keydown",listener:t=>this.keyDownListener(t),boundElement:document},{type:"copy",listener:t=>this.copyListener(t),boundElement:document},{type:"cut",listener:t=>this.cutListener(t),boundElement:document},{type:"paste",listener:t=>this.pasteListener(t),boundElement:document},{type:"scroll",listener:t=>this.scrollListener(csEventtarget.apply(t)),boundElement:document},{type:"mouseover",listener:t=>this.mouseOverListener(t),boundElement:document}],this.Es=[{type:"scroll",listener:t=>this.scrollListener(csEventtarget.apply(t))}];const s=function(t){if(!mt(t))return null;const e=/iP(ad|hone|od).+Version\/(\d+)\..*Safari/i.exec(t);return e?Number(e[2]):null}(window.navigator.userAgent);(null===s||s&&s>=16)&&csArray.prototype.push.call(this.Es,{type:"mouseover",listener:t=>this.mouseOverListener(t)})}init(){this.ys(),this.As(),this.gs(),this.vs()}vs(){this.cs.onDocumentIdentified((t=>{this._s(t)}))}onEvent(t){csArray.prototype.push.call(this.ds,t)}Rs(t,e=!1){csArray.prototype.forEach.call(this.ds,(s=>s(t,e)))}start(){this.Ss()}stop(){this.Ts()}As(){this.Is()&&csArray.prototype.push.call(this.ps,...this.fs)}ys(){this.Ps()&&csArray.prototype.push.call(this.ps,...this.ws)}_s(t){A(t)?csArray.prototype.forEach.call(this.ps,(t=>ge(t))):this.ls.has(t)||(this.ls.add(t),csArray.prototype.forEach.call(this.Es,(e=>{const s=e;s.boundElement=t,ge(s)})))}bs(t){A(t)?csArray.prototype.forEach.call(this.ps,(t=>me(t))):(this.ls.delete(t),csArray.prototype.forEach.call(this.Es,(e=>{const s=e;s.boundElement=t,me(s)})))}Is(){return"PointerEvent"in window&&"function"==typeof window.PointerEvent}Ps(){return"TouchEvent"in window&&"function"==typeof window.TouchEvent}Ts(){this.bs(document),this.ls.forEach((t=>this.bs(t)))}Ss(){this.Vs()}Vs(){const t=ke.getScrollContainer()||document,e=this.cs.getId(t);if(!e)return;const s=this.Cs(t);if(0!==s.top||0!==s.left){const t={type:oe.SCROLL,args:[e,s.left,s.top],date:ht()};this.Rs(t,!0)}}Cs(t){return t===document?{top:window.pageYOffset,left:window.pageXOffset}:{top:t.scrollTop,left:t.scrollLeft}}scrollListener(t){if(this.us.isSensitive(t)||this.us.isSensitiveChild(t))return;const e=this.cs.getId(t);if(!e)return;const s=this.Cs(t),i={type:oe.SCROLL,args:[e,s.left,s.top],date:ht()};this.Rs(i)}mouseOverListener(t){if(this.us.isSensitiveChild(t.target))return;const e=this.cs.getId(t.target);if(!e)return;const s={type:oe.MOUSE_OVER,args:[e],date:ht()};this.Rs(s)}clickListener(t){const e=Ne(t);if(this.us.isSensitiveChild(e))return;const s=this.cs.getId(e);if(!s)return;const i={type:oe.CLICK,args:[s],date:ht()};this.Rs(i)}keyUpListener(t){const e=Ne(t);if(this.us.isSensitiveChild(e))return;const s=this.cs.getId(e);if(!s)return;const i=this.Ns[t.key];if(void 0===i)return;const n={type:oe.KEY_UP,args:[s,i],date:ht()};this.Rs(n)}keyDownListener(t){const e=Ne(t);if(this.us.isSensitiveChild(e))return;const s=this.cs.getId(e);if(!s)return;const i=this.Ns[t.key];if(void 0===i)return;const n={type:oe.KEY_DOWN,args:[s,i],date:ht()};this.Rs(n)}copyListener(t){const e=Ne(t);if(this.us.isSensitiveChild(e))return;const s=this.cs.getId(e);if(!s)return;const i={type:oe.CLIPBOARD_COMMAND,args:[s,ve.COPY],date:ht()};this.Rs(i)}cutListener(t){const e=Ne(t);if(this.us.isSensitiveChild(e))return;const s=this.cs.getId(e);if(!s)return;const i={type:oe.CLIPBOARD_COMMAND,args:[s,ve.CUT],date:ht()};this.Rs(i)}pasteListener(t){const e=Ne(t);if(this.us.isSensitiveChild(e))return;const s=this.cs.getId(e);if(!s)return;const i={type:oe.CLIPBOARD_COMMAND,args:[s,ve.PASTE],date:ht()};this.Rs(i)}pointerUpListener(t){const e=Ne(t);if(this.us.isSensitiveChild(e))return;const s=this.cs.getId(e);if(!s)return;const i={type:oe.POINTER_UP,args:[t.pointerId,t.pointerType,fe(t.clientX,1),fe(t.clientY,1),s,t.button],date:ht()};this.Rs(i)}pointerMoveListener(t){const e={type:oe.POINTER_MOVE,args:[t.pointerId,t.pointerType,fe(t.clientX,1),fe(t.clientY,1)],date:ht()};this.Rs(e)}pointerDownListener(t){const e=Ne(t);if(this.us.isSensitiveChild(e))return;const s=this.cs.getId(e);if(!s)return;const i={type:oe.POINTER_DOWN,args:[t.pointerId,t.pointerType,fe(t.clientX,1),fe(t.clientY,1),s,t.button,{pageX:fe(t.pageX,1),pageY:fe(t.pageY,1)}],date:ht()};this.Rs(i)}touchStartListener(t){if(!t.changedTouches)return;const{changedTouches:e}=t;for(let t=0;t<e.length;t+=1){const s=e[t],i={type:oe.TOUCH_START,args:[s.identifier,fe(s.clientX,1),fe(s.clientY,1)],date:ht()};this.Rs(i)}}touchMoveListener(t){if(!t.changedTouches)return;const{changedTouches:e}=t;for(let t=0;t<e.length;t+=1){const s=e[t],i={type:oe.TOUCH_MOVE,args:[s.identifier,fe(s.clientX,1),fe(s.clientY,1)],date:ht()};this.Rs(i)}}touchEndCancelListener(t){if(!t.changedTouches)return;const{changedTouches:e}=t;for(let s=0;s<e.length;s+=1){const i=e[s],n={type:"touchend"===t.type?oe.TOUCH_END:oe.TOUCH_CANCEL,args:[i.identifier,fe(i.clientX,1),fe(i.clientY,1)],date:ht()};this.Rs(n)}}gs(){this.Ns={},this.Ns[" "]=Se.SPACE,this.Ns.Spacebar=Se.SPACE,this.Ns.Backspace=Se.BACKSPACE,this.Ns.Enter=Se.ENTER,this.Ns.Delete=Se.DELETE,this.Ns.ArrowUp=Se.ARROWUP,this.Ns.ArrowDown=Se.ARROWDOWN,this.Ns.ArrowLeft=Se.ARROWLEFT,this.Ns.ArrowRight=Se.ARROWRIGHT,this.Ns.Up=Se.ARROWUP,this.Ns.Down=Se.ARROWDOWN,this.Ns.Left=Se.ARROWLEFT,this.Ns.Right=Se.ARROWRIGHT,this.Ns.CapsLock=Se.CAPSLOCK,this.Ns.Shift=Se.SHIFT,this.Ns.Tab=Se.TAB,this.Ns.Escape=Se.ESCAPE,this.Ns.Esc=Se.ESCAPE,this.Ns.End=Se.END,this.Ns.Alt=Se.ALT,this.Ns.Control=Se.CTRL,this.Ns.Meta=Se.META}}function De(t){var e;const s=null!==(e=t.length)&&void 0!==e?e:0,i=new csArray(s);for(let e=0;e<s;e+=1)i[e]=t[e];return i}function Me(t,e,s){let i=0;for(let n=0;n<t.length;n+=1){const r=e(t[n]);for(let t=0;t<r.length;t++)s(r[t],i++)}return[]}function xe(t,e){if(t.length>=0){const s=t.length;for(let i=0;i<s;i++)e(t[i],i)}else{let s=0,i=t.next();for(;!i.done;)e(i.value,s++),i=t.next()}}function Ue(t,e){const s=t.length;for(let i=0;i<s;i++)if(e(t[i],i))return!0;return!1}function $e(t,e){const s=t.length,i=[];for(let n=0;n<s;n+=1){const s=t[n];e(s)&&csArray.prototype.push.call(i,s)}return i}Zt([Ce("RecordingPageEvents.start")],Le.prototype,"start",null),Zt([Yt("scroll")],Le.prototype,"scrollListener",null),Zt([Yt("mouseOver"),Oe(),(t,e,s)=>{const i=s.value;return i&&(s.value=function(t){if(Ne(t)===csEventtarget.apply(t))return i.call(this,t)}),s}],Le.prototype,"mouseOverListener",null),Zt([Yt("click"),Oe()],Le.prototype,"clickListener",null),Zt([Yt("Event handler type: keyup")],Le.prototype,"keyUpListener",null),Zt([Yt("Event handler type: keydown")],Le.prototype,"keyDownListener",null),Zt([Yt("Event handler type: copy")],Le.prototype,"copyListener",null),Zt([Yt("Event handler type: cut")],Le.prototype,"cutListener",null),Zt([Yt("Event handler type: paste")],Le.prototype,"pasteListener",null),Zt([Yt("Event handler type: pointerup"),Oe()],Le.prototype,"pointerUpListener",null),Zt([Yt("Event handler type: pointermove"),Oe(),Ee({wait:33,ignoreThrottledCalls:!0})],Le.prototype,"pointerMoveListener",null),Zt([Yt("Event handler type: pointerdown"),Oe()],Le.prototype,"pointerDownListener",null),Zt([Yt("Event handler type: touchstart"),Oe()],Le.prototype,"touchStartListener",null),Zt([Yt("Event handler type: touchmove"),Oe()],Le.prototype,"touchMoveListener",null),Zt([Yt("Event handler type: touchend-cancel"),Oe()],Le.prototype,"touchEndCancelListener",null);const ze=Ot("queueMicrotask",setTimeout);let Ve=[];function We(t){0==Ve.length&&Be((()=>{for(const t of Ve)t();Ve=[]})),csArray.prototype.push.call(Ve,t)}function Be(t,e=10){ze(0===e?t:()=>Be(t,e-1))}class He{constructor(t,e,s,i,n,r,o=document){this.Os=t,this.ks=e,this.$s=s,this.Ls=i,this.cs=n,this.us=r,this.xs=o,this.Ms=!1,this.Ds=t=>{this.Ls.emitInitialDomDone(t)},this.Us=t=>{const e=this.cs.getId(t.target);if(!e)return;const s=t.target.getBoundingClientRect();if(s.width===t.target.__contentsquare_width&&s.height===t.target.__contentsquare_height)return;t.target.__contentsquare_width=s.width,t.target.__contentsquare_height=s.height;const i={args:[e,null,"style",`width:${s.width}px !important;height:${s.height}px !important;`],date:ht(),type:oe.MUTATION_ATTRIBUTE};this.zs(i)},this.ks.onCharacterDataMutation((t=>{this.Fs(t)})),this.ks.onAttributesMutation((t=>{this.Bs(t)})),this.ks.onChildListMutation(((t,e)=>{xe(t.addedNodes,(t=>{this.us.identifySensitiveNodes(t),this.cs.identifyNodes(t,e)})),this.Hs(t,e),xe(t.removedNodes,(t=>{this.us.unidentifySensitiveNodes(t)}))})),this.ks.onAttachShadowMutation((t=>{t.target.isConnected&&null!==csElementshadowRoot.apply(t.target)&&(this.us.identifySensitiveNodes(t.target),this.cs.identifyNodes(csElementshadowRoot.apply(t.target)),We((()=>this.qs(t))))})),this.us.onSensitiveElementResize(this.Us)}onEvent(t){this.zs=t}isStarted(){return this.Ms}start(){this.isStarted()||(this.Ms=!0,this.ks.start(),this.js())}stop(){this.isStarted()&&(this.Ms=!1,this.us.unidentifySensitiveNodes(this.xs),this.us.disconnectResizeObserver(),this.ks.stop())}flushEvents(){this.ks.flushPendingMutations()}js(){this.Ls.emitInitialDomStart(),this.us.identifySensitiveNodes(this.xs),this.cs.identifyNodes(this.xs),this.Os.serializeInitialDom(this.xs,this.Ds)}qs(t){if(this.us.isSensitive(t.target)||this.us.isSensitiveChild(t.target))return;const e=this.Os.serializeAttachShadowEvent(t);if(!e)return;const s={args:e,date:t.date,type:oe.ATTACH_SHADOW};this.zs(s)}Bs(t){if(this.us.isSensitiveChild(t.target)||this.us.isSensitiveAttribute(t.target,t.attributeName))return;const e=this.Os.serializeMutationAttribute(t);if(!e)return;const s={args:e,date:t.date,type:oe.MUTATION_ATTRIBUTE};this.zs(s),this.$s.scanAttribute(t.target,t.attributeName)}Fs(t){const e=t.target.parentElement;if(e&&(this.us.isSensitive(e)||this.us.isSensitiveChild(e)))return;const s=this.Os.serializeMutationCharacterData(t);if(!s)return;const i={args:s,date:t.date,type:oe.MUTATION_CHARACTER_DATA};this.zs(i),this.$s.scanText(t.target)}Hs(t,e){if(this.us.isSensitive(t.target)||this.us.isSensitiveChild(t.target))return;const s=this.Os.serializeMutationChildList(t,e);if(!s)return;const{removedNodes:i,addedNodes:n}=s;csArray.prototype.forEach.call(i,(e=>{const s={args:e,date:t.date,type:oe.MUTATION_REMOVE};this.zs(s)})),csArray.prototype.forEach.call(n,(e=>{const s={args:e,date:t.date,type:oe.MUTATION_INSERT};this.zs(s)}))}}class Fe{constructor(t){this.Gs=t,this.Zs=0}addString(t){this.Zs+=2*t.length}addArrayBuffer(t){this.Zs+=t.byteLength}isThresholdReached(){return this.Zs>this.Gs}reset(){this.Zs=0}}class qe{constructor(t=[],e=512e3){this.Ws=t,this.Ks=new Fe(e)}addEvent(t){this.Ks.addString(Y(t)),csArray.prototype.push.call(this.Ws,t)}addEventByTimestamp(t){let e=0;for(;e<this.Ws.length&&!(this.Ws[e].date>t.date);e+=1);csArray.prototype.splice.call(this.Ws,e,0,t)}eventsCount(){return this.Ws.length}clearEvents(){this.Ks.reset(),this.Ws=[]}isFull(){return this.eventsCount()>=200}isThresholdReached(){return this.Ks.isThresholdReached()}getEvents(){return this.Ws}extractEvents(...t){const e=[],s=[];return csArray.prototype.forEach.call(this.Ws,(i=>{-1!==csArray.prototype.indexOf.call(t,i.type)?csArray.prototype.push.call(e,i):csArray.prototype.push.call(s,i)})),this.Ws=s,e}stringifyEvents(){return Y(this.Ws)}Ys(t){t.type===oe.INITIAL_DOM&&(window.CSDomSerialized=window.CSDomSerialized?window.CSDomSerialized+1:1)}}Zt([Ce("RecordingBatch.addEvent")],qe.prototype,"addEvent",null);class Ge{constructor(){this.Qs=1}getCurrentIndex(){return this.Qs}increment(){this.Qs+=1}reset(){this.Qs=1}getRequestParameters(){return{ri:`${this.Qs}`}}}class Ye{emit(t,e,s,i=document){const n=`${void 0!==s?`${s}`:`${Ye.Js}`}${t}`,r=Ye.createEvent(n,{detail:e});null!==r&&i.dispatchEvent(r)}static createEvent(t,e={}){if("function"==typeof CustomEvent)return new CustomEvent(t,e);const s=this.Xs();if(null===s)return null;const{bubbles:i=!1,cancelable:n=!1,detail:r}=e;return s.initCustomEvent(t,i,n,r),s}static Xs(){try{return document.createEvent("CustomEvent")}catch{return null}}}Ye.Js="cs.tracking.";class Ze{constructor(){this.isStarted=!1}start(...t){this.isStarted||(this.isStarted=!0,this.onStart(...t))}stop(){this.isStarted&&(this.isStarted=!1,this.onStop())}restart(){this.stop(),this.start()}}var je,Xe,Ke,Qe;!function(t){t.BLOCKED_BY_CONSENT_NOT_EXPRESSED="B",t.BLOCKED_BY_CONSENT_WITHDRAWN="W",t.NOT_RECORDED="0",t.TEMPORARILY_RECORDED="T",t.GLOBAL_SAMPLING="5",t.URL_SAMPLING="6",t.ETR_SAMPLING="7"}(je||(je={})),function(t){t.ETR_OFF="0",t.ETR_ON="1"}(Xe||(Xe={})),function(t){t.ETR_LEGACY="0",t.ETR_SESSION="1",t.ETR_PAGE="2"}(Ke||(Ke={}));class Je{constructor(t){this.type="asyncEvent",this.ti=!1,t&&t((t=>this.resolve(t)))}resolve(t){if(this.ti)throw new Error("AsyncEvent already resolve.");null==t.timestamp&&(t={...t,timestamp:this.timestamp}),this.si=t,this.ti=!0,this.ii&&this.ii(this.si)}complete(t){this.ti&&t(this.si),this.ii=t}wait(){return new Promise((t=>this.complete(t)))}}class ts{constructor(){this.ei=0}get length(){return this.ei}get isEmpty(){return!this.ni}pushAll(t){for(let e=0;e<t.length;e++)this.push(t[e])}push(t){this.ei++,this.hi?this.hi=this.hi[1]=[t,void 0]:this.hi=this.ni=[t,void 0]}pop(){if(!this.ni)return null;this.ei--;const t=this.ni[0];return this.ni=this.ni[1],this.ni||(this.hi=void 0),t}forEach(t){let e=this.ni;for(;null==e?void 0:e.length;)t(e[0]),e=e[1]}clear(){this.ei=0,this.ni=this.hi=void 0}}class es{constructor(t){this.ii=t,this.oi=new ts,this.ci=!1}onEvent(t){if(this.ii)throw new Error("callback already set");return this.ii=t,this}push(t){this.oi.push(t),this.ai()}static pipe(t,e){let s=t;for(const t of e){const e=new es((e=>{t.pushEvent(e)}));xe(s,(t=>t.subscribe((t=>e.push(t))))),s=[t]}const i=new es;return xe(s,(t=>t.subscribe((t=>i.push(t))))),i}ai(){if(this.ci)return;if(this.ci=!0,!this.ii)throw new Error("callback not set");const t=this.oi.pop(),e=t=>{this.ii(t),this.ci=!1,this.oi.isEmpty||this.ai()};t instanceof Je?t.complete(e):e(t)}}class ss{constructor(t,e=[]){this.producers=t,this.processors=e,this.Ms=!1,this.ui=[],this.li=t=>csArray.prototype.forEach.call(this.ui,(e=>e(t)))}start(){if(this.Ms)throw new Error("Recording is already started.");es.pipe(this.producers,this.processors).onEvent(this.li),xe(this.producers,(t=>t.start())),xe(this.processors,(t=>t.start())),this.Ms=!0}stop(){for(const t of this.producers)t.stop();for(const t of this.processors)t.stop();this.Ms=!1,this.ui=[]}subscribe(t){if(this.Ms)throw new Error("Recording is already started.");return csArray.prototype.push.call(this.ui,t),()=>this.ui=csArray.prototype.filter.call(this.ui,(e=>e!==t))}}class is{constructor(t){this.fi=t}start(){this.fi.subscribe((t=>{const e=t,{timestamp:s}=e;switch(e.type){case"Legacy":this.ii(e.originalEvent);break;case"CustomElementRegistration":this.ii({type:oe.CUSTOM_ELEMENT_REGISTRATION,date:s,args:[e.tagName]});break;case"DomEvent":!function(t,e){const{timestamp:s}=t;switch(t.domEvent){case"initialDOM":{const{initialDOM:i}=t;e({type:oe.INITIAL_DOM,date:s,args:[i]});break}case"nodesAdded":csArray.prototype.forEach.call(t.nodes,(i=>{e({type:oe.MUTATION_INSERT,date:s,args:[t.target,t.nextSibling,i]})}));break;case"nodesMoved":e({type:oe.MUTATION_MOVE,date:s,args:[t.target,t.nextSibling,t.nodesIds]});break;case"nodesRemoved":csArray.prototype.forEach.call(t.nodesIds,(t=>{e({type:oe.MUTATION_REMOVE,date:s,args:[t]})}));break;case"attributeChanged":{const{target:i,namespace:n,attribute:r,newValue:o}=t;e({type:oe.MUTATION_ATTRIBUTE,date:s,args:[i,n,r,o]});break}case"characterDataChanged":{const{target:i,newValue:n}=t;e({type:oe.MUTATION_CHARACTER_DATA,date:s,args:[i,n]});break}case"cssRuleInserted":{const{target:i,rule:n,index:r}=t,o=yt(r)?[i,n,r]:[i,n];e({type:oe.STYLESHEET_RULE_INSERT,date:s,args:o});break}case"cssRuleDeleted":{const{target:i,index:n}=t;e({type:oe.STYLESHEET_RULE_DELETE,date:s,args:[i,n]});break}case"shadowRootAttached":{const{target:i,shadowRoot:n}=t;e({type:oe.ATTACH_SHADOW,date:s,args:[i,n]});break}case"adoptedStyleSheetRegistered":{const{sheetId:i,cssRules:n}=t;e({type:oe.REGISTER_ADOPTED_STYLE_SHEET,date:s,args:[i,n]});break}case"adoptedStyleSheetsSet":{const{target:i,sheetsIds:n}=t;e({type:oe.SET_ADOPTED_STYLE_SHEETS,date:s,args:[i,n]});break}case"adoptedStyleSheetRuleInserted":{const{sheetId:i,rule:n,index:r}=t,o=yt(r)?[i,n,r]:[i,n];e({type:oe.ADOPTED_STYLESHEET_RULE_INSERT,date:s,args:o});break}case"adoptedStyleSheetRuleDeleted":{const{sheetId:i,index:n}=t;e({type:oe.ADOPTED_STYLESHEET_RULE_DELETE,date:s,args:[i,n]});break}default:qt.error("translateDOMEvent: DOMEvent not supported")}}(e,this.ii);break;case"TextVisibility":break;case"encryptedCharacterDataEvent":{const{target:t,rawData:i,encryptedData:n,encryptionMetadata:r}=e;this.ii({type:oe.MUTATION_ENCRYPTED_CHARACTER_DATA,date:s,args:[t,i,n,r]});break}case"StaticResource":{const{url:t}=e;this.ii({type:oe.STATIC_RESOURCE_URL,date:s,args:[t]});break}default:qt.error("WebRecorderEventTranslator: Event not supported")}})),this.fi.start()}stop(){this.fi.stop()}onEvent(t){this.ii=t}}class ns{constructor(){this.wi=[]}produceEvent(t){var e;null!==(e=t.timestamp)&&void 0!==e||(t.timestamp=ht()),csArray.prototype.forEach.call(this.wi,(e=>e(t)))}stop(){this.wi=[]}subscribe(t){return csArray.prototype.push.call(this.wi,t),()=>{const e=csArray.prototype.indexOf.call(this.wi,t);csArray.prototype.splice.call(this.wi,e,1)}}}class rs extends ns{constructor(t){super(),this.pi=t}subscribe(t){return super.subscribe(t)}start(){xe(this.pi,(t=>{t.onEvent((t=>this.li(t)))})),xe(this.pi,(t=>{var e;null===(e=t.start)||void 0===e||e.call(t)}))}stop(){xe(this.pi,(t=>{var e;return null===(e=t.stop)||void 0===e?void 0:e.call(t)})),super.stop()}li(t){this.produceEvent({timestamp:ht(),type:"Legacy",originalEvent:t})}}!function(t){t.Visible="visible",t.Hidden="hidden",t.Blur="blur",t.PagehideVisible="pagehideVisible",t.PagehideHidden="pagehideHidden"}(Qe||(Qe={}));class os{constructor(){this.mi=!1,this.Ei=t=>{try{switch(t.type){case"visibilitychange":if("hidden"===document.visibilityState)return this.yi(Qe.Hidden);break;case"pagehide":return"hidden"===document.visibilityState?this.yi(Qe.PagehideHidden):this.yi(Qe.PagehideVisible);case"blur":return this.yi(Qe.Blur);default:return}}catch{}}}start(){this.mi||(this.mi=!0,this.Ai(),this.gi(),this.vi())}stop(){this.mi&&(this.mi=!1,this._i(),this.Ri(),this.Si())}onEvent(t){this.yi=t}Ai(){document.addEventListener("visibilitychange",this.Ei)}_i(){document.removeEventListener("visibilitychange",this.Ei)}gi(){window.addEventListener("pagehide",this.Ei)}Ri(){window.removeEventListener("pagehide",this.Ei)}vi(){window.addEventListener("blur",this.Ei)}Si(){window.removeEventListener("blur",this.Ei)}}function as(t,e,s,i){var n,r=arguments.length,o=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,s,i);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(o=(r<3?n(o):r>3?n(e,s,o):n(e,s))||o);return r>3&&o&&Object.defineProperty(e,s,o),o}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;let hs=0;function cs(t){return"$$"+t+ ++hs}cs.asyncIterator="$$asyncIterator";const ls=Ot("Symbol",cs);var us;const ds=()=>(t,e,s)=>{s.value=function(t){const e=ls("oncePerTickSymbol");let s=null;const i={},n=function(){const n=null!==this&&void 0!==this?this:i;s=arguments,n[e]||(n[e]=!0,ps((()=>{n[e]=!1,t.apply(n,s)})))};return n.oncePerTickSymbol=e,n}(s.value)},ps=null!==(us=window.queueMicrotask)&&void 0!==us?us:setTimeout;ds.isScheduled=(t,e)=>t[e.oncePerTickSymbol];class gs{constructor(t){this.ii=t,this.Ti=new Map,this.Ii=t=>{const e=t.target;if(this.Ti.has(e))return!0;let s=!1;return this.Ti.forEach(((t,i)=>{!s&&this.Ti.get(i).subtree&&(s=i.contains(e))})),s},this.ks=new csMutationObserver((e=>{ds.isScheduled(this,this.garbageCollect)&&(e=$e(e,this.Ii)),e.length&&We((()=>t(e,this)))}))}disconnect(){this.ks.disconnect(),this.Ti=new Map}takeRecords(){return this.ks.takeRecords()}observe(t,e){return this.Ti.set(t,e),this.ks.observe(t,e)}unobserve(t){this.Ti.has(t)&&(this.Ti.delete(t),this.garbageCollect())}garbageCollect(){const t=$e(this.takeRecords(),this.Ii);t.length&&this.ii(t,this),this.ks.disconnect(),this.Ti.forEach(((t,e)=>this.ks.observe(e,t)))}}function ms(t){let e,s="";var i;i=t,e=-1!==csString.prototype.indexOf.call(i,"@")?new RegExp("@(.+):(\\d+):(\\d+)$"):new RegExp("\\((.+):(\\d+):(\\d+)\\)");const n=e.exec(t);return n&&(s=n[1]),s}as([ds()],gs.prototype,"garbageCollect",null);const fs=t=>t;function ys({target:t,methodName:e,hook:s,hookPrepareArgs:i=fs,options:n}){var r;if(!(null===(r=Object.getOwnPropertyDescriptor(t,e))||void 0===r?void 0:r.writable))return Gt.warn(`Cannot intercept read only function '${csString(e)}' of object '${t}'`),null;let o=!1;const a=t[e];if("function"==typeof a){const r=function(){const t=i(arguments),e=a.apply(this,arguments);if(o){let i;n&&n.withCallerName&&(i=function(){const t=new Error;let e=t.stack?csArray.prototype.filter.call(csString.prototype.split.call(t.stack,"\n"),(t=>"Error"!==t&&-1===csString.prototype.indexOf.call(csString.prototype.toLowerCase.call(t),"promise ")&&-1===csString.prototype.indexOf.call(t,"[native code]"))):[];if(0===e.length)return"";const s=function(t){return t.length>0?ms(t[0]):""}(e);return""===s?"":(e=function(t,e){return csArray.prototype.filter.call(t,(t=>-1===csString.prototype.indexOf.call(t,e)))}(e,s),0===e.length?"":ms(e[0]))}());try{s({result:e,context:this,args:t,callerName:i})}catch(t){Gt.error(t)}}return e};c=a,(h=r).prototype=c.prototype,Object.defineProperty(h,"toString",{value:()=>c.toString()}),t[e]=r}var h,c;return{activate:()=>o=!0,deactivate:()=>o=!1}}function Es(t,e,s){let i=!1;const n=Object.getOwnPropertyDescriptor(t,e);if(n){if(!n.configurable)return Gt.warn(`Cannot intercept read only property '${csString(e)}' of object '${t}'`),null;const r=function(){return n.get.apply(this,arguments)},o=function(){const t=arguments,e=n.set.apply(this,t);if(i)try{s(this,t[0])}catch(t){Gt.error(t)}return e};Object.defineProperty(t,e,{...n.get?{get:r}:{},...n.set?{set:o}:{}})}return{activate:()=>i=!0,deactivate:()=>i=!1}}function Ss(){const t=new Set;return{add:function(e){t.add(e),1===t.size&&setTimeout((()=>{t.clear()}))},has:function(e){return t.has(e)},del:function(e){t.delete(e)},values:()=>function(t){const e=[];return t.forEach((t=>csArray.prototype.push.call(e,t))),e}(t),get count(){return t.size}}}var vs,ws,Rs;!function(t){t.isSupported=function(){return!!Element.prototype.attachShadow},t.getShadowRoot=function(t){return t&&_(t)?t.shadowRoot:null},t.getAllShadowHosts=function(t){const e=[];if(!(t=>t.querySelectorAll)(t))return[];const s=(t,e)=>{xe(window.csquerySelectorAll[t.nodeType].call(t,"*"),e)},i=t=>{csElementshadowRoot.apply(t)&&(csArray.prototype.push.call(e,t),s(csElementshadowRoot.apply(t),i))};return(t=>t.shadowRoot)(t)&&(csArray.prototype.push.call(e,t),s(csElementshadowRoot.apply(t),i)),s(t,i),e}}(vs||(vs={})),function(t){function e(){const t=[i()];return document.documentElement&&csArray.prototype.push.call(t,document.documentElement.scrollHeight,document.documentElement.offsetHeight,document.documentElement.clientHeight),document.body&&csArray.prototype.push.call(t,document.body.scrollHeight,document.body.offsetHeight),Math.max(...t)}function s(){return document.documentElement.scrollWidth}function i(){return window.innerHeight}function n(){return window.innerWidth}function r(){const t=window.csScreen.width;return gt(t)&&t>0?t:window.screen.width}function o(){const t=window.csScreen.height;return gt(t)&&t>0?t:window.screen.height}t.documentHeight=e,t.documentWidth=s,t.windowHeight=i,t.windowWidth=n,t.screenWidth=r,t.screenHeight=o,t.windowOffsetX=function(){return window.pageXOffset},t.windowOffsetY=function(){return window.pageYOffset},t.getRequestParameters=function(){return{dw:`${s()}`,dh:`${e()}`,ww:`${n()}`,wh:`${i()}`,sw:`${r()}`,sh:`${o()}`}}}(ws||(ws={}));const As=null!==(Rs=Nt.Node)&&void 0!==Rs?Rs:Object;var Ts;!function(t){const e="isConnected"in As.prototype?t=>t.isConnected:t=>!(t.ownerDocument&&t.ownerDocument.compareDocumentPosition(t)&t.DOCUMENT_POSITION_DISCONNECTED);function s(t){var e;return t.parentElement?t.parentElement:t.getRootNode?null===(e=t.getRootNode())||void 0===e?void 0:e.host:null}function i(t){var e,s;if(!1===(null===(e=t.checkVisibility)||void 0===e?void 0:e.call(t,{checkOpacity:!0,checkVisibilityCSS:!0})))return!0;if(!t.offsetParent){if(!t.getBoundingClientRect)return Gt.warn(`SUP-11432: Element doesn't have getBoundingClientRect. Node: ${t instanceof As} Ctor: ${null===(s=null==t?void 0:t.constructor)||void 0===s?void 0:s.name}`),!1;const e=t.getBoundingClientRect();if(0==e.width&&0==e.height)return!0}const i=window.getComputedStyle(t);return!i||("none"===i.display||"hidden"===i.visibility||"collapse"===i.visibility||"0"===i.opacity||"opacity(0)"===i.filter||"0px"===i.width&&"0px"===i.height||"transparent"===(n=i.color)||/^(rgba|hsla)\(\d+, \d+%?, \d+%?, 0\)$/.test(n));var n}function n(t){const e=t.getBoundingClientRect(),s=e.left+.5*e.width,i=e.top+.5*e.height;return r(document,s,i)}function r(t,e,s){const i=t.elementFromPoint(e,s);if(!i)return null;const n=vs.getShadowRoot(i);return n&&n!=document.body.getRootNode()&&n!==t?r(n,e,s):i}function o(t){const e=n(t);return null!==e&&(t===e||t.contains(e))}t.forEachChild=function(t,e){for(let s=t;s;s=csNodenextSibling.apply(s))e(t)},t.isConnected=function(t){return e(t)},t.getAncestors=function(t,e){const s=[],i=t=>{csArray.prototype.push.call(s,t);const e=t.getRootNode();let i=t;for(;(null==i?void 0:i.parentElement)&&i.parentElement!==e;)csArray.prototype.push.call(s,i.parentElement),i=i.parentElement;return csArray.prototype.push.call(s,e),s};if(e){let e=t;for(;e;){i(e);const t=e.getRootNode();if(!(t instanceof ShadowRoot))break;e=t.host}}else i(t);return s},t.isDescendantOf=function e(s,i){if(s===i||i.contains(s))return!0;const n=t.getParentElement(s);return!(!n||n===s)&&e(n,i)},t.getParentElement=s,t.findAllElements=function(t,e=document){const s=De(window.csquerySelectorAll[e.nodeType].call(e,t)),i=vs.getAllShadowHosts(e);for(const e of i){const i=csElementshadowRoot.apply(e),n=De(window.csquerySelectorAll[i.nodeType].call(i,t));csArray.prototype.push.call(s,...n)}return s},t.isHiddenByCSS=i,t.areAncestorsHiddenByCSS=function t(e){if(i(e))return!0;const n=s(e);return null!=n&&t(n)},t.getTopAncestorHiddenByCSS=function(t){let e=null,n=t;do{if(!i(n))break;e=n}while(n=s(n));return e},t.getTopElement=n,t.getElementOnTop=function(e){if(!e.getBoundingClientRect)return null;const s=e.getBoundingClientRect(),i=s.x+s.width/2,n=s.y+s.height/2;return t.getTopElementFromPoint(document,i,n)},t.getTopElementFromPoint=r,t.isVisibleInDocument=function(t){return!function(t){const e=t.getBoundingClientRect();return e.right+ws.windowOffsetX()<0||e.bottom+ws.windowOffsetY()<0}(t)&&!i(t)&&!function(t){const e=n(t);return null!==e&&!t.contains(e)}(t)},t.isVisibleInViewportInForeground=function(t){return!i(t)&&o(t)},t.isInViewPort=o,t.getAttributeNS=function(t,e,s){const i=t.getAttributeNS(e,s);return""===i?t.hasAttributeNS(e,s)?i:null:i},t.isElementFocusable=function(t){return!(!t.hasAttribute("tabIndex")&&"true"!==t.getAttribute("contentEditable")&&(!p(t)||!t.hasAttribute("href"))&&(!(w(t)||E(t)||y(t)||(e=t,c(e)&&"button"===e.localName))||t.hasAttribute("disabled"))&&!function(t){return c(t)&&"details"===t.localName}(t)&&!function(t){return c(t)&&"summary"===t.localName}(t));var e}}(Ts||(Ts={}));class _s{constructor(t){this.ii=t,this.Pi=[],this.bi=Ss(),this.ii=(e,s)=>{"initial"===s?t(e,s):this.bi.has(e)||(t(e,s),this.bi.add(e))},this.Vi()}observe(t){csArray.prototype.push.call(this.Pi,t),this.Ci(),this.Ni(t,!0),this.ks.observe(t,{subtree:!0,childList:!0})}disconnect(){this.Pi=[],this.ks.disconnect(),this.Oi&&this.Oi.deactivate()}Ci(){this.Oi||(this.Oi=ys({target:Element.prototype,methodName:"attachShadow",hook:t=>Ue(this.Pi,(e=>Ts.isDescendantOf(t.result.host,e)))&&this.ii(t.result,"added")})),this.Oi.activate()}Ni(t,e){xe(vs.getAllShadowHosts(t),(t=>{this.ii(csElementshadowRoot.apply(t),e?"initial":"added"),this.ks.observe(csElementshadowRoot.apply(t),{subtree:!0,childList:!0})}))}Vi(){this.ks=new gs((t=>{We((()=>{for(const e of t)xe(e.addedNodes,(t=>this.Ni(t,!1))),Me(e.removedNodes,vs.getAllShadowHosts,(t=>{this.ii(csElementshadowRoot.apply(t),"removed"),this.ks.unobserve(csElementshadowRoot.apply(t))}))}))}))}}const bs=Nt.ShadowRoot?class extends gs{constructor(t){super((e=>t(e,this))),this.ki=new Map}observe(t,e){super.observe(t,e),e.subtree&&this.$i(e).observe(t)}disconnect(){super.disconnect(),this.ki.forEach((t=>t.disconnect()))}$i(t){const e=(s=t,csJSON.stringify(s,csArray.prototype.sort.call(Object.keys(s))));var s;let i=this.ki.get(e);return i||this.ki.set(e,i=new _s(((e,s)=>{"added"===s||"initial"===s?super.observe(e,t):"removed"===s&&super.unobserve(e)}))),i}}:Nt.csMutationObserver;var Cs,Ns;function Os(t,e=ks.SHOW_ALL){var s;const i=e|ks.SHOW_ELEMENT,n=[document.createTreeWalker(t,i,null,!1)];t instanceof Element&&(null===(s=csElementshadowRoot.apply(t))||void 0===s?void 0:s.firstElementChild)&&csArray.prototype.push.call(n,document.createTreeWalker(csElementshadowRoot.apply(t),i,null,!1));let r=null;return{root:t,nextNode(){for(;n.length>0;){if(e===ks.SHOW_ALL&&r){const t=r;return r=null,t}const t=n[n.length-1].nextNode();if(!t){csArray.prototype.pop.call(n);continue}const s=Is(t);if(e===ks.SHOW_ALL&&(r=s),s&&csArray.prototype.push.call(n,document.createTreeWalker(s,i,null,!1)),Ls[t.nodeType]&e)return t}return null},visitAll(e){e(t);let s=this.nextNode();for(;s;)e(s),s=this.nextNode()}}}function Is(t){return t&&_(t)?t.shadowRoot:null}const Ps=null!==(Cs=Nt.Node)&&void 0!==Cs?Cs:{},ks=null!==(Ns=Nt.NodeFilter)&&void 0!==Ns?Ns:{},Ls={2:ks.SHOW_ATTRIBUTE,4:ks.SHOW_CDATA_SECTION,8:ks.SHOW_COMMENT,11:ks.SHOW_DOCUMENT_FRAGMENT,9:ks.SHOW_ALL,10:ks.SHOW_DOCUMENT_TYPE,1:ks.SHOW_ELEMENT,[Ps.ENTITY_NODE]:ks.SHOW_ENTITY,[Ps.ENTITY_REFERENCE_NODE]:ks.SHOW_ENTITY_REFERENCE,[Ps.NOTATION_NODE]:ks.SHOW_NOTATION,7:ks.SHOW_PROCESSING_INSTRUCTION,3:ks.SHOW_TEXT};class Ds{constructor(t){this.ii=t,this.Li=new bs((t=>We((()=>this.xi(t)))))}observe(t=document){this.Li.observe(t,{childList:!0,subtree:!0}),Os(t,NodeFilter.SHOW_ELEMENT).visitAll((t=>{c(t)&&this.ii(t)}))}disconnect(){this.Li.disconnect()}xi(t){const e=new Set;for(const s of t)xe(s.addedNodes,(t=>{e.has(t)||Os(t,NodeFilter.SHOW_ELEMENT).visitAll((t=>{!e.has(t)&&c(t)&&this.ii(t)}))}))}}class Ms extends ns{constructor(){super(),this.Mi="object"==typeof window.customElements&&"function"==typeof window.customElements.whenDefined&&"function"==typeof window.Promise,this.Di=t=>{for(const s of t)c(e=s)&&csString.prototype.indexOf.call(e.tagName,"-")>0&&-1===csString.prototype.indexOf.call(e.tagName,":")&&-1===csString.prototype.indexOf.call(e.tagName,'"')&&-1===csString.prototype.indexOf.call(e.tagName,",")&&csArray.prototype.indexOf.call(b,csString.prototype.toLocaleLowerCase.call(e.tagName))<0&&this.Ui(csString.prototype.toLowerCase.call(s.tagName));var e};const t=function(t){const e=Ss();return{push(s){0===e.count&&setTimeout((()=>{t(e.values())})),e.add(s)}}}(this.Di);this.zi=new Ds((e=>t.push(e))),this.Fi=new Set}start(){this.Mi&&this.zi.observe()}stop(){this.Fi.clear(),this.zi.disconnect()}async Ui(t){this.Fi.has(t)||(this.Fi.add(t),await window.customElements.whenDefined(t),this.produceEvent({type:"CustomElementRegistration",tagName:csString.prototype.toLowerCase.call(t)}))}}class xs extends Ze{constructor(t,e,s,i,n,r,o,a,h,c,l,u,d,p,g,m,f,y,E,S=[],v){super(),this.$=t,this.Bi=e,this.Hi=s,this.qi=i,this.ji=n,this.Gi=r,this.Zi=o,this.Wi=a,this.Ki=h,this.Yi=c,this.W=l,this.Qi=u,this.Ji=d,this.Xi=p,this.te=g,this.se=m,this.ie=f,this.ee=y,this.ne=E,this.pi=S,this.re=v,this.he=0,this.oe=0,this.ce=0,this.ae=new Ye,this.ue={allowFromQuotaService:!0,allowFromSerialization:!0},this.le=ye((()=>{this.Bi.eventsCount()>0&&this.de()}),2e3),this.fe=t=>this.processBrowserEvent(t),this.we=t=>this.pe(t),this.Ee=0,this.ye=0,this.Ae=new os,this.ge=!1,this.ve=51200,this._e=!1,this.Re=!1,this.Se=[],this.Te=t=>{this.ee.removeBatchInProgress(`${t.params.sn}.${t.params.pn}.${t.params.ri}`)},this.fi=new ss([new rs(csArray.prototype.filter.call([this.Gi,...this.pi],(t=>t))),new Ms]),this.Ie=new is(this.fi),this.Ie.onEvent(this.fe)}init(){this.Pe(),this.ie.onLoad(this.Te),this.ie.onError(this.Te)}Pe(){var t,e,s,i;this.Zi.onEvent(this.we),this.Wi.onEvent(this.we),this.Ki.onEvent(this.we),null===(t=this.se)||void 0===t||t.onTextNodeToEncrypt(this.fe),null===(e=this.se)||void 0===e||e.onApiErrorToEncrypt((t=>{this.be(t)})),null===(s=this.se)||void 0===s||s.onUserIdentifierToEncrypt(this.fe),null===(i=this.ne)||void 0===i||i.onEvent(this.fe),this.Ae.onEvent((t=>t===Qe.Blur?this.Ve():this.ge?void 0:(this.ge=!0,setTimeout((()=>{this.ge=!1})),t===Qe.Hidden?this.Ve():this.Ce())))}isRecording(){return this.W.hasValidSession()&&this.isStarted}Ve(){if(!this.canSendEvents())return;this.ee.saveBatchesInProgress(),xe(this.pi,(t=>{var e,s;return xe(null!==(s=null===(e=t.getPendingEvents)||void 0===e?void 0:e.call(t))&&void 0!==s?s:[],(t=>this.Bi.addEvent(t)))}));const t=this.Bi.getEvents();if(0===t.length)return;const e=this.ie.getQueryParams();e.rst=this.getRecordingStartTimestamp(),e.let=this.getRecordingLastEventTimestamp();const s=this.qi.getCurrentIndex();e.ri=s.toString(),this.re.removeQueryParams(),this.re.setQueryParams(e),this.ye=t[t.length-1].date;const i=this.Bi.stringifyEvents();if(i.length>this.ve){const t=this.Ne();if(t.length>0){const s=Y(t);this.re.send(s)||this.ee.save({key:`${e.sn}.${e.pn}.${e.ri}.last`,metadata:{...e,datatype:"json"},events:s}),this.qi.increment()}if(this.Bi.eventsCount()>0){e.ri=this.qi.getCurrentIndex().toString();const t=this.Bi.stringifyEvents();this.ee.save({key:`${e.sn}.${e.pn}.${e.ri}.last`,metadata:{...e,datatype:"json"},events:t}),this.qi.increment()}}else this.re.send(i)||this.ee.save({key:`${e.sn}.${e.pn}.${e.ri}.last`,metadata:{...e,datatype:"json"},events:i}),this.qi.increment();this.re.removeQueryParams(),this.Bi.clearEvents()}Ce(){if(!this.canSendEvents())return;const t=this.ie.getQueryParams();this.ee.saveBatchesInProgress(),t.rst=this.getRecordingStartTimestamp(),delete t.ri,t.hlm="true",this.re.removeQueryParams(),xe(this.pi,(t=>{var e,s;return xe(null!==(s=null===(e=t.getPendingEvents)||void 0===e?void 0:e.call(t))&&void 0!==s?s:[],(t=>this.Bi.addEvent(t)))}));const e=this.Bi.getEvents();if(0===e.length)return delete t.let,delete t.rst,this.re.setQueryParams(t),this.re.send(),void this.re.removeQueryParams();this.ye=e[e.length-1].date,t.let=this.getRecordingLastEventTimestamp(),this.re.setQueryParams(t);const s=this.Bi.stringifyEvents();if(s.length>this.ve){const e=this.Ne();if(e.length>0){const s=Y(e);this.re.send(s)||this.ee.save({key:`${t.sn}.${t.pn}.last`,metadata:{...t,datatype:"json"},events:s})}else delete t.let,delete t.rst,delete t.ri,this.re.removeQueryParams(),this.re.setQueryParams(t),this.re.send(),this.re.removeQueryParams();if(this.Bi.eventsCount()>0){t.rst=this.getRecordingStartTimestamp(),t.let=this.getRecordingLastEventTimestamp();const e=this.qi.getCurrentIndex();t.ri=e.toString();const s=this.Bi.stringifyEvents();this.ee.save({key:`${t.sn}.${t.pn}.${t.ri}.last`,metadata:{...t,datatype:"json"},events:s}),this.qi.increment()}}else this.re.send(s)||(this.ee.save({key:`${t.sn}.${t.pn}.${t.ri}.last`,metadata:{...t,datatype:"json"},events:s}),this.qi.increment());this.re.removeQueryParams(),this.Bi.clearEvents()}isMutationTrackerStarted(){return this.Gi.isStarted()}blockSendingEventsFromQuotaService(){this.ue.allowFromQuotaService=!1}allowSendingEventsFromQuotaService(){this.ue.allowFromQuotaService=!0}blockSendingEventsFromSerialization(){this.ue.allowFromSerialization=!1}allowSendingEventsFromSerialization(){this.ue.allowFromSerialization=!0}canSendEvents(){return this.ue.allowFromQuotaService&&this.ue.allowFromSerialization}onIframeJavascriptError(t){this.Oe(t)}onIframeDetailedApiError(t){this.ke(t)}onIframeRecordingUserEvent(t){for(const e of t)this.pe(e)}onIframeRecordingBrowserEvent(t){if(this.isMutationTrackerStarted())for(const e of t)this.processBrowserEvent(e)}processBrowserEvent(t){this.Yi.isCurrentPageviewValid()&&this.$e(t)}pe(t){this.Yi.isSessionValid()&&this.$e(t)}$e(t){this.Bi.addEvent(t),this.Bi.isThresholdReached()?this.pushEvents():this.Bi.isFull()&&this.le(),this.Le(t)}Le(t){this.$.emitDebugEvents&&this.ae.emit("recordingEvent",{...t,typeName:oe[t.type]})}onStart(){this.Ae.start(),this.initStates(),this.ji.start(),this.Ie.start(),this.Ki.start(),this.Wi.start(),this.Qi&&this.Ji&&this.Qi.subscribe(xs.xe,(t=>this.Oe(t))),this.Xi&&this.te&&this.Xi.subscribe(xs.xe,(t=>this.ke(t)),{detailedEvent:!0}),this.$.emitDebugEvents&&this.ae.emit("replayRecordingStarted"),csArray.prototype.forEach.call(this.Se,(t=>this.Me(t))),this.Se=[]}onStop(){this.Ae.stop(),this.ji.stop(),this.Zi.stop(),this.Wi.stop(),this.Qi&&this.Qi.unsubscribe(xs.xe),this.Xi&&this.Xi.unsubscribe(xs.xe),this.Ie.stop(),this.Ki.stop(),this.Re=!1}clearStates(){this.Gi.flushEvents(),this.le.cancel(),this.pushEvents(),this.ie.removeQueryParams()}initStates(){this.Ee=ht(),this.qi.reset(),this.he=0,this.oe=0,this.ce=0,this.ie.setQueryParams(this.Hi.getRequestParameters())}pushEvents(){xe(this.pi,(t=>{var e;return null===(e=t.flushEvents)||void 0===e?void 0:e.call(t)})),this.Bi.eventsCount()>0&&(this.isStarted?this.de():this.Bi.clearEvents())}de(){if(!this.canSendEvents())return;const t=this.Bi.getEvents();this.ye=t[t.length-1].date;const e=this.qi.getCurrentIndex();this.ie.setQueryParams({ri:e.toString(),rst:this.getRecordingStartTimestamp(),let:this.getRecordingLastEventTimestamp()});const s=this.ie.getQueryParams();this.ee.addBatchInProgress(`${s.sn}.${s.pn}.${e}`,this.ie.getQueryParams(),t),this.ie.send(t),this.qi.increment(),this.Bi.clearEvents(),this.De&&this.De()}addInitialDom(t){this.Bi.addEventByTimestamp(t),this.Le(t)}ke(t){if(t.customRequestHeaders||t.customResponseHeaders||t.queryParameters||t.requestBody||t.responseBody){if(this.se)return void this.se.registerApiErrorToEncrypt(t);t.customRequestHeaders="",t.customResponseHeaders="",t.queryParameters="",t.requestBody="",t.responseBody=""}this.be(t)}be(t){if(this.oe<xs.Ue){const e={type:oe.API_ERROR,date:ht(),args:[this.te.anonymize(t)]};this.fe(e),this.oe=this.oe+1}}Oe(t){if(this.he<xs.ze){const e={type:oe.JAVASCRIPT_ERROR,date:ht(),args:[this.Ji.anonymize(t)]};this.fe(e),this.he=this.he+1}}Fe(t){if(this.ce<xs.Be){const e={type:oe.CUSTOM_ERROR,date:ht(),args:[t]};this.fe(e),this.ce=this.ce+1}}He(t){t===Ke.ETR_SESSION?this.ie.setQueryParams({[xs.qe]:xs.je}):t===Ke.ETR_PAGE&&this.ie.setQueryParams({[xs.Ge]:xs.je})}clearEvents(){this.Bi.clearEvents()}onCustomJavaScriptErrorEvent(t){this.Oe(t)}onCustomErrorEvent(t){this.Fe(t)}onPageEvent(t){this.Ze(t)}onUserIdentifierEvent(t){var e;const s={userIdentifier:t,date:ht(),keyId:this.$.encryptionPublicKeyId};null===(e=this.se)||void 0===e||e.registerUserIdentifierToEncrypt(s)}onEventTriggerRecording(t,e){this.isStarted?this.Me({eventName:t,eventType:e}):csArray.prototype.push.call(this.Se,{eventName:t,eventType:e})}Me(t){this.He(t.eventType),this.Ze(t.eventName),this.pushEvents()}Ze(t){const e={type:oe.PAGE_EVENT,date:ht(),args:[{eventName:csString.prototype.slice.call(t,0,xs.We)}]};this.Bi.addEvent(e)}triggerUnanonymizationConsentGranted(){const t={date:ht(),type:oe.UNANONYMIZED_CONSENT_GRANTED};this.Bi.addEvent(t)}triggerUnanonymizationConsentWithdrawn(){const t={date:ht(),type:oe.UNANONYMIZED_CONSENT_WITHDRAWN};this.Bi.addEvent(t)}triggerRecordingForSessionGranted(){const t={date:ht(),type:oe.RECORDING_INFO_EVENT,args:[ae.RECORDING_CONSENT_FOR_SESSION_GRANTED]};this.Bi.addEvent(t)}triggerRecordingForSessionWithdrawn(){const t={date:ht(),type:oe.RECORDING_INFO_EVENT,args:[ae.RECORDING_CONSENT_FOR_SESSION_WITHDRAWN]};this.Bi.addEvent(t)}activateOnlineAssetsOnNextPageview(){this._e=!0,this.Re=!0}getStaticResourceManagerStatus(){return this.ne?{isStarted:this.$.useStaticResourceManager&&this.ne.isSupported(),onlineAssets:{activated:this.ne.isOnlineAssetsActivated(),enabledOnNextPageview:this._e,enabledForChildrenOnNextStart:this.Re}}:null}updateStaticResourceManagerOnlineAssets(){this.ne&&this._e&&(this.ne.enableOnlineAssets(),this.Re=!0,this._e=!1)}onRecordingRequestSent(t){this.De=t}getRecordingStartTimestamp(){return this.Ee.toString()}getRecordingLastEventTimestamp(){return this.ye.toString()}Ne(){return this.Bi.extractEvents(oe.API_ERROR,oe.JAVASCRIPT_ERROR,oe.CUSTOM_ERROR,oe.TEXT_VISIBILITY,oe.POINTER_DOWN)}}xs.xe="RecordingService",xs.We=255,xs.ze=20,xs.Ue=20,xs.Be=20,xs.Ge="etrp",xs.qe="etrs",xs.je="1",Zt([Ce("addInitialDom")],xs.prototype,"addInitialDom",null);class Us extends Ze{constructor(t,e,s){super(),this.Zt=t,this.re=e,this.ie=s,this.Ke=!1,this.Ye={},this.Qe=t=>{if(0!==t.length)for(const e of t){const{metadata:t,events:s}=e;this.Je(t.rt)&&this.ie.send(s,t)}},window.addEventListener("focus",(()=>{this.recover()}))}onStart(){this.Ye={}}onStop(){}recover(){this.Zt.recover(this.Qe)}addBatchInProgress(t,e,s){this.Ye[t]={metadata:{...e},events:s}}removeBatchInProgress(t){delete this.Ye[t]}blockSendingLastMessage(){this.Ke=!1}allowSendingLastMessage(){this.Ke=!0}sendLastMessageBeacon(){if(this.Ke){const{ri:t,rst:e,let:s,...i}=this.ie.getQueryParams();i.hlm="true",this.re.setQueryParams(i),this.re.send()}}Je(t){return!!t&&-1===csString.prototype.indexOf.call(t,je.TEMPORARILY_RECORDED)}saveBatchesInProgress(){csArray.prototype.forEach.call(Object.keys(this.Ye),(t=>{const{metadata:e,events:s}=this.Ye[t];this.Zt.save({key:`${e.sn}.${e.pn}.${e.ri}`,metadata:{...e,datatype:"json"},events:csJSON.stringify(s)})}))}save(t){this.Zt.save(t)}}Zt([Yt("RecordingRecovery")],Us.prototype,"recover",null);const $s=/[^\s]/g;function zs(t){return csString.prototype.replace.call(t,$s,"a")}class Vs{constructor(t,e,s,i){this.Xe=t,this.cs=e,this.tn=s,this.se=i,this.en=!1}setAnonymization(t){this.nn=t}isDOMSerializationInProgress(){return this.en}serializeInitialDom(t,e){if(this.Xe.isAsynchronous())this.serializeDocumentAsync(t).then((t=>{t&&e(t)})).catch((t=>{qt.error(t)}));else{const s=this.rn(t);e(s)}}rn(t){return{args:[this.Xe.serialize(t,{withAnonymization:this.nn})],date:ht(),type:oe.INITIAL_DOM}}async serializeDocumentAsync(t){this.en=!0;try{return await this.Xe.startSerializeAsync(t,{withAnonymization:this.nn})}finally{this.en=!1}}serializeMutationCharacterData(t){var e;const s=this.cs.getId(t.target);if(!s)return null;const i=t.target;if(i.data===t.oldValue)return null;if(l(i)&&(null===(e=this.se)||void 0===e?void 0:e.shouldEncrypt(i)))return this.se.registerTextNodeMutationToEncrypt({targetId:s,textNode:i,serializedTextData:zs(i.data),date:t.date}),null;let n=this.tn.getAnonymizedText(this.nn,i,i.data);l(i)&&(n=this.Xe.serializeTextMutation(i,n));const r=[s,n];return this.hn(this.Xe)&&this.isDOMSerializationInProgress()&&this.Xe.handleMutationCharacterData(t,r),r}serializeAttachShadowEvent(t){const e=this.cs.getId(t.target);return e?[e,this.Xe.serialize(t.shadowRoot)]:null}serializeMutationAttribute(t){const e=this.cs.getId(t.target);if(!e)return null;const s=t.target,i=t.attributeName,n=t.attributeNamespace;let r=Ts.getAttributeNS(t.target,n,i);r&&(r=this.tn.getAnonymizedAttributeValue(s,this.nn,i,r),r=this.Xe.serializeAttributeMutationValue(t.target,i,r));const o=[e,n,i,r];return this.hn(this.Xe)&&this.isDOMSerializationInProgress()&&this.Xe.handleMutationAttribute(t.oldValue?this.tn.getAnonymizedAttributeValue(s,this.nn,i,t.oldValue):t.oldValue,o),o}serializeMutationChildList(t,e){const s=this.cs.getId(t.target);return s?this.hn(this.Xe)&&this.isDOMSerializationInProgress()?this.Xe.serializeMutationChildList(t,this.nn,e):{removedNodes:this.cn(t),addedNodes:this.an(t,s,e)}:(xe(t.addedNodes,(t=>{const s=e.get(t);s&&e.set(t,s-1)})),null)}hn(t){return t.isAsynchronous()}cn(t){const e=[];for(let s=0;s<t.removedNodes.length;s+=1){const i=this.cs.getId(t.removedNodes[s]);i&&csArray.prototype.push.call(e,[i])}return e}an(t,e,s){const i=[];let n=null;if(t.nextSibling){const e=this.cs.getId(t.nextSibling);n=void 0!==e?e:null}for(let r=0;r<t.addedNodes.length;r+=1){const o=t.addedNodes[r],a=this.Xe.serialize(o,{excludedNodes:s,withAnonymization:this.nn}),h=s.get(o);h&&s.set(o,h-1),csArray.prototype.push.call(i,[e,n,a])}return i}}var Ws;Zt([(Ws="serializeDocumentAsync",function(t,e,s){const i=s.value;s.value=function(...t){if(!Te)return s.value=i,i.apply(this,t);!function(t){performance.mark(`${t}-start`)}(Ws);const e=i.apply(this,t);return e.then((()=>{!function(t){const e=performance.measure(t,`${t}-start`);if(!e)return;const s=e.duration;s>Re&&we.add([{mName:t,mDuration:+s.toFixed(2)}])}(Ws)})),e}})],Vs.prototype,"serializeDocumentAsync",null);class Bs{constructor(t,e,s,i){this.cs=t,this.us=e,this.$s=s,this.ji=i,this.un()&&(this.ln=Es(window.CSSStyleDeclaration.prototype,"cssText",((t,e)=>this.setStyleDeclarationCssText(t,e))))}onEvent(t){this.zs=t}start(){this.dn=this.ji.registerToInsertRuleInterceptor(this.sendInsertion.bind(this)),this.fn=this.ji.registerToDeleteRuleInterceptor(this.sendDeletion.bind(this)),this.ln&&this.ln.activate()}stop(){var t,e;null===(t=this.dn)||void 0===t||t.call(this),null===(e=this.fn)||void 0===e||e.call(this),this.ln&&this.ln.deactivate()}setStyleDeclarationCssText(t,e){const s=this.wn(t);if(!(null==s?void 0:s.ownerNode))return;if(c(s.ownerNode)&&this.us.isSensitiveChild(s.ownerNode))return;const i=this.cs.getId(s.ownerNode);if(!i)return;const n=this.mn(s.cssRules,t.parentRule),r={date:ht(),type:oe.STYLESHEET_CSS_TEXT_UPDATE,args:[i,n,e]};this.zs(r),this.$s.scanCssString(e)}wn(t){const e=t.parentRule;return e&&e.parentStyleSheet}mn(t,e){return csArray.prototype.indexOf.call(csArray.from(t),e)}un(){return window.CSSStyleDeclaration&&window.CSSStyleDeclaration.prototype&&Object.getOwnPropertyDescriptor(window.CSSStyleDeclaration.prototype,"cssText")}sendInsertion(t,[e,s]){if(!t.ownerNode)return;if(c(t.ownerNode)&&this.us.isSensitiveChild(t.ownerNode))return;const i=this.cs.getId(t.ownerNode);if(!i)return;const n={date:ht(),type:oe.STYLESHEET_RULE_INSERT,args:yt(s)?[i,e,s]:[i,e]};this.zs(n),this.$s.scanCssString(e)}sendDeletion(t,[e]){if(!t.ownerNode)return;if(c(t.ownerNode)&&this.us.isSensitiveChild(t.ownerNode))return;const s=this.cs.getId(t.ownerNode);if(!s)return;const i={date:ht(),type:oe.STYLESHEET_RULE_DELETE,args:[s,e]};this.zs(i)}}Zt([Yt("styleSheetRuleTracker.setStyleDeclarationCssText")],Bs.prototype,"setStyleDeclarationCssText",null),Zt([Yt("styleSheetRuleTracker.sendInsertion")],Bs.prototype,"sendInsertion",null),Zt([Yt("styleSheetRuleTracker.sendDeletion")],Bs.prototype,"sendDeletion",null);const Hs="data-cs-mask";class Fs{constructor(t){this.us=t}beforeSerializeChildren(t,e){return this.us.isSensitive(t)||this.En(t)?[]:e}beforeSerializeAttributes(t,e){return this.us.isSensitive(t)&&!S(t)&&(csArray.prototype.push.call(e,this.yn(t)),t.hasAttribute(Hs)||csArray.prototype.push.call(e,document.createAttribute(Hs))),csArray.prototype.filter.call(e,(e=>!this.us.isSensitiveAttribute(t,e.name)))}En(t){return T(t)&&this.us.isSensitive(t.host)}yn(t){const e=t.getBoundingClientRect(),s=document.createAttribute("style");return s.value=`width: ${e.width}px !important; height: ${e.height}px !important;`,t.__contentsquare_height=e.height,t.__contentsquare_width=e.width,s}}var qs,Gs,Ys;const Zs=null!==(qs=Nt.Element)&&void 0!==qs?qs:{prototype:{}},js=null!==(Gs=Nt.Node)&&void 0!==Gs?Gs:{prototype:{}},Xs=t=>Object.getOwnPropertyDescriptor(t.prototype,"localName"),Ks=null!==(Ys=Xs(Zs))&&void 0!==Ys?Ys:Xs(js);var Qs;!function(t){t[t.WebElement=0]="WebElement",t[t.MobileView=1]="MobileView",t[t.WebViewContainer=2]="WebViewContainer"}(Qs||(Qs={}));class Js{constructor(t){this.csId=t.__contentsquare_identifier,this.format=Qs.WebElement,t.__contentsquare_artificial&&(this.artificial=t.__contentsquare_artificial)}}class ti extends Js{constructor(t){var e;super(t),this.attributes=[],this.localName=(e=t,Ks.get.call(e)),this.namespaceURI=t.namespaceURI,this.children=[],this.nodeType=1}}const ei=["id","class","style","src","srcset","sizes","href","rel","type","width","height","media","align","dir","bgcolor","color","border","colspan","rowspan","cols","rows","size","start","slot",L];class si{constructor(t,e){this.L=t,this.$=e,this.An=new Set,this.gn=""}init(){csArray.prototype.forEach.call(ei,(t=>{this.An.add(t)})),csArray.prototype.forEach.call(this.$.whitelistedAttributes,(t=>{this.An.add(t)}))}beforeSerializeChildren(t,e,s){return(f(t)||this.vn(t))&&(s.withAnonymization=!1),e}serializeAttribute(t,e,s,i){s.anonymized=i.withAnonymization;const n=this.getAnonymizedAttributeValue(t,i.withAnonymization,s.name,s.value);s.value=n}serializeTextNode(t,e,s){e.data=this.getAnonymizedText(s.withAnonymization,t,e.data)}serializeCDATASectionNode(t,e,s){const i=t.data;return e.data=s.withAnonymization?zs(i):this.L.anonymizePII(i),e}getAnonymizedText(t,e,s){if(csNodeparentNode.apply(e)){if(f(csNodeparentNode.apply(e)))return s;if(t&&this.vn(csNodeparentNode.apply(e)))return this.L.anonymizeCreditCard(this.L.anonymizeEmail(s))}return t?zs(s):this.L.anonymizeCreditCard(this.L.anonymizeEmail(s))}getAnonymizedAttributeValue(t,e,s,i){return this._n(s)||v(t)||c(n=t)&&"slot"===n.localName?i:e&&y(t)&&("submit"===t.type||"button"===t.type)&&"value"===s?zs(i):e?"":this.L.anonymizeCreditCard(this.L.anonymizeEmail(i));var n}setWhitelistedElementsSelector(t){this.gn=t}getWhitelistedElementsSelector(){return this.gn}afterSerialize(t,e,s){null==e.anonymized&&(e.anonymized=s.withAnonymization),e instanceof ti&&e.shadowRoot&&null==e.shadowRoot.anonymized&&(e.shadowRoot.anonymized=s.withAnonymization)}_n(t){return this.An.has(t)}vn(t){return c(t)&&(t.hasAttribute("data-cs-capture")||this.Rn(t))}Rn(t){return!!this.gn&&I.call(t,this.gn)}}class ii{constructor(...t){this.Sn=t}addProvider(t){csArray.prototype.push.call(this.Sn,t)}getRequestParameters(){return csArray.prototype.reduce.call(this.Sn,((t,e)=>({...e.getRequestParameters(),...t})),{})}}function ni(t,e){let s,i,n,r,o=null;const a=h=>{const c=ht();if(!h&&null!==o){const t=e-(c-o);if(t>0)return void(i=window.setTimeout(a,t))}const l=c-n;i=null,o=null,n=null,r=t(l,...s)},h=(...t)=>{if(s=[...t],!n)return n=ht(),i=window.setTimeout(a,e),r;o=ht()};return h.flushPending=()=>{i&&(window.clearTimeout(i),a(!0))},h.cancel=()=>{o=null,n=null,i&&(window.clearTimeout(i),i=null)},h}function ri(t=0){return(e,s,i)=>{const n=i.value;let r=!1;i.value=function(...e){r||(r=!0,setTimeout((()=>{r=!1,n.apply(this,e)}),t))}}}class oi{constructor(t){this.$=t,this.Tn=!1,this.In=ni((()=>{this.Tn=!1,this.Pn()}),this.$.pendingInactivityTimeout)}start(){this.Tn=!0,this.In()}stop(){this.Tn=!1,this.In.cancel()}trackActivity(){this.Tn||(this.Tn=!0,this.bn()),this.In()}isUserActive(){return this.Tn}onActivityStopped(t){this.Pn=t}onActivityResumed(t){this.bn=t}}class ai{constructor(t,e,s){this.Vn=t,this.L=e,this.Cn=s,this.Nn=[{boundElement:window,type:"resize",listener:()=>this.resizeListener()},{boundElement:window,type:"hashchange",listener:()=>this.hashChangeListener()},{boundElement:document,type:"visibilitychange",listener:()=>this.visibilityChangeListener()}]}onEvent(t){this.zs=t}start(){this._s(),this.triggerInitialEvents(),this.Cn&&(this.Cn.setOnScreenChangedCallback(this.zs),this.Cn.start())}stop(){var t;this.bs(),null===(t=this.Cn)||void 0===t||t.stop()}_s(){csArray.prototype.forEach.call(this.Nn,(t=>ge(t)))}bs(){csArray.prototype.forEach.call(this.Nn,(t=>me(t)))}triggerInitialEvents(){this.resizeListener(),this.hashChangeListener()}resizeListener(){var t;const e={type:oe.RESIZE,args:[ws.windowWidth(),ws.windowHeight()],date:ht()};this.zs(e),null===(t=this.Cn)||void 0===t||t.onScreenPotentiallyChanged()}hashChangeListener(){const t={type:oe.HASH_CHANGE,args:[this.L.anonymizePII(this.Vn.href)],date:ht()};this.zs(t)}visibilityChangeListener(){const t={type:oe.VISIBILITY_CHANGE,args:[document.visibilityState],date:ht()};this.zs(t)}}Zt([Yt("resize")],ai.prototype,"resizeListener",null),Zt([Yt("hashChange")],ai.prototype,"hashChangeListener",null),Zt([Yt("visibilityChange")],ai.prototype,"visibilityChangeListener",null);class hi extends Ze{constructor(t,e,s,i,n,r,o){super(),this.Zi=t,this.Gi=e,this.On=s,this.kn=i,this.Os=n,this.$n=r,this.Ls=o,this.Ln=0}init(){this.Zi.onEvent(((t,e)=>{e||this.xn()})),this.kn.onRecordingRequestSent((()=>{this.Ln+=1,this.Mn()})),this.On.onActivityStopped((()=>{this.Mn()})),this.On.onActivityResumed((()=>{this.Gi.isStarted()||this.Dn()}))}onIframeRecordingUserEvent(t){this.xn()}onStart(){this.On.start()}onStop(){this.On.stop()}Mn(){this.Gi.isStarted()&&!this.Os.isDOMSerializationInProgress()&&!this.On.isUserActive()&&this.Ln>=2&&this.Un()}xn(){this.On.trackActivity(),this.Ln=0}Un(){this.Gi.stop(),this.Ls.emitRecordingStatusChange()}Dn(){this.Os.setAnonymization(this.$n.shouldUseAnonymization()),this.Gi.start(),this.Ls.emitRecordingStatusChange()}}var ci,li,ui,di=/(@import\s*("([^"]+)"|'([^']+)'))|(url\s*\(\s*((("([^"\]]+)"|'([^'\]]+)')\s*)|([^)\]]+))\))/g;function pi(t){var e=[];return function(t,e){var s=t.replace(di,(function(){for(var t=[],s=0;s<arguments.length;s++)t[s]=arguments[s];var i=t[3]||t[4],n=t[9]||t[10]||t[11],r=(i||n).trim().replace(/(\\)*\\(?:([a-fA-F0-9]{1,6})|(.))[\n\t\x20]?/g,(function(t,e,s,i){if("\\"===e)return t.slice(1);if(i)return i;var n=parseInt(s,16);return 55296<=n&&n<=57343||0===n||n>1114111?"":String.fromCodePoint(n)}));return(i?"@import ":"")+"url("+function(t){return-1===t.indexOf('"')?'"'+t+'"':-1===t.indexOf("'")?"'"+t+"'":t}(e(r)||r)+")"}))}(t,(function(t){return e.push(t),t})),e}function gi(t){return lt(t,"data:")}function mi(t){return lt(t,"#")}function fi(t){const e=csString.prototype.trim.call(t);if(""===t)return[];let[s,i]=(n=e,csString.prototype.split.call(n,/\s(.+)/));var n;return i?(ut(s,",")||(i=function(t){return csString.prototype.split.call(t,/,(.+)/)[1]||""}(i)),[yi(s),...fi(i)]):[yi(s)]}function yi(t){return csString.prototype.split.call(t,/,$/)[0]}class Ei{constructor(){this.zn=!0}enable(){this.zn||(this.zn=!0)}disable(){this.zn&&(this.zn=!1)}onEvent(t){this.zs=t}onAsset(t){this.Fn=t}onStyleSheetFound(t){this.Bn=t}serializeElementNode(t){this.zn&&this.Hn(t)}beforeSerializeChildren(t,e,s){return this.zn&&this.qn(t,e),e}scanAttribute(t,e){this.jn(t,e)}scanText(t){l(t)&&csNodeparentNode.apply(t)&&f(csNodeparentNode.apply(t))&&this.scanCssString(t.data)}scanCssString(t){this.Gn(pi(t))}Hn(t){this.jn(t)}qn(t,e){f(t)&&xe(e,(t=>{l(t)&&this.scanCssString(t.data)}))}jn(t,e){this.Zn(t,e)||(this.Wn(t,e),this.Kn(t,e),this.Yn(t,e))}Zn(t,e){var s,i,n;if(g(t)&&(!e||"href"===e)&&t.href){const e=(null===(s=t.sheet)||void 0===s?void 0:s.href)||t.href,r={assetId:e,assetBasePath:window.location.href,assetRawPath:t.getAttribute("href")};return null===(i=this.Bn)||void 0===i||i.call(this,r),null===(n=this.Fn)||void 0===n||n.call(this,r),this.Qn(e),!0}return!1}Jn(t){return!this.Xn(t)&&!gi(t)&&!mi(t)}Wn(t,e){var s;if(m(t)){if(!e||"src"===e){const e=t.getAttribute("src");e&&this.Jn(e)&&(this.Qn(t.src),null===(s=this.Fn)||void 0===s||s.call(this,{assetId:t.src,assetRawPath:e,assetBasePath:window.location.href}))}e&&"srcset"!==e||!t.srcset||this.tr(t.srcset)}}Kn(t,e){if((!e||"style"===e)&&t.hasAttribute("style")){const e=t.getAttribute("style");if("string"!=typeof e)throw new Error("Unexpected style: "+t.outerHTML);this.scanCssString(e)}}tr(t){this.Gn(fi(t))}Yn(t,e){var s,i;if((v(i=t)&&"image"===i.localName||function(t){return v(t)&&"use"===t.localName}(t)||function(t){return v(t)&&"feImage"===t.localName}(t))&&(!e||"href"===e||"xlink:href"===e)){const e=t.getAttribute("href")||t.getAttribute("xlink:href");if(e&&this.Jn(e)){const t=kt(e);this.Qn(t),null===(s=this.Fn)||void 0===s||s.call(this,{assetId:t,assetRawPath:e,assetBasePath:window.location.href})}}}Gn(t){return csArray.prototype.forEach.call(csArray.prototype.map.call(csArray.prototype.filter.call(csArray.prototype.filter.call(csArray.prototype.filter.call(t,(t=>!this.Xn(t))),(t=>!gi(t))),(t=>!mi(t))),(t=>({rawUrl:t,absoluteUrl:kt(t)}))),(t=>{var e;this.zs&&this.Qn(t.absoluteUrl),null===(e=this.Fn)||void 0===e||e.call(this,{assetId:t.absoluteUrl,assetBasePath:window.location.href,assetRawPath:t.rawUrl})}))}Qn(t){var e;const s={date:ht(),type:oe.STATIC_RESOURCE_URL,args:[t]};null===(e=this.zs)||void 0===e||e.call(this,s)}Xn(t){return/^https:\/\/\w+:\w+@/.test(t)}}!function(t){t.REQUEST_START="requestStart",t.DOM_INTERACTIVE="domInteractive",t.TIME_ORIGIN="timeOrigin"}(ci||(ci={}));class Si{constructor(t){this.ir=t.performance}onEvent(t){this.zs=t}start(){this.er()&&this.nr()}nr(){const t={args:this.rr(),date:ht(),type:oe.PERFORMANCE_TIMINGS};this.zs(t)}er(){return!(!this.ir||!this.ir.timing)}rr(){return[{performanceTiming:ci.REQUEST_START,timestamp:this.ir.timing.requestStart},{performanceTiming:ci.DOM_INTERACTIVE,timestamp:this.ir.timing.domInteractive},{performanceTiming:ci.TIME_ORIGIN,timestamp:this.ir.timeOrigin}]}}class vi extends Ze{constructor(t){super(),this.hr=t,this.cr=new Map}init(){this.ar(),this.ur()}ur(){this.Li=new csMutationObserver((t=>{We((()=>this.handleMutations(t)))}))}ar(){this.lr()&&(this.wr=ys({target:Element.prototype,methodName:"attachShadow",hook:({context:t,result:e})=>this.handleAttachShadow(t,e)})),this.pr()&&(this.mr=ys({target:Element.prototype,methodName:"createShadowRoot",hook:({context:t,result:e})=>this.handleAttachShadow(t,e)}))}onChildListMutation(t){this.Er=t}onCharacterDataMutation(t){this.yr=t}onAttributesMutation(t){this.Ar=t}onAttachShadowMutation(t){this.gr=t}observe(t,e){this.isStarted&&this.Li.observe(t,e)}onStart(){this.wr&&this.wr.activate(),this.mr&&this.mr.activate()}onStop(){this.wr&&this.wr.deactivate(),this.mr&&this.mr.deactivate(),this.hr.clearQueue(),this.Li.disconnect()}flushPendingMutations(){if(!this.isStarted)return;this.hr.runPendingTasks();const t=this.Li.takeRecords();this.handleMutations(t,!0)}lr(){return window.Element&&window.Element.prototype&&"function"==typeof window.Element.prototype.attachShadow}pr(){return window.Element&&window.Element.prototype&&"function"==typeof window.Element.prototype.createShadowRoot}handleMutations(t,e=!1){const s=ht(),i=t.length>1?this.vr(t):t;this.hr.isEmpty()&&this.cr.clear(),this._r(i);for(let t=0;t<i.length;t+=1){const n=i[t];n.date=s,this.hr.schedule((()=>{this.processMutation(n,this.cr)}),e)}}vr(t){const e=new Map;for(let s=0;s<t.length;s+=1){const i=t[s];if("attributes"!==i.type)continue;const n=i.target,r=i.attributeNamespace,o=i.attributeName,a=`${r||""} ${o}`,h=e.get(n),c=Ts.getAttributeNS(n,r,o)===i.oldValue?"none":"last";if(h)h.has(a)||h.set(a,c);else{const t=new Map;t.set(a,c),e.set(n,t)}}const s=[];for(let i=t.length-1;i>=0;i-=1){const n=t[i];if("attributes"!==n.type){csArray.prototype.push.call(s,n);continue}const r=n.target,o=`${n.attributeNamespace||""} ${n.attributeName}`,a=e.get(r);"last"===a.get(o)&&(csArray.prototype.push.call(s,n),a.set(o,"none"))}return csArray.prototype.reverse.call(s)}handleAttachShadow(t,e){this.gr({shadowRoot:e,date:ht(),target:t})}processMutation(t,e){switch(t.type){case"attributes":this.Ar(t);break;case"characterData":this.yr(t);break;case"childList":this.Er(t,e);break;default:throw new Error("mutation type is not supported")}}_r(t){csArray.prototype.forEach.call(t,(t=>{xe(t.addedNodes,(t=>{const e=this.cr.get(t);e?this.cr.set(t,e+1):this.cr.set(t,1)}))}))}}Zt([Yt("handleMutations")],vi.prototype,"handleMutations",null),Zt([Ce("handleAttachShadow")],vi.prototype,"handleAttachShadow",null),Zt([Ce("processMutation")],vi.prototype,"processMutation",null);class wi extends vi{constructor(t,e){super(t),this.cs=e,this.Rr={subtree:!0,attributes:!0,childList:!0,characterData:!0,attributeOldValue:!0,characterDataOldValue:!0}}init(){super.init(),this.vs()}vs(){this.cs.onDocumentIdentified((t=>{this.observe(t,this.Rr)}))}}class Ri{constructor(t){this.Sr=[],this.Tr=[],this.Ut={},this.zt=t}setQueryParams(t){csArray.prototype.forEach.call(Object.keys(t),(e=>{this.Ut[e]=t[e]}))}removeQueryParams(t){t?csArray.prototype.forEach.call(t,(t=>{delete this.Ut[t]})):this.Ut={}}onBeaconSuccess(t){csArray.prototype.push.call(this.Sr,t)}onBeaconFailure(t){csArray.prototype.push.call(this.Tr,t)}send(t){const e=K.toQuery({...this.Ut,ct:re.UNCOMPRESSED}),s=this.Ir(e,t);return s?csArray.prototype.forEach.call(this.Sr,(t=>t())):csArray.prototype.forEach.call(this.Tr,(t=>t(this.Ut))),s}Ir(t,e){try{if("function"!=typeof csNavigatorsendBeacon)return!1;const s=csNavigatorsendBeacon(`${this.zt}?${t}`,e||"");if(s)return s}catch{}return"function"==typeof navigator.sendBeacon&&navigator.sendBeacon(`${this.zt}?${t}`,e||"")}}function Ai(t){const e=new ArrayBuffer(t.length),s=new Uint8Array(e);for(let e=0,i=t.length;e<i;e+=1)s[e]=csString.prototype.charCodeAt.call(t,e);return e}function Ti(t){const e=-1!==csString.prototype.indexOf.call(t,";base64,"),s=csString.prototype.indexOf.call(t,","),i=e?[csString.prototype.substring.call(t,0,s-7),csString.prototype.substring.call(t,s+1)]:[csString.prototype.substring.call(t,0,s),csString.prototype.substring.call(t,s+1)];!e&&/^%3Csvg/i.test(i[1])&&(i[1]=decodeURIComponent(i[1]));const n=e?(r=i[1],Ai(self.atob(r))):Ai(i[1]);var r;return new Blob([n],{type:csString.prototype.replace.call(i[0],"data:","")})}function _i(t){const e=csArray.from(new Uint8Array(t));return csArray.prototype.join.call(csArray.prototype.map.call(e,(t=>csString.prototype.padStart.call(t.toString(16),2,"0"))),"")}class bi{constructor(t){this.Pr=t,this.br=!1}init(){this.br=this.Vr(),this.br&&(this.Cr=new TextEncoder)}isSupported(){return this.br}isValidInput(t){return!!t&&t.length<=100}async digest(t,e){if(!this.br)return null;const s=this.Nr(t,e),i=this.Cr.encode(s);try{return _i(await crypto.subtle.digest("SHA-1",i))}catch{return null}}Vr(){return!!(this.Pr&&this.Pr.subtle&&this.Pr.subtle.digest&&self.TextEncoder&&csArray.from)}Nr(t,e){return`${csString.prototype.toLowerCase.call(csString.prototype.trim.call(t))}:${e}`}}!function(t){t[t.TAP=0]="TAP",t[t.LONG_PRESS=1]="LONG_PRESS",t[t.DRAG=2]="DRAG",t[t.FLICK=3]="FLICK",t[t.PINCH_IN=4]="PINCH_IN",t[t.PINCH_OUT=5]="PINCH_OUT"}(li||(li={})),function(t){t[t.UP=1]="UP",t[t.DOWN=2]="DOWN",t[t.LEFT=3]="LEFT",t[t.RIGHT=4]="RIGHT"}(ui||(ui={}));class Ci{constructor(t,e,s){this.Or=t,this.cs=e,this.us=s}start(){this.Or.subscribe(Ci.kr,((t,e)=>this.processGesture(t,e)))}stop(){this.Or.unsubscribe(Ci.kr)}onEvent(t){this.zs=t}processGesture(t,e){if(!t.target)return;if(c(t.target)&&this.us.isSensitiveChild(t.target))return;const s=this.cs.getId(t.target);if(s)switch(t.type){case li.DRAG:case li.FLICK:this.$r(ce.SWIPE,t,s,e);break;case li.LONG_PRESS:this.$r(ce.LONG_PRESS,t,s,e);break;case li.TAP:this.$r(ce.TAP,t,s,e);break;case li.PINCH_IN:this.$r(ce.PINCH_IN,t,s,e);break;case li.PINCH_OUT:this.$r(ce.PINCH_OUT,t,s,e)}}$r(t,e,s,i){const n=this.Lr(e,t,i),r={type:oe.GESTURE_RECOGNITION,args:[s,n],date:ht()};this.zs(r)}Lr(t,e,s){const i={type:e};if(t.direction&&(i.direction=t.direction),t.distance&&(i.distance=t.distance),t.velocity&&(i.velocity=t.velocity),e===ce.TAP&&s.changedTouches&&1===s.changedTouches.length){const t=s.changedTouches[0];i.pageX=fe(t.pageX,1),i.pageY=fe(t.pageY,1)}return i}}Ci.kr="RecordingGesturesTracker",Zt([Oe()],Ci.prototype,"processGesture",null);class Ni extends Js{constructor(t){super(t),this.name=t.name,this.publicId=t.publicId,this.systemId=t.systemId,this.nodeType=10}}class Oi{constructor(t){var e;this.name=t.name,this.value=t.value,this.namespaceURI=null!==(e=t.namespaceURI)&&void 0!==e?e:""}}class Ii extends Js{constructor(t){super(t),this.data=t.data,this.nodeType=3}}class Pi extends Js{constructor(t){super(t),this.data=t.data,this.nodeType=4}}class ki extends Js{constructor(t){super(t),this.data=t.data,this.nodeType=8}}class Li extends Js{constructor(t){super(t),this.baseURI=Li.getBaseURI(t),this.children=[],this.nodeType=9}static getBaseURI(t){let e=t.baseURI;if(null==e){const s=t.getElementsByTagName("base");e=0!==s.length?s[0].href:t.URL}return e}}class Di extends Js{constructor(t){super(t),this.mode=t.mode,this.children=[],this.nodeType=11}}class Mi{constructor(t){for(const e of Mi.Mr){const s=csArray.prototype.map.call(csArray.prototype.filter.call(t,(t=>t[e])),(t=>(s,i,n,r)=>t[e](s,i,n,r))),i=Mi.Dr(s);this[e]=i}}static create(t){return new Mi(t)}static Dr(t){const[e,s,i,n,r]=csArray.prototype.map.call(t,(t=>(e,s,i,n)=>t(e,s,i,n)||s));switch(t.length){case 0:return(t,e)=>e;case 1:return t[0];case 2:return(t,i,n,r)=>s(t,e(t,i,n,r),n,r);case 3:return(t,n,r,o)=>i(t,s(t,e(t,n,r,o),r,o),r,o);case 4:return(t,r,o,a)=>n(t,i(t,s(t,e(t,r,o,a),o,a),o,a),o,a);case 5:return(t,o,a,h)=>r(t,n(t,i(t,s(t,e(t,o,a,h),a,h),a,h),a,h),a,h);default:return(e,s,i,n)=>{let r=s;for(let o=0;o<t.length;o++)r=t[o](e,s,i,n)||r;return s}}}}Mi.Mr=["beforeSerializeAttributes","beforeSerializeChildren","afterSerialize","afterSerializeShadowRoot","serializeElementNode","serializeAttribute","serializeTextNode","serializeCDATASectionNode","serializeCommentNode","serializeDocumentNode","serializeShadowRootNode","serializeTextMutation","serializeAttributeMutationValue"];class xi{constructor(t){this.Ur=Mi.create(t)}isAsynchronous(){return!0}serializeTextMutation(t,e){return this.Ur.serializeTextMutation(t,e)}serializeAttributeMutationValue(t,e,s){return this.Ur.serializeAttributeMutationValue(t,s,e)}serialize(t,e){const s={...e},i=t.nodeType;let n;switch(i){case 1:n=this.zr(t,s);break;case 3:n=this.Fr(t,s);break;case 4:n=this.Br(t,s);break;case 7:case 8:n=this.Hr(t,s);break;case 10:n=new Ni(t);break;case 9:n=this.qr(t,s);break;case 11:n=this.jr(t,s);break;default:throw new Error(`serialization is not supported (nodeType: ${i})`)}return this.Ur.afterSerialize(t,n,s),n}zr(t,e){const s=new ti(t);this.Ur.serializeElementNode(t,s,e),s.attributes=this.Gr(t,e);const i=csElementshadowRoot.apply(t);return i&&(s.shadowRoot=this.Zr(i,e)),s.children=this.Wr(t,e),s}Gr(t,e){let s=De(t.attributes);s=this.Ur.beforeSerializeAttributes(t,s,e);for(let i=0;i<s.length;++i){const n=s[i];s[i]=this.Kr(t,n,e)}return s}Kr(t,e,s){const i=new Oi(e);return this.Ur.serializeAttribute(t,e,i,s),i}runBeforeSerializeChildrenHook(t,e,s){let i=s||csNodechildNodes.apply(t);return i=e.excludedNodes?$e(i,(t=>!e.excludedNodes.get(t))):i,i=this.Ur.beforeSerializeChildren(t,i,e),De(i)}Wr(t,e){if(e.skipChildrenSerialization)return[];const s=this.runBeforeSerializeChildrenHook(t,e);for(let t=0;t<s.length;++t){const i=s[t];s[t]=this.serialize(i,e)}return s}Fr(t,e){const s=new Ii(t);return this.Ur.serializeTextNode(t,s,e),s}Br(t,e){const s=new Pi(t);return this.Ur.serializeCDATASectionNode(t,s,e),s}Hr(t,e){const s=new ki(t);return this.Ur.serializeCommentNode(t,s,e),s}qr(t,e){const s=new Li(t);return this.Ur.serializeDocumentNode(t,s,e),s.children=this.Wr(t,e),s}Zr(t,e){const s=new Di(t);return this.Ur.serializeShadowRootNode(t,s,e),s.children=this.Wr(t,e),this.Ur.afterSerializeShadowRoot(t,s,e),s}jr(t,e){if(t.mode)return this.Zr(t,e);throw new Error("Not implemented yet.")}}async function Ui(){await new Promise((t=>{setTimeout((()=>{t()}),0)}))}class $i{constructor(t){this.cs=t,this.Yr=!1,this.Qr=new Map,this.Jr={},this.Xr=new Map,this.th=new Map,this.ih=new Set,this.eh=new Map}beforeSerializeChildren(t,e){return this.Yr?$e(e,(t=>!this.isAddedNodeDuringSerialization(t))):e}beforeSerializeAttributes(t,e,s){if(!this.Yr)return e;const i=this.cs.getId(t);if(!i)return e;const n=this.th.get(i);return n?csArray.prototype.filter.call(e,(t=>{const e=`${t.name}${t.namespaceURI||""}`,s=n.get(e);return!(s&&null===s.value)})):e}serializeTextNode(t,e,s){if(!this.Yr)return;const i=this.Xr.get(e.csId);i&&(e.data=i)}serializeCommentNode(t,e){if(!this.Yr)return;const s=this.Xr.get(e.csId);s&&(e.data=s)}afterSerialize(t,e,s){this.Yr&&(csNodeparentNode.apply(t)&&!this.getSerializedNodeByNode(csNodeparentNode.apply(t))||s.skipRegisterNode||this.nh(e,s))}afterSerializeShadowRoot(t,e,s){this.Yr&&(s.skipRegisterNode||this.nh(e,s))}enable(){this.Yr=!0,this.rh()}disable(){this.Yr=!1,this.rh()}setDefaultSerializationOptions(t){this.Jr=t}getSerializedNodeById(t){var e;return null===(e=this.Qr.get(t))||void 0===e?void 0:e.serializedNode}getSerializedNodeByNode(t){var e;const s=this.cs.getId(t);if(s)return null===(e=this.Qr.get(s))||void 0===e?void 0:e.serializedNode}getOptions(t){var e;const s=this.cs.getId(t);return s&&(null===(e=this.Qr.get(s))||void 0===e?void 0:e.options)||this.Jr}registerInitialCharacterData(t,e){this.Xr.get(t)||this.Xr.set(t,e)}registerInitialAttributes(t,e,s,i){let n=this.th.get(t);const r=`${s}${e||""}`;if(n){if(n.has(r))return}else n=new Map,this.th.set(t,n);const o={name:s,namespaceURI:e||"",value:i};n.set(r,o)}markAddedTreeAsProcessed(t){const e=document.createNodeIterator(t,NodeFilter.SHOW_ALL,null,!1);let s;for(;s=e.nextNode();){const t=this.cs.getId(s);t&&this.ih.add(t)}}markRemovedNodeAsProcessed(t,e,s){const i=this.cs.getId(s),n=this.cs.getId(t);if(!i||!n)return;const r=this.eh.get(i);if(r)csArray.prototype.push.call(r.removedNodeIds,n),csArray.prototype.indexOf.call(r.childNodeIds,n)<0&&csArray.prototype.push.call(r.childNodeIds,n);else{const t=[],r=e?this.cs.getId(e):null;for(let e=0;e<csNodechildNodes.apply(s).length;e+=1){const i=this.cs.getId(csNodechildNodes.apply(s)[e]);i&&!this.ih.has(i)&&(r&&i===r&&csArray.prototype.push.call(t,n),csArray.prototype.push.call(t,i))}null===r&&csArray.prototype.push.call(t,n);const o=[n];this.eh.set(i,{childNodeIds:t,removedNodeIds:o})}}addSerializedChildToParent(t,e,s){const i=this.getSerializedNodeByNode(t);i&&Vi(i)&&this.hh(e,i,s)}isAddedNodeDuringSerialization(t){const e=this.cs.getId(t);return!!e&&this.ih.has(e)}getInitialIndexInParent(t,e){const s=this.cs.getId(e),i=this.cs.getId(t);if(!s||!i)return-1;const n=this.eh.get(s);return n?csArray.prototype.indexOf.call(n.childNodeIds,i):-1}rh(){this.Qr.clear(),this.Xr.clear(),this.th.clear(),this.ih.clear(),this.eh.clear()}nh(t,e){t.csId&&(this.oh(t.csId,t,e),this.ah(t.csId,t),this.Qr.set(t.csId,{serializedNode:t,options:e}))}oh(t,e,s){if(!function(t){return t instanceof ti}(e))return;const i=this.th.get(t);if(i){for(const t of e.attributes){const e=`${t.name}${t.namespaceURI||""}`,s=i.get(e);s&&null!==s.value&&(t.value=s.value,i.delete(e))}i.forEach((t=>{null!==t.value&&csArray.prototype.push.call(e.attributes,{name:t.name,value:t.value,namespaceURI:t.namespaceURI,anonymized:s.withAnonymization||!1})}))}}hh(t,e,s){(s.csId||zi(s))&&(t>=0?csArray.prototype.splice.call(e.children,t,0,s):zi(s)&&csArray.prototype.push.call(e.children,s))}ah(t,e){var s;if(!Vi(e))return;const i=this.eh.get(t);if(i)for(const t of i.removedNodeIds){const n=csArray.prototype.indexOf.call(i.childNodeIds,t);if(-1===n)continue;const r=null===(s=this.Qr.get(t))||void 0===s?void 0:s.serializedNode;void 0!==r&&this.hh(n,e,r)}}}function zi(t){return"artificial"in t}function Vi(t){return"children"in t}const Wi={taskTime:25};class Bi extends xi{constructor(t,e,s=new $i(e),i=Wi){super([s,...t]),this.uh=e,this.lh=s,this.fh=i,this.ph=0,this.mh=this.fh.taskTime}isAsynchronous(){return!0}handleMutationAttribute(t,e){const[s,i,n]=e;this.lh.getSerializedNodeById(s)||this.lh.registerInitialAttributes(s,i,n,t)}handleMutationCharacterData(t,e){const[s]=e;this.lh.getSerializedNodeById(s)||this.lh.registerInitialCharacterData(s,t.oldValue||"")}serializeMutationChildList(t,e,s){const i=this.an(t,e,s);return this.Eh(t),{removedNodes:this.cn(t,e),addedNodes:i}}async startSerializeAsync(t,e={}){return this.ph+=1,this.lh.setDefaultSerializationOptions(e),this.yh(t,e)}an(t,e,s){const i=[];let n=null;if(t.nextSibling){const e=this.uh.getId(t.nextSibling);n=void 0!==e?e:null}const r=this.uh.getId(t.target);for(let o=0;o<t.addedNodes.length;o+=1){const a=t.addedNodes[o],h=this.serialize(a,{excludedNodes:s,skipRegisterNode:!0,withAnonymization:e}),c=s.get(a);c&&s.set(a,c-1),csArray.prototype.push.call(i,[r,n,h])}return i}Eh(t){for(let e=0;e<t.addedNodes.length;e+=1){const s=t.addedNodes[e];this.lh.markAddedTreeAsProcessed(s)}}Ah(t,e){if(!e)return-1;const s=this.lh.getInitialIndexInParent(t,e);return s>=0?s:csArray.prototype.indexOf.call(csNodechildNodes.apply(e),t)}cn(t,e){const s=[];for(let i=0;i<t.removedNodes.length;i+=1){const n=t.removedNodes[i];if(this.lh.markRemovedNodeAsProcessed(n,t.nextSibling,t.target),this.gh(n))this._h(n)&&this.Rh(n,e);else{const s=this.serialize(n,{withAnonymization:e});if(this._h(t.target)){const e=this.Ah(n,t.target);this.lh.addSerializedChildToParent(t.target,e,s)}}const r=this.uh.getId(n);r&&csArray.prototype.push.call(s,[r])}return s}Rh(t,e){for(let s=0;s<csNodechildNodes.apply(t).length;s+=1){const i=csNodechildNodes.apply(t)[s];if(this._h(i))this.Rh(i,e);else if(!this.lh.isAddedNodeDuringSerialization(i)){const s=this.serialize(i,{withAnonymization:e}),n=this.Ah(i,t);this.lh.addSerializedChildToParent(t,n,s)}}}_h(t){return!!this.lh.getSerializedNodeByNode(t)}gh(t){return this._h(t)||this.lh.isAddedNodeDuringSerialization(t)}async yh(t,e={}){const s=this.ph,i=ht();this.lh.enable(),e.skipChildrenSerialization=!0;const n=[t];if(await Ui(),s!==this.ph)return null;for(this.Sh=csDate.now(),this.serialize(t,e);n.length>0;){const t=csArray.prototype.pop.call(n),e=this.lh.getOptions(t),i=this.runBeforeSerializeChildrenHook(t,e);let r=csArray.prototype.shift.call(i);for(;r;){if(csDate.now()-this.Sh>this.mh){if(await Ui(),s!==this.ph)return null;this.Sh=csDate.now()}if(this.gh(r)){r=csArray.prototype.shift.call(i);continue}csArray.prototype.push.call(n,r);const o=this.serialize(r,e),a=this.Ah(r,t);if(this.lh.addSerializedChildToParent(t,a,o),c(r)&&csElementshadowRoot.apply(r)){const t=csElementshadowRoot.apply(r);csArray.prototype.push.call(n,t)}r=csArray.prototype.shift.call(i)}}const r=this.lh.getSerializedNodeByNode(t);if(!r)throw this.lh.disable(),new Error("traverseAndSerialize : fail to serialize");return this.lh.disable(),{args:[r],date:i,type:oe.INITIAL_DOM}}}class Hi extends xi{isAsynchronous(){return!1}}class Fi{constructor(){this.Th=new Map,this.Ih=document.implementation.createHTMLDocument("")}beforeSerializeChildren(t,e){if(!f(t))return e;const s=this.Ph(t);if(null===s||0===s.length)return e;if(function(t){const e=t.length;for(let s=0;s<e;s++)switch(csString.prototype.charCodeAt.call(t,s)){case 9:case 10:case 11:case 12:case 13:case 32:case 160:continue;default:return!1}return!0}(t.textContent)){const t=De(e);return csArray.prototype.push.call(t,this.bh(s)),t}{const i=this.Vh(t);if(i===s.length)return e;const n=new csArray(s.length-i);for(let t=i,e=0;t<s.length;t+=1,e+=1)n[e]=s[t];const r=De(e);return csArray.prototype.push.call(r,this.bh(n)),r}}Vh(t){let e=this.Th.get(t.textContent);if(e)return e;const s=t.cloneNode(!0);s.textContent=t.textContent,this.Ih.head.appendChild(s);const i=this.Ph(s);return e=i?i.length:0,this.Th.set(t.textContent,e),this.Ih.head.removeChild(s),e}Ph(t){try{if(t.disabled)return null;const e=t.sheet;return e?e.cssRules||e.rules:null}catch(t){if("SecurityError"!==t.name&&"InvalidAccessError"!==t.name)throw t;return null}}bh(t){let e="";xe(t,(t=>e+=t.cssText));const s=document.createTextNode(e);return s.__contentsquare_artificial=!0,s}}class qi{constructor(t,e){this.cs=t,this.ji=e,this.Ch=1,this.Ms=!1}isAdoptedStyleSheetsSupported(){return"adoptedStyleSheets"in Document.prototype&&"queueMicrotask"in window}init(){this.isAdoptedStyleSheetsSupported()&&(this.Nh=new Set,this.Oh=Es(window.ShadowRoot.prototype,"adoptedStyleSheets",this.kh.bind(this)),this.$h=Es(window.Document.prototype,"adoptedStyleSheets",this.kh.bind(this)))}onEvent(t){this.zs=t}start(){!this.Ms&&this.isAdoptedStyleSheetsSupported()&&(this.Ms=!0,this.Lh(),this.Oh&&this.Oh.activate(),this.$h&&this.$h.activate())}stop(){this.Ms&&this.isAdoptedStyleSheetsSupported()&&(this.Ms=!1,this.xh(),this.Nh.clear(),this.Oh&&this.Oh.deactivate(),this.$h&&this.$h.deactivate())}serializeDocumentNode(t){var e;(null===(e=t.adoptedStyleSheets)||void 0===e?void 0:e.length)&&this.kh(t,t.adoptedStyleSheets)}serializeShadowRootNode(t){var e;(null===(e=t.adoptedStyleSheets)||void 0===e?void 0:e.length)&&this.kh(t,t.adoptedStyleSheets)}Lh(){this.dn=this.ji.registerToInsertRuleInterceptor(this.Mh.bind(this)),this.fn=this.ji.registerToDeleteRuleInterceptor(this.Dh.bind(this))}xh(){var t,e;null===(t=this.dn)||void 0===t||t.call(this),null===(e=this.fn)||void 0===e||e.call(this)}kh(t,e){this.Ms&&We((()=>{csArray.prototype.forEach.call(e,(t=>this.Uh(t)));const s=csArray.prototype.map.call(e,(t=>this.zh(t))),i=this.cs.getId(t);if(!i)return;const n={type:oe.SET_ADOPTED_STYLE_SHEETS,args:[i,s],date:ht()};this.zs(n)}))}zh(t){return t.__adopted_stylesheet_id}Mh(t,[e,s]){const i=this.Fh(t);if(!i)return;const n={date:ht(),type:oe.ADOPTED_STYLESHEET_RULE_INSERT,args:yt(s)?[i,e,s]:[i,e]};this.zs(n)}Dh(t,[e]){const s=this.Fh(t);if(s&&s){const t={date:ht(),type:oe.ADOPTED_STYLESHEET_RULE_DELETE,args:[s,e]};this.zs(t)}}Fh(t){return this.Nh.has(t)&&t.__adopted_stylesheet_id?t.__adopted_stylesheet_id:null}Uh(t){if(this.Nh.has(t))return;const e=this.Ch++;t.__adopted_stylesheet_id=e,this.Nh.add(t);const s=this.Bh(t),i={type:oe.REGISTER_ADOPTED_STYLE_SHEET,args:[e,s],date:ht()};this.zs(i)}Bh(t){let e=[];try{e=csArray.prototype.map.call(t.cssRules,(t=>t.cssText))}catch{qt.warn("AdoptedStylesheetsTracker.serializeStyleSheet: could not extract cssRules")}return{cssRules:e}}}var Gi,Yi,Zi,ji,Xi,Ki,Qi,Ji;!function(t){t.replayRecordingUnmaskedUrlRegex="replayRecordingUnmaskedUrlRegex",t.replayRecordingMaskedUrlRegex="replayRecordingMaskedUrlRegex",t.replayRecordingUnmaskedUrlRegexRules="replayRecordingUnmaskedUrlRegexRules",t.replayRecordingMaskedUrlRegexRules="replayRecordingMaskedUrlRegexRules"}(Gi||(Gi={})),function(t){t.START="start",t.NOT_START="not-start",t.END="end",t.NOT_END="not-end",t.CONTAIN="contain",t.NOT_CONTAIN="not-contain",t.EXACT="exact",t.NOT_EXACT="not-exact"}(Yi||(Yi={}));class tn{constructor(t,e,s,i){this.Hh=t,this.$=e,this.X=s,this.qh=i}init(){this.jh()}shouldUseAnonymization(){if(this.Hh.isReplayUnanonymizedAllowedByConsent()){switch(this.$.anonymisationMethod){case null:case Gi.replayRecordingMaskedUrlRegex:return!(!this.$.replayRecordingMaskedUrlRegex||!this.$.replayRecordingMaskedUrlRegex.test(this.X.getAnonymizedUrl()));case Gi.replayRecordingMaskedUrlRegexRules:return this.qh.evaluateUrl(this.X.getAnonymizedUrl())}return!1}switch(this.$.anonymisationMethod){case null:case Gi.replayRecordingUnmaskedUrlRegex:return!(this.$.replayRecordingUnmaskedUrlRegex&&this.$.replayRecordingUnmaskedUrlRegex.test(this.X.getAnonymizedUrl()));case Gi.replayRecordingUnmaskedUrlRegexRules:return!this.qh.evaluateUrl(this.X.getAnonymizedUrl())}return!0}jh(){this.$.anonymisationMethod===Gi.replayRecordingMaskedUrlRegexRules&&this.$.replayRecordingMaskedUrlRegexRules?this.qh.setRegexRules(this.$.replayRecordingMaskedUrlRegexRules):this.$.anonymisationMethod===Gi.replayRecordingUnmaskedUrlRegexRules&&this.$.replayRecordingUnmaskedUrlRegexRules&&this.qh.setRegexRules(this.$.replayRecordingUnmaskedUrlRegexRules)}}class en{static isRecordingSupported(){return"MutationObserver"in window&&"visibilityState"in document}static isAsyncSerializationSupported(){return"Promise"in window&&"findIndex"in csArray.prototype}}class sn{constructor(){this.Ms=!1,this.Gh=[],this.Zh=[],this.Wh()}registerToInsertRuleInterceptor(t){return this.Kh(this.Gh,t)?()=>{}:(csArray.prototype.push.call(this.Gh,t),()=>{this.Gh=csArray.prototype.filter.call(this.Gh,(e=>e!==t))})}registerToDeleteRuleInterceptor(t){return this.Kh(this.Zh,t)?()=>{}:(csArray.prototype.push.call(this.Zh,t),()=>{this.Zh=csArray.prototype.filter.call(this.Zh,(e=>e!==t))})}start(){var t,e;this.Ms||(this.Ms=!0,null===(t=this.Yh)||void 0===t||t.activate(),null===(e=this.Qh)||void 0===e||e.activate())}stop(){var t,e;this.Ms&&(this.Ms=!1,null===(t=this.Yh)||void 0===t||t.deactivate(),null===(e=this.Qh)||void 0===e||e.deactivate())}Kh(t,e){return csArray.prototype.indexOf.call(t,e)>-1}Jh(t,e){csArray.prototype.forEach.call(this.Gh,(s=>s(t,e)))}Xh(t,e){csArray.prototype.forEach.call(this.Zh,(s=>s(t,e)))}Wh(){this.so()&&(this.Yh=ys({target:window.CSSStyleSheet.prototype,methodName:"insertRule",hook:({context:t,args:e})=>{this.Jh(t,e)}})),this.io()&&(this.Qh=ys({target:window.CSSStyleSheet.prototype,methodName:"deleteRule",hook:({context:t,args:e})=>this.Xh(t,e)}))}so(){var t,e;return"function"==typeof(null===(e=null===(t=window.CSSStyleSheet)||void 0===t?void 0:t.prototype)||void 0===e?void 0:e.insertRule)}io(){var t,e;return"function"==typeof(null===(e=null===(t=window.CSSStyleSheet)||void 0===t?void 0:t.prototype)||void 0===e?void 0:e.deleteRule)}}class nn{constructor(t){this.eo={},this.no=new Fe(t)}save({key:t,metadata:e,events:s}){this.no.isThresholdReached()||(this.no.addString(t),"string"==typeof s?this.no.addString(s):this.no.addArrayBuffer(s),this.no.isThresholdReached()||(this.eo[t]={metadata:e,events:s}))}recover(t){const e=[];csArray.prototype.forEach.call(this.ro(),(t=>{const s=this.eo[t];void 0!==s&&(delete s.metadata.datatype,csArray.prototype.push.call(e,s),this.ho(t))})),0!==e.length&&(t(e),this.no.reset())}ro(){return Object.keys(this.eo)}ho(t){delete this.eo[t]}}!function(t){t[t.NOT_STARTED=0]="NOT_STARTED",t[t.OPEN_IN_PROGRESS=1]="OPEN_IN_PROGRESS",t[t.OPEN_FAILED=2]="OPEN_FAILED",t[t.READY=3]="READY"}(Zi||(Zi={}));class rn{constructor(t,e,s){this.oo=t,this.co=s,this.ao=Zi.NOT_STARTED,this.uo=[],this.lo=0,this.do=self.origin,this.fo="object"==typeof window?"":"worker-",this.no=new Fe(e),this.wo()}async wo(){await this.po(),this.ao===Zi.READY?this.mo():this.co(this.uo)}mo(){csArray.prototype.forEach.call(this.uo,(t=>{this.save(t)})),this.uo=[]}async save(t){try{if(this.ao===Zi.OPEN_IN_PROGRESS)return void csArray.prototype.push.call(this.uo,t);if(this.ao!==Zi.READY)return;if(this.no.isThresholdReached())return;const{key:e,metadata:s,events:i}=t;if(this.no.addString(e),"string"==typeof i?this.no.addString(i):this.no.addArrayBuffer(i),this.no.isThresholdReached())return;await this.Eo.put(`${this.do}/${e}`,new Response(i,{headers:s}))}catch{}}async recover(t){(this.Eo||(await this.po(),this.ao===Zi.READY))&&this.yo(t)}async po(){try{this.ao=Zi.OPEN_IN_PROGRESS,this.Eo=await self.caches.open(`${this.fo}${this.oo}`),this.ao=Zi.READY}catch{this.ao=Zi.OPEN_FAILED}}async yo(t){try{if(this.lo++,this.lo>1)return;const e=await this.Eo.keys();if(0===e.length)return;const s=await this.Eo.matchAll(),i=csArray.prototype.map.call(s,(t=>{const e={};t.headers.forEach(((t,s)=>{e[s]=t})),delete e["content-type"];const s=e.datatype;return delete e.datatype,"json"===s||"base64"===s?t.text().then((t=>({metadata:e,events:t}))):t.arrayBuffer().then((t=>({metadata:e,events:t})))})),n=await Promise.all(i);await Promise.all(csArray.prototype.map.call(e,(t=>this.Eo.delete(t)))),t(n),this.no.reset()}catch{}finally{this.lo--}}}class on{constructor(t){self.caches?this.Ao(t):this.vo()}save(t){this._o.save(t)}recover(t){this._o.recover(t)}Ao(t){this._o=new rn(t,on.Ro,(t=>{this.vo(t)}))}vo(t){this._o=new nn(on.Ro),t&&csArray.prototype.forEach.call(t,(t=>{this._o.save(t)}))}}on.Ro=16777216,function(t){t.PORTRAIT="Portrait",t.LANDSCAPE="Landscape"}(ji||(ji={})),function(t){t.PORTRAIT_PRIMARY="portrait-primary",t.PORTRAIT_SECONDARY="portrait-secondary",t.LANDSCAPE_PRIMARY="landscape-primary",t.LANDSCAPE_SECONDARY="landscape-secondary"}(Xi||(Xi={})),function(t){t[t.PORTRAIT=0]="PORTRAIT",t[t.PORTRAIT_REVERSE=180]="PORTRAIT_REVERSE",t[t.LANDSCAPE=-90]="LANDSCAPE",t[t.LANDSCAPE_REVERSE=90]="LANDSCAPE_REVERSE"}(Ki||(Ki={})),function(t){function e(){return"orientation"in screen}function s(){return"orientation"in window}t.isScreenOrientationApiSupported=e,t.isDeprecatedScreenOrientationApiSupported=s;const i=e()?function(){switch(screen.orientation.type){case Xi.PORTRAIT_PRIMARY:case Xi.PORTRAIT_SECONDARY:return ji.PORTRAIT;case Xi.LANDSCAPE_PRIMARY:case Xi.LANDSCAPE_SECONDARY:return ji.LANDSCAPE;default:return ji.PORTRAIT}}:s()?function(){switch(window.orientation){case Ki.PORTRAIT:case Ki.PORTRAIT_REVERSE:return ji.PORTRAIT;case Ki.LANDSCAPE:case Ki.LANDSCAPE_REVERSE:return ji.LANDSCAPE;default:return ji.PORTRAIT}}:function(){return ji.LANDSCAPE};t.getCurrentOrientation=function(){return i()}}(Qi||(Qi={}));class an{constructor(){this.So=null,this.To=null,this.Ms=!1}start(){this.Ms||(this.Ms=!0,this.onScreenPotentiallyChanged())}stop(){this.Ms&&(this.Ms=!1,this.So=null,this.To=null)}setOnScreenChangedCallback(t){this.Io=t}onScreenPotentiallyChanged(){var t;if(!this.Ms)return;const e=Qi.getCurrentOrientation(),{screenWidth:s,screenHeight:i}=this.Po(e);if(s!==this.So||i!==this.To){this.So=s,this.To=i;const e={type:oe.SCREEN_RESIZE,args:[s,i],date:ht()};null===(t=this.Io)||void 0===t||t.call(this,e)}}Po(t){let e,s;const i=ws.screenWidth(),n=ws.screenHeight();return t===ji.PORTRAIT?(e=i,s=n):(e=Math.max(i,n),s=Math.min(i,n)),{screenWidth:e,screenHeight:s}}}class hn{constructor(t,e){this.ne=t,this.us=e,this.bo="cssrm://",this.Vo=0}beforeSerializeAttributes(t,e){if(this.us.isSensitive(t))return e;if(m(t)||u(t)&&d(csNodeparentNode.apply(t))){let s=e;const i=t.getAttribute("src");if(null!==i&&i.length>0&&(gi(i)||this.ne.isOnlineAssetsActivated()))return this.Vo++,this.Co(t.src,this.Vo),this.Oo(e,this.Vo);if(null!==t.getAttribute("srcset")&&this.ne.isOnlineAssetsActivated()){const i=fi(t.srcset),n=this.Vo+1;for(const t of i)this.Vo++,this.Co(kt(t),this.Vo);s=this.ko(e,n,i)}return s}return g(t)&&""!==t.getAttribute("href")&&this.ne.isOnlineAssetsActivated()?(this.Vo++,this.$o(t.href,this.Vo),this.Lo(e,this.Vo)):null!==t.getAttribute("style")?this.xo(e):e}serializeTextNode(t,e,s){t.parentElement&&f(t.parentElement)&&(e.data=this.Mo(e.data))}serializeTextMutation(t,e){return csNodeparentNode.apply(t)&&f(csNodeparentNode.apply(t))?this.Mo(e):e}serializeAttributeMutationValue(t,e,s){if(this.us.isSensitive(t))return e;if(m(t)||u(t)&&d(csNodeparentNode.apply(t))){if("src"===s&&(gi(e)||this.ne.isOnlineAssetsActivated()))return this.Vo++,this.Co(e,this.Vo),this.bo+this.Vo;if("srcset"===s&&this.ne.isOnlineAssetsActivated()){const t=fi(e),s=this.Vo+1;for(const e of t)this.Vo++,this.Co(kt(e),this.Vo);return this.Do(s,e,t).value}}return g(t)&&"href"===s&&this.ne.isOnlineAssetsActivated()?(this.Vo++,this.$o(e,this.Vo),this.bo+this.Vo):"style"===s?this.Mo(e):e}Mo(t){const e=csArray.from(new Set(pi(t)));if(this.Uo(e)||this.ne.isOnlineAssetsActivated()&&this.zo(e)){let i=t;for(const t of e)(this.ne.isOnlineAssetsActivated()||gi(t))&&(this.Vo++,i=csString.prototype.replace.call(i,t,this.bo+this.Vo)),gi(t)?this.Co(t,this.Vo):this.ne.isOnlineAssetsActivated()&&((s=t)&&ut(s,".css")?this.$o(t,this.Vo):this.Co(t,this.Vo));return i}var s;return t}Uo(t){return csArray.prototype.some.call(t,(t=>gi(t)))}zo(t){return csArray.prototype.some.call(t,(t=>!gi(t)))}xo(t){return csArray.prototype.map.call(t,(t=>{if("style"!==t.name)return t;const e=document.createAttribute(t.name);return e.value=this.Mo(t.value),e}))}Oo(t,e){return csArray.prototype.map.call(t,(t=>{if("src"!==t.name)return t;const s=document.createAttribute(t.name);return s.value=this.bo+e,s}))}ko(t,e,s){return csArray.prototype.map.call(t,(t=>"srcset"!==t.name?t:this.Do(e,t.value,s)))}Do(t,e,s){let i=t;const n=document.createAttribute("srcset");n.value=e;for(const t of s)n.value=csString.prototype.replace.call(n.value,t,this.bo+i),i++;return n}Lo(t,e){const s=[];for(const i of t){const t=document.createAttribute(i.name);if(csArray.prototype.push.call(s,t),"href"===i.name){const n=document.createAttribute("data-cs-original-href");n.value=i.value,csArray.prototype.push.call(s,n),t.value=this.bo+e}else t.value=i.value}return s}Co(t,e){this.ne.processStaticResource({id:e,input:t})}$o(t,e){this.ne.processStaticCssLinkResource({id:e,input:t})}}!function(t){t[t.NOT_EXIST=2]="NOT_EXIST"}(Ji||(Ji={}));class cn extends Ze{constructor(t,e,s){super(),this.ne=t,this.Fo=e,this.Bo=s,this.Ho={},this.qo=new Set,this.ci=!1}onStart(){this.ne.start()}onStop(){this.ne.stop()}initState(){this.ne.isStaticResourceManagerSupported()&&(this.jo=this.Bo.getRequestParameters(),this.Go=`${this.Fo}/exist?${K.toQuery(this.jo)}`,this.Zo=`${this.Fo}/putTag?${K.toQuery(this.jo)}`,this.Wo=ni((async()=>{this.ci?this.Wo():(this.ci=!0,await this.Ko(),this.ci=!1)}),300),this.ne.sendStaticResource((t=>{this.qo.has(t.hash)||(this.qo.add(t.hash),this.Ho[t.hash]=t,this.Wo())})))}onIframeStaticResource(t){this.ne.isStaticResourceManagerSupported()&&!this.qo.has(t.hash)&&(this.qo.add(t.hash),this.Ho[t.hash]=t,this.Wo())}async Ko(){const t=this.Ho;this.Ho={};const e=await this.Yo(t);if(!e.length)return;const s=this.Qo(e);await Promise.all(csArray.prototype.map.call(s,(t=>window.fetch(this.Zo,{method:"POST",body:t}))))}async Jo(t){try{const e=Object.keys(t);if(!e.length)return[];const s={projectId:this.jo.pid,filter:Ji.NOT_EXIST,hashes:e,touch:!0},i=await window.fetch(this.Go,{method:"POST",body:csJSON.stringify(s)});return await i.json()}catch(t){return[]}}async Yo(t){const e=[];try{const s=await this.Jo(t);csArray.prototype.forEach.call(s,(s=>{const i=t[s];i?csArray.prototype.push.call(e,i):qt.warn("SRM: received unknown hash: "+s)}))}catch(t){qt.warn(`SRM Service,getUnknownHashes error: ${t.message} `)}return e}Qo(t){let e=0;const s=[new FormData];for(const i of t){const{blob:t,hash:n}=i,r=s.length-1;if(e+=t.size,e<8388608)s[r].append("",t,n);else{const i=new FormData;i.append("",t,n),e=t.size,csArray.prototype.push.call(s,i)}}return s}}class ln{constructor(){this.Xo=[]}setRegexRules(t){this.Xo=csArray.prototype.map.call(t,(t=>this.tc(t)))}evaluateUrl(t){return csArray.prototype.some.call(this.Xo,(e=>{var s,i;const n=this.sc(t,e);return(null==e?void 0:e.notOperator)?!(null===(s=e.regex)||void 0===s?void 0:s.test(n)):null===(i=e.regex)||void 0===i?void 0:i.test(n)}))}sc(t,e){const s=xt(t);return s?e.ignoreQueryParams&&e.ignoreURIFragments?`${s.origin}${s.pathname}`:e.ignoreQueryParams?`${s.origin}${s.pathname}${s.hash}`:e.ignoreURIFragments?`${s.origin}${s.pathname}${s.search}`:t:t}ic(t){return t.ignoreCaseSensitivity?"i":""}tc(t){switch(t.operator){case Yi.NOT_START:t.notOperator=!0;case Yi.START:t.regex=new RegExp(`^${t.value}`,this.ic(t));break;case Yi.NOT_END:t.notOperator=!0;case Yi.END:t.regex=new RegExp(`${t.value}$`,this.ic(t));break;case Yi.NOT_CONTAIN:t.notOperator=!0;case Yi.CONTAIN:t.regex=new RegExp(`${t.value}`,this.ic(t));break;case Yi.NOT_EXACT:t.notOperator=!0;case Yi.EXACT:t.regex=new RegExp(`^${t.value}$`,this.ic(t));break;default:qt.warn(`buildRegexWithRule, unknown type: ${t.operator}`)}return t}}const un=()=>void 0!==window.performance&&window.performance.now?window.performance.timing.navigationStart+Math.round(window.performance.now()):csDate.now();class dn{constructor(t,e=100){this.ec=t,this.nc=e,this.rc="original-resource-name",this.hc=!1,this.Ms=!1,this.oc=!1,this.cc="SHA-256",this.ac={},this.lc=null}init(){"Promise"in window&&"function"==typeof window.Promise&&this.ec.isSupported()&&(this.hc=!0)}enableOnlineAssets(){this.oc=!0}isOnlineAssetsActivated(){return this.oc}isSupported(){return this.hc}async processStaticResource(t){var e;try{if(!this.hc)return;let s;if(gi(t.input)){const e=Ti(t.input);if(!e)return;s=e}else{const e=await window.fetch(t.input);s=await e.blob()}const i=await s.arrayBuffer(),n=_i(await crypto.subtle.digest(this.cc,i)),r=gi(t.input)?void 0:t.input;this.fc(t.id,n,r),null===(e=this.wc)||void 0===e||e.call(this,{hash:n,blob:s})}catch{}}async processStaticCssLinkResource(t){try{if(!this.hc)return;const e=await this.mc(t.input);this.fc(t.id,e.get(kt(t.input)).hash,t.input),this.Ec(e)}catch{}}isStaticResourceManagerSupported(){return this.hc}onEvent(t){this.zs=t}sendStaticResource(t){this.wc=t}flushEvents(){var t;if(!Object.keys(this.ac).length)return;this.lc&&clearTimeout(this.lc);const e={type:oe.RESOURCE_HASHES,date:un(),args:[this.ac]};this.lc=null,this.ac={},null===(t=this.zs)||void 0===t||t.call(this,e)}start(){this.Ms||(this.Ms=!0)}stop(){this.Ms&&(this.Ms=!1,this.oc=!1,this.flushEvents())}fc(t,e,s){let i=e;s&&(i+=`?${this.rc}=${s}`),this.ac[t]=i,this.lc&&clearTimeout(this.lc),this.lc=window.setTimeout((()=>this.flushEvents()),this.nc)}async mc(t){const e=new Map,s=[{resourceRawPath:t,resourceAbsolutePath:kt(t)}];for(;s.length>0;){const t=csArray.prototype.pop.call(s);if(this.isOnlineAssetsActivated()||null===t.resourceAbsolutePath||gi(t.resourceAbsolutePath)){if(void 0===e.get(t.resourceAbsolutePath))try{if(null===t.resourceRawPath||csString.prototype.indexOf.call(t.resourceRawPath,".css")>0){if(!t.data){const e=await fetch(t.resourceAbsolutePath);t.data=await e.text()}t.nestedResources||(t.nestedResources=csArray.from(new Set(pi(t.data))));let r=!1,o=!1;for(const a of t.nestedResources){const h=gi(a)?a:t.resourceAbsolutePath?(i=a,n=t.resourceAbsolutePath,new csURL(i,n).href):kt(a),c=e.get(h);if(void 0!==c){if(null!==c){const e=this.yc(c,a);t.data=csString.prototype.replaceAll.call(t.data,a,e)}continue}const l=void 0!==csArray.prototype.find.call(s,(t=>t.resourceAbsolutePath===h));l||(r=!0,o||(csArray.prototype.push.call(s,t),o=!0),csArray.prototype.push.call(s,{resourceRawPath:a,resourceAbsolutePath:h}))}if(!r){const s=await this.Ac(t.data);e.set(t.resourceAbsolutePath,{hash:s.hash,blob:s.blob})}}else{let s;if(gi(t.resourceAbsolutePath)){const i=Ti(t.resourceAbsolutePath);if(!i){e.set(t.resourceAbsolutePath,null);continue}s=i}else{const e=await fetch(t.resourceAbsolutePath);s=await e.blob()}const i=await this.gc(s);e.set(t.resourceAbsolutePath,{hash:i,blob:s})}}catch{e.set(t.resourceAbsolutePath,null)}}else e.set(t.resourceAbsolutePath,null)}var i,n;return e}yc(t,e){let s=`cs://resources/${t.hash}`;return gi(e)||(s+=`?${this.rc}=${e}`),s}async Ac(t){const e=new Blob([t],{type:"text/css"}),s=await e.arrayBuffer();return{blob:e,hash:_i(await crypto.subtle.digest(this.cc,s))}}async gc(t){const e=await t.arrayBuffer();return _i(await crypto.subtle.digest(this.cc,e))}Ec(t){t.forEach((t=>{var e;t&&(null===(e=this.wc)||void 0===e||e.call(this,{hash:t.hash,blob:t.blob}))}))}}class pn{constructor(){this.vc=[],this._c=1}identifyNodes(t,e){const s=[document.createTreeWalker(t,NodeFilter.SHOW_ALL,null,!1)];let i=!1;for(;s.length>0;){const t=csArray.prototype.pop.call(s);let n=t.root;for(;null!==n;)if(i&&e&&e.get(n)>0){let e=t.nextSibling();for(;null===e&&null!==t.parentNode();)e=t.nextSibling();n=e}else n.__contentsquare_identifier=this._c,this._c+=1,c(n)&&csElementshadowRoot.apply(n)?csArray.prototype.push.call(s,document.createTreeWalker(csElementshadowRoot.apply(n),NodeFilter.SHOW_ALL,null,!1)):R(n)&&this.Rc(n),n=t.nextNode(),i=!0}}getId(t){return t.__contentsquare_identifier}static getId(t){return t.__contentsquare_identifier}getIds(t){const e=new Set,s=document.createNodeIterator(t,NodeFilter.SHOW_ALL,null,!1);let i;for(;i=s.nextNode();){const t=i.__contentsquare_identifier;if(t&&e.add(t),c(i)&&csElementshadowRoot.apply(i)){const t=csElementshadowRoot.apply(i);this.getIds(t).forEach((t=>e.add(t)))}}return e}onDocumentIdentified(t){csArray.prototype.push.call(this.vc,t)}Rc(t){for(const e of this.vc)e(t)}}class gn{constructor(){this.Sc=new Map,this.Tc={},this.Ic=!1}start(){}stop(){this.flushEvents(),this.Sc.clear()}serializeTextNode(t,e){const s=this.setReferenceId(e.data);return e.data=`cstextref://${s}`,e}serializeCDATASectionNode(t,e){const s=this.setReferenceId(e.data);return e.data=`cstextref://${s}`,e}onEvent(t){this.zs=t}flushEvents(){const t=this.Pc();t&&this.zs(t)}getPendingEvents(){const t=this.Pc();return t?[t]:[]}getReferenceId(t){return this.Sc.get(t)}setReferenceId(t){return this.bc(t)}Pc(){if(0===Object.keys(this.Tc).length)return;const t={type:oe.TEXT_REF,date:ht(),args:[this.Tc]};return this.Tc={},t}bc(t){let e=this.Sc.get(t);return e||(e=this.Sc.size+1,this.Sc.set(t,e),this.Tc[e]=t,this.Ic||(this.Ic=!0,We((()=>{this.Ic=!1,this.flushEvents()}))),e)}}Nt.Element;const mn=window.csElementmatches||window.csElementmatchesSelector||window.csElementmozMatchesSelector||window.csElementmsMatchesSelector||window.csElementoMatchesSelector||window.csElementwebkitMatchesSelector;class fn{constructor(t,e,s){var i;this.cs=t,this.us=e,this.se=s,this.zs=B,this.Ms=!1,this.Vc=new Set,this.Cc=Ss(),this.Nc=t=>this.inputHandler(t),this.Oc=(t,e,s,i)=>{if(s&&this.Ms&&t.isConnected){const e=this.cs.getId(t);e&&this.kc(t)&&We((()=>{this.$c(t,e)}))}return i.apply(t,[e])},this.Lc(),this.xc(),this.Mc(),null===(i=this.se)||void 0===i||i.onInputNodeToEncrypt((t=>{this.zs(t)}))}start(){this.Ms||(this.Ms=!0,ge({type:"keyup",boundElement:document,listener:this.Nc}),ge({type:"change",boundElement:document,listener:this.Nc}))}stop(){this.Ms&&(this.Ms=!1,me({type:"keyup",boundElement:document,listener:this.Nc}),me({type:"change",boundElement:document,listener:this.Nc}),this.Vc.forEach((t=>{me({type:"change",boundElement:t,listener:this.Nc})})),this.Vc.clear())}serializeElementNode(t,e){if(this.Ms){if(!this.kc(t))return;We((()=>{this.$c(t,e.csId)}))}}onEvent(t){this.zs=t}$c(t,e){var s,i,n;if(this.Cc.has(t))return;if(this.Cc.add(t),this.Dc(t)){const s={type:oe.INPUT_SELECT,args:[e,t.selectedIndex],date:ht()};return void this.zs(s)}if(this.Uc(t)){const s={type:oe.INPUT_CHECKABLE,args:[e,t.checked],date:ht()};return void this.zs(s)}const r=this.zc(t),o=this.Fc(t);if(r||o){const r=null!==(s=t.value)&&void 0!==s?s:"";if(null===(i=this.se)||void 0===i?void 0:i.shouldEncrypt(t))return void(null===(n=this.se)||void 0===n||n.registerInputNodeToEncrypt({targetId:e,targetValue:r,date:ht()}));const a=o?"0":"•",h={type:oe.INPUT_TEXT,args:[e,csString.prototype.replace.call(r,/\S/g,a)],date:ht()};this.zs(h)}}inputHandler(t){const e=Ne(t),s=this.cs.getId(e);s&&this.kc(e)&&e.isConnected&&We((()=>{this.$c(e,s)}))}afterSerializeShadowRoot(t){this.Vc.has(t)||(ge({type:"change",listener:this.Nc,boundElement:t}),this.Vc.add(t))}Lc(){const t=Object.getOwnPropertyDescriptor(HTMLInputElement.prototype,"value");if(!(null==t?void 0:t.configurable))return;const e=t.set,s=this;t.set=function(t){const i=t!==this.value;return s.Oc(this,t,i,e)},Object.defineProperty(HTMLInputElement.prototype,"value",t)}xc(){const t=Object.getOwnPropertyDescriptor(HTMLInputElement.prototype,"checked");if(!(null==t?void 0:t.configurable))return;const e=t.set,s=this;t.set=function(t){const i=t!==this.checked;return s.Oc(this,t,i,e)},Object.defineProperty(HTMLInputElement.prototype,"checked",t)}Mc(){const t=Object.getOwnPropertyDescriptor(HTMLSelectElement.prototype,"selectedIndex");if(!(null==t?void 0:t.configurable))return;const e=t.set,s=this;t.set=function(t){const i=t!==this.selectedIndex;return s.Oc(this,t,i,e)},Object.defineProperty(HTMLSelectElement.prototype,"selectedIndex",t)}Dc(t){return mn.call(t,fn.Bc)}zc(t){return mn.call(t,fn.Hc)}Fc(t){return mn.call(t,fn.qc)}Uc(t){return mn.call(t,fn.jc)}kc(t){return!this.us.isSensitive(t)&&!this.us.isSensitiveChild(t)&&(y(t)||w(t)||E(t))}}fn.Hc=csArray.prototype.join.call(["textarea","input:not([type])",'input[type="text"]','input[type="email"]','input[type="search"]','input[type="tel"]','input[type="url"]','input[type="password"]'],","),fn.qc='input[type="number"]',fn.jc=csArray.prototype.join.call(['input[type="checkbox"]','input[type="radio"]'],","),fn.Bc="select",Zt([Oe()],fn.prototype,"inputHandler",null);const yn="v2/recording",En=["setCapturedElementsSelector"],Sn=["setPIISelectors"],vn=["isRecording"],wn=["replay:resourceManager:enableForOnlineResource:nextPageviewOnly","cssrm:onlineAssets:activateForNextPageview"],Rn=["replay:resourceManager:getStatus","cssrm:getStatus"];class An{constructor(t,e,s,i,n,r,o,a,h,c,l,u,d,p,g,m,f,y,E,S,v,w,R){this.Gc=t,this.W=e,this.$=s,this.Zc=i,this.Hh=n,this.jo=r,this.Wc=o,this.L=a,this.Yi=h,this.X=c,this.us=l,this.Qi=u,this.Ji=d,this.Xi=p,this.Or=g,this.te=m,this.Ls=f,this.Kc=y,this.Yc=E,this.Qc=S,this.hr=v,this.Jc=w,this.Xc=R,this.ne=null,this.ta=null}init(){const t=[],e=new on("csPersisted");this.sa(e);const s=new Ge;this.Bi=new qe;const i=new pn,n=new Fs(this.us);this.ia=new si(this.L,this.$),this.ia.init();const r=new Ei;csArray.prototype.push.call(t,r);const o=new wi(this.hr,i),a=[new Fi,n,this.ia,r];let h=null;if(this.$.useStaticResourceManager){const e=new bi(window.crypto);e.init(),this.ne=new dn(e),this.ne.init(),csArray.prototype.push.call(t,this.ne),this.ne.isStaticResourceManagerSupported()&&(h=new hn(this.ne,this.us),csArray.prototype.push.call(a,h),this.ta=new cn(this.ne,this.$.getStaticResourceManagerUri(),this.jo))}const c=new sn,l=new qi(i,c);l.init(),csArray.prototype.push.call(t,l),l.isAdoptedStyleSheetsSupported()&&csArray.prototype.push.call(a,l);const u=new gn;csArray.prototype.push.call(a,u),csArray.prototype.push.call(t,u);const d=new fn(i,this.us,this.se);let p;csArray.prototype.push.call(a,d),p=this.ea()?new Bi(a,i):new Hi(a);const g=new ii(s,this.jo,{getRequestParameters:()=>({let:this.recordingService.getRecordingLastEventTimestamp()})},{getRequestParameters:()=>({rst:this.recordingService.getRecordingStartTimestamp()})},{getRequestParameters:()=>({rt:csArray.prototype.join.call(this.W.getRecordingStates(),",")})}),m=new Ri(`${this.$.getRecordingUri()}/${yn}`),f=new ln;this.$n=new tn(this.Hh,this.$,this.X,f),this.$n.init(),this.Os=new Vs(p,i,this.ia,this.se),this.Os.setAnonymization(this.$n.shouldUseAnonymization()),this.Zi=new Le(i,this.us),this.Zi.init();const y=new He(this.Os,o,r,this.Ls,i,this.us);this.ee=new Us(e,m,this.ie),csArray.prototype.push.call(t,new Bs(i,this.us,r,c)),csArray.prototype.push.call(t,new Si(window)),csArray.prototype.push.call(t,new ai(window.location,this.L,new an)),this.recordingService=new xs(this.$,this.Bi,g,s,c,y,this.Zi,d,new Ci(this.Or,i,this.us),this.Yi,this.W,this.Qi,this.Ji,this.Xi,this.te,this.se,this.ie,this.ee,this.ne,t,m),this.na=new hi(this.Zi,y,new oi(this.$),this.recordingService,this.Os,this.$n,this.Ls),this.Kc.addListener(this.recordingService),this.Yc.addListener(this.recordingService),this.Yc.addListener(this.na),this.ta&&this.Yc.addListener(this.ta),o.init(),this.na.init(),this.recordingService.init(),this.Wc.register(vn,(()=>this.W.isReplayRecorded()&&!this.Qc.isUrlExcludedForSessionReplay())),this.Wc.register(En,(t=>{this.ia.setWhitelistedElementsSelector(t),this.Ls.emitRecordingStatusChange()})),this.Wc.register(Sn,(t=>{this.us.setPIISelectors(t),this.Ls.emitRecordingStatusChange()})),this.Wc.register(wn,(()=>{this.recordingService.activateOnlineAssetsOnNextPageview(),this.Ls.emitRecordingStatusChange()})),this.Wc.register(Rn,(()=>this.recordingService.getStaticResourceManagerStatus())),this.Gc.enableRecordingStatus(this.recordingService,this.us,this.$n,this.ia,this.W,this.se)}onAfterNaturalPageView(){var t;null===(t=this.ta)||void 0===t||t.initState()}onStartTracking(){this.ee.recover(),this.Os.setAnonymization(this.$n.shouldUseAnonymization()),this.W.isReplayRecorded()&&!this.Qc.isUrlExcludedForSessionReplay()&&(this.W.isTemporarilyRecorded()&&this.recordingService.blockSendingEventsFromQuotaService(),this.ra())}onArtificialPageViewEnd(){this.recordingService.clearStates(),!this.W.isReplayRecorded()||this.Qc.isUrlExcludedForSessionReplay()||this.W.isTemporarilyRecorded()||this.ee.sendLastMessageBeacon()}onAfterArtificialPageView(){this.Os.setAnonymization(this.$n.shouldUseAnonymization()),this.W.isReplayRecorded()&&!this.Qc.isUrlExcludedForSessionReplay()?(this.W.isTemporarilyRecorded()&&this.recordingService.blockSendingEventsFromQuotaService(),this.ha()):this.oa()}onBeforeSessionRenewal(){this.recordingService.clearStates(),this.oa()}onOptout(){this.oa()}onReplayUnanonymizationConsentGranted(){this.Os.setAnonymization(this.$n.shouldUseAnonymization()),this.recordingService.triggerUnanonymizationConsentGranted(),this.Ls.emitRecordingStatusChange()}onReplayUnanonymizationConsentWithdrawn(){this.Os.setAnonymization(this.$n.shouldUseAnonymization()),this.recordingService.triggerUnanonymizationConsentWithdrawn(),this.Ls.emitRecordingStatusChange()}onRecordingStateChange(t,e){t===je.NOT_RECORDED&&e===Xe.ETR_OFF?(this.recordingService.clearEvents(),this.oa()):(this.ie.setQueryParams({rt:csArray.prototype.join.call(this.W.getRecordingStates(),",")}),this.recordingService.allowSendingEventsFromQuotaService(),this.Os.isDOMSerializationInProgress()||this.recordingService.pushEvents())}onInitialDomStart(){this.recordingService.blockSendingEventsFromSerialization(),this.ee.blockSendingLastMessage()}onInitialDomDone(t){this.recordingService.allowSendingEventsFromSerialization(),this.recordingService.addInitialDom(t),this.ee.allowSendingLastMessage(),this.Zi.start(),this.recordingService.pushEvents()}onAfterReplayRecordingConsentGranted(){this.W.isReplayRecorded()&&!this.Qc.isUrlExcludedForSessionReplay()&&(this.W.isTemporarilyRecorded()&&this.recordingService.blockSendingEventsFromQuotaService(),this.ra(),this.recordingService.triggerRecordingForSessionGranted())}onAfterReplayRecordingConsentWithdrawn(){this.recordingService.isRecording()&&(this.recordingService.triggerRecordingForSessionWithdrawn(),this.recordingService.clearStates(),this.oa())}ra(){var t;this.recordingService.updateStaticResourceManagerOnlineAssets(),this.na.start(),this.recordingService.start(),null===(t=this.ta)||void 0===t||t.start(),this.ee.start(),this.Ls.emitRecordingStatusChange()}oa(){var t;this.na.stop(),this.recordingService.stop(),null===(t=this.ta)||void 0===t||t.stop(),this.ee.stop(),this.Ls.emitRecordingStatusChange()}ha(){this.oa(),this.ra()}sa(t){this.ie=this.Jc.create(`${this.$.getRecordingUri()}/${yn}`,!0,"byteArray",t)}ea(){return en.isAsyncSerializationSupported()&&this.$.asyncSerializerEnabled}ca(){return!!this.$.encryptionPublicKey&&this.$.encryptionPublicKeyId>0&&this.aa.isSupported()&&this.ua.isSupported()}}var Tn,_n;Zt([Ce("Recording.onStartTracking")],An.prototype,"onStartTracking",null),Zt([Ce("onInitialDomDone")],An.prototype,"onInitialDomDone",null),function(t){t[t.NOT_NEEDED=1]="NOT_NEEDED",t[t.NOT_EXPRESSED=2]="NOT_EXPRESSED",t[t.WITHDRAWN=3]="WITHDRAWN",t[t.GRANTED=4]="GRANTED"}(Tn||(Tn={})),function(t){t.isReplayConsentNeeded=function(t){return t.replayConsentRequiredForSession},t.isRecordingBlockedByConsent=function(t){return t.recordingState===je.BLOCKED_BY_CONSENT_NOT_EXPRESSED||t.recordingState===je.BLOCKED_BY_CONSENT_WITHDRAWN},t.isRecordingWithDrawn=function(t){return t.recordingState===je.BLOCKED_BY_CONSENT_WITHDRAWN}}(_n||(_n={}));class bn{constructor(t,e,s,i){this.Z=t,this.W=e,this.$=s,this.da=i,this.fa=!1}isNaturalPageViewSent(){return this.fa}setNaturalPageViewSent(t){this.fa=t}getTrackingContext(){const t=this.W.getSession();if(!t)return null;const e=this.getSessionKey();if(!e)return null;const s=this.wa(t),i=this.pa(),n=this.ma(),r=this.Ea();return{projectId:i,sessionKey:e,pageNumber:s,pageViewType:n,isRecording:this.ya(),uxaDomain:r,recordingConsentState:this.Aa(t)}}getSessionKey(){const t=this.Z.getVisitor();return t?`${t.id}.${t.visitsCount}`:null}Aa(t){return _n.isReplayConsentNeeded(this.$)?t.recordingState===je.BLOCKED_BY_CONSENT_NOT_EXPRESSED?Tn.NOT_EXPRESSED:t.recordingState===je.BLOCKED_BY_CONSENT_WITHDRAWN?Tn.WITHDRAWN:Tn.GRANTED:Tn.NOT_NEEDED}wa(t){return t.pageNumber}pa(){return this.$.projectId}ma(){return this.da.getPageViewType()}Ea(){return this.$.uxaDomain}ya(){return this.W.isReplayRecorded()}}class Cn{constructor(t){this.ga=t,this.va=[]}handleCommand(t){if(St(t)&&(this._a(t),this.ga.isNaturalPageViewSent())){const e=this.ga.getTrackingContext();null!==e&&this.Ra(t,e)}}_a(t){csArray.prototype.push.call(this.va,t)}executeRegisteredCallbacks(){const t=this.ga.getTrackingContext();null!==t&&csArray.prototype.map.call(this.va,(e=>this.Ra(e,t)))}Ra(t,e){setTimeout((()=>{t(e)}))}}class Nn{constructor(t){this.ga=t,this.Sa=[]}handleCommand(t){return this.ga.isNaturalPageViewSent()?this.Ta(t):void this.Ia(t)}Ta(t){const e=this.ga.getSessionKey();return this.Kh(t)&&null!==e&&this.Ra(t.callback,e),e}Ia(t){this.Kh(t)&&csArray.prototype.push.call(this.Sa,t.callback)}flushPendingCallbacks(){const t=this.ga.getSessionKey();null!==t&&csArray.prototype.forEach.call(this.Sa,(e=>{this.Ra(e,t)})),this.Sa=[]}Kh(t){return t&&"function"==typeof t.callback}Ra(t,e){setTimeout((()=>{t(e)}))}}class On{constructor(t,e){this.Pa=t,this.ga=e}onTrackingContextRequestCallback(t){const e=this.ga.getTrackingContext();null!==e&&this.Pa.sendToChildren(Vt.TrackingContextResultMessage,{...t,trackingContext:e})}onIframeIntegrationCallback(t){if(!this.ga.isNaturalPageViewSent())return;const e=this.ga.getTrackingContext();null!==e&&(t.trackingContext=e,this.Pa.sendToChildren(Vt.IntegrationCallback,t))}sendAfterPageViewCallbackToChildren(){const t=this.ga.getTrackingContext();if(null===t)return;const e={trackingContext:t,initiator:$t.AfterPageView};this.Pa.sendToChildren(Vt.IntegrationCallback,e)}}class In{constructor(t){this.ga=t}handleCommand(t,e){ft(t)&&St(e)&&this.Ra(t,e)}Ra(t,e){setTimeout((()=>{const s=this.ga.getTrackingContext();if(s){const i=function(t,e){const{isRecording:s,pageNumber:i,projectId:n,uxaDomain:r}=t,o=/^(.+)\.(\d+)$/.exec(t.sessionKey);let a;if(s&&o){const[,t,s]=o;a=`${r}/quick-playback/index.html?pid=${n}&uu=${t}&sn=${s}&pvid=${i}&recordingType=cs`,e.withTimestamp&&(a+="&t="+(ht()-e.recordingStartTimestamp))}return{replayLink:a,isRecording:s}}(s,t);e(i)}}))}}class Pn{constructor(){this.va=new Set}handleCommand(t,e){return St(t)?this.va.has(t)?null:(this.va.add(t),e&&(this.fo=e,this.ba(t,e)),()=>this.va.delete(t)):null}executeCallbacks(t){this.Va(t)&&(this.fo=t,this.va.forEach((e=>this.ba(e,t))))}ba(t,e){setTimeout((()=>{try{t(e)}catch(t){}}))}Va(t){const{isRecording:e,recordingStartTimestamp:s,etrState:i}=t;return this.fo&&(this.fo.isRecording!==e||this.fo.recordingStartTimestamp!==s||this.fo.etrState!==i)}}const kn=["afterPageView"],Ln=["getSessionKey"],Dn=["onRecordingStateChange"],Mn=["replay:link:generate"];class xn{constructor(t,e,s,i,n,r,o,a){this.Z=t,this.W=e,this.Wc=s,this.Ca=i,this.Pa=n,this.$=r,this.da=o,this.Gc=a}init(){this.ga=new bn(this.Z,this.W,this.$,this.da),this.Na=new Cn(this.ga),this.Oa=new Nn(this.ga),this.ka=new Pn,this.$a=new In(this.ga),this.La=new On(this.Pa,this.ga),this.Ca.addListener(this.La),this.Wc.register(Ln,(t=>this.Oa.handleCommand(t))),this.Wc.register(kn,(t=>this.Na.handleCommand(t))),this.Wc.register(Dn,(t=>{this.ka.handleCommand(t,this.Gc.getRecordingStatus())})),this.Wc.register(Mn,((t,e)=>{this.kn&&this.$a.handleCommand({...t,recordingStartTimestamp:this.Gc.getRecordingStatus().recordingStartTimestamp},e)}))}onAfterNaturalPageView(){this.ga.setNaturalPageViewSent(!0),this.Oa.flushPendingCallbacks(),this.Na.executeRegisteredCallbacks(),this.La.sendAfterPageViewCallbackToChildren()}onAfterArtificialPageView(){this.Na.executeRegisteredCallbacks(),this.La.sendAfterPageViewCallbackToChildren()}onRecordingStateChange(){this.ka.executeCallbacks(this.Gc.getRecordingStatus())}onRecordingStatusChange(){this.ka.executeCallbacks(this.Gc.getRecordingStatus())}setRecordingService(t){this.kn=t}}Zt([ri()],xn.prototype,"onRecordingStateChange",null),Zt([ri()],xn.prototype,"onRecordingStatusChange",null);class Un{constructor(t,e){this.key=csString.prototype.slice.call(t,0,512),this.value=mt(e)?csString.prototype.slice.call(e,0,255):e}static isValid(t,e){return mt(t)&&(mt(e)||gt(e))}}class $n extends Ze{constructor(t,e){super(),this.xa=t,this.L=e,this.Ma=[]}onStart(){csArray.prototype.forEach.call(this.Ma,(t=>this.trackDynamicVariable(t.key,t.value))),this.Ma=[]}onStop(){}trackDynamicVariable(t,e){this.isStarted?Un.isValid(t,e)&&this.xa.add(new Un(this.L.anonymizePII(t),this.L.anonymizePII(e))):csArray.prototype.push.call(this.Ma,{key:t,value:e})}}class zn{constructor(t){this.Zc=t,this.xa=[]}add(t){csArray.prototype.push.call(this.xa,t),this.setBatchReadyCall()}clear(){this.xa=[]}onBatchReady(t){this.Da=t}getRequestParameters(){const t={};for(const e of this.xa)t[e.key]=e.value;return{dv:this.Zc.compressSync(csJSON.stringify(t),"base64"),ct:this.Zc.algorithm}}setBatchReadyCall(){this.Da()}}Zt([ri(),Yt("dynamicVariablesBatchReady")],zn.prototype,"setBatchReadyCall",null);const Vn=["trackDynamicVariable"];class Wn{constructor(t,e,s,i,n,r){this.Wc=t,this.W=e,this.$=s,this.jo=i,this.Zc=n,this.L=r,this.N=new J(this.$.getTrackerUri(),"dvar"),this.xa=new zn(this.Zc),this.Ua=new $n(this.xa,this.L)}init(){this.N.setRequestParametersProviders(this.jo,this.xa),this.W.setDynamicVariablesService(this.Ua),this.xa.onBatchReady((()=>this.N.send())),this.N.after((()=>this.xa.clear())),this.Wc.register(Vn,(({key:t,value:e}={})=>{this.Ua.trackDynamicVariable(t,e)}))}onStartTracking(){this.Ua.start()}}class Bn{constructor(t,e){this.id=t,this.revenue=e}static from(t){const e=new Bn(t.id,parseFloat(t.revenue));return isNaN(parseFloat(t.tax))||(e.tax=parseFloat(t.tax)),isNaN(parseFloat(t.shipping))||(e.shipping=parseFloat(t.shipping)),mt(t.currency)&&t.currency.length<=10&&(e.currency=t.currency),e}hasValidRevenue(){return!isNaN(this.revenue)&&this.revenue>=0}static isValid(t){return Et(t)&&pt(t.revenue)&&mt(t.currency)&&t.currency.length<=10&&(!Et(t.id)||mt(t.id))}}class Hn{constructor(t,e,s,i){this.id=t,this.name=e,this.price=s,this.quantity=i}static from(t){if(!Hn.za(t))return null;const e=new Hn(t.id,t.name,parseFloat(t.price),parseInt(t.quantity,10));return yt(t.sku)&&(e.sku=t.sku),yt(t.category)&&(e.category=t.category),yt(t.merchant)&&t.merchant.length>0&&(e.merchant=t.merchant.slice(0,100)),e}static za(t){return Et(t)&&mt(t.id)&&mt(t.name)&&pt(parseFloat(t.price))&&gt(parseInt(t.quantity,10))&&(!yt(t.sku)||mt(t.sku))&&(!yt(t.category)||mt(t.category))&&(!yt(t.merchant)||mt(t.merchant))}}class Fn{constructor(t,e,s){this.L=t,this.Fa=e,this.Yi=s,this.clear()}addTransaction(t){const e=this.L.anonymizeFields(t,["id"]);this.Ba=Bn.from(e)}getTransaction(){return this.Ba}sendTransaction(){null!==this.Fa&&null!==this.Yi&&this.Yi.isSessionValid()&&(this.Ba.hasValidRevenue()?this.Fa.send():qt.warn("Transaction Service: unable to send transaction with invalid parameters"))}addItem(t){if(St(t))return;const e=this.L.anonymizeFields(t,["id","name","sku","category"]),s=Hn.from(e);null!==s&&csArray.prototype.push.call(this.Ha,s)}getItems(){return this.Ha}clear(){this.Ba=Bn.from({revenue:NaN}),this.Ha=[]}getRequestParameters(){const t={id:this.Ba.id?`${this.Ba.id}`:"",revenue:`${this.Ba.revenue}`};return yt(this.Ba.tax)&&(t.tax=`${this.Ba.tax}`),yt(this.Ba.shipping)&&(t.shipping=`${this.Ba.shipping}`),yt(this.Ba.currency)&&(t.cu=`${this.Ba.currency}`),t.items=window.csJSON.stringify(this.Ha),t}}class qn{constructor(t,e){this.qa=t,this.Yi=e,this.ja=null}addToCart(t){const e={};mt(t.sku)&&(e.sku=csString.prototype.slice.call(t.sku,0,100)),mt(t.merchant)&&(e.merchant=csString.prototype.slice.call(t.merchant,0,100)),(e.sku||e.merchant)&&(this.ja=e,this.sendCartItem())}getCartItem(){return this.ja}sendCartItem(){this.Yi.isSessionValid()&&this.qa.send()}clear(){this.ja=null}getRequestParameters(){if(!this.ja)return{};const t={};return mt(this.ja.sku)&&this.ja.sku.length>0&&(t.sku=this.ja.sku),mt(this.ja.merchant)&&this.ja.merchant.length>0&&(t.me=this.ja.merchant),t}}const Gn=["ecommerce:addToCart","ec:cart:add"],Yn=["ecommerce:addTransaction","ec:transaction:create"],Zn=["ecommerce:addItem","ec:transaction:items:add"],jn=["ecommerce:send","ec:transaction:send"];class Xn{constructor(t,e,s,i,n,r,o){this.$=t,this.Bo=e,this.Z=s,this.Wc=i,this.L=n,this.Yi=r,this.X=o}init(){const t=new J(this.$.getTrackerUri(),"transaction"),e=new J(this.$.getTrackerUri(),"addtocart"),s=new Fn(this.L,t,this.Yi),i=new qn(e,this.Yi),n=new ii(this.Bo,this.Z,this.X,s);t.setRequestParametersProviders(n),t.after((()=>{s.clear()}));const r=new ii(this.Bo,this.Z,this.X,i);e.setRequestParametersProviders(r),e.after((()=>{i.clear()})),this.Wc.register(Yn,(t=>{s.addTransaction(t)})),this.Wc.register(Zn,(t=>s.addItem(t))),this.Wc.register(jn,(()=>s.sendTransaction())),this.Wc.register(Gn,(t=>{i.addToCart(t)}))}}class Kn{constructor(t){this.ir=t.performance}getRequestParameters(){if(this.Ga())return{};const t=this.Za();return{str:t.startRender,di:t.domInteractive,dc:t.domComplete,fl:t.fullyLoaded}}Za(){const t=this.ir.timing;return{startRender:""+(t.domLoading-t.requestStart),domInteractive:""+(t.domInteractive-t.requestStart),domComplete:""+(t.domComplete-t.requestStart),fullyLoaded:""+(t.loadEventEnd-t.requestStart)}}Ga(){return!(this.ir&&this.ir.timing&&this.ir.timing.loadEventEnd>0)}}var Qn,Jn,tr;function er(t){return void 0!==t.tgt}!function(t){t[t.RESIZE=0]="RESIZE",t[t.SCROLL=1]="SCROLL",t[t.MOUSEMOVE=2]="MOUSEMOVE",t[t.MOUSEDOWN=3]="MOUSEDOWN",t[t.MOUSEUP=4]="MOUSEUP",t[t.CLICK=5]="CLICK",t[t.MOUSEOVER=6]="MOUSEOVER",t[t.MOUSEOUT=7]="MOUSEOUT",t[t.CHANGE=10]="CHANGE",t[t.FOCUSIN=11]="FOCUSIN",t[t.FOCUSOUT=12]="FOCUSOUT",t[t.TAP=14]="TAP",t[t.KEYDOWN=15]="KEYDOWN",t[t.KEYUP=16]="KEYUP",t[t.COMMAND=17]="COMMAND",t[t.SUBMIT=18]="SUBMIT",t[t.PERFORMANCE=19]="PERFORMANCE",t[t.DRAG=20]="DRAG",t[t.FLICK=21]="FLICK",t[t.KEYBOARD_NAVIGATION=22]="KEYBOARD_NAVIGATION",t[t.ZOOM=23]="ZOOM",t[t.VIEWPORT_SCALE=24]="VIEWPORT_SCALE",t[t.TEXT_HIGHLIGHT=25]="TEXT_HIGHLIGHT",t[t.DEAD_CLICK=30]="DEAD_CLICK",t[t.DEAD_ZOOM=31]="DEAD_ZOOM",t[t.PAGE_RELOAD=32]="PAGE_RELOAD",t[t.THRASHED_CURSOR=33]="THRASHED_CURSOR",t[t.BLANK_PAGE=34]="BLANK_PAGE"}(Qn||(Qn={})),function(t){t.SUCCESS="success",t.FAILURE="failure",t.ATTEMPT="attempt"}(Jn||(Jn={}));class sr{isEventTypeSupported(t){return-1!==csArray.prototype.indexOf.call(this.supportedEventTypes,t)}enhanceAnalysisEvent(t,e){return this.isEventTypeSupported(e.type)?this.baseEnhanceAnalysisEvent(t,e):e}}class ir extends sr{constructor(t){super(),this.Wa=t,this.supportedEventTypes=[Qn.MOUSEDOWN,Qn.MOUSEUP,Qn.CLICK,Qn.MOUSEOVER,Qn.TAP]}baseEnhanceAnalysisEvent(t,e){const{path:s,targetLink:i}=this.Wa.getEventTargetPathAndTargetLink(t);return e.tgt=s,e.tgtLk=i,e}}class nr{static build(t,e,s){return csArray.prototype.reduce.call(s,((e,s)=>s.enhanceAnalysisEvent(t,e)),e)}}class rr extends sr{constructor(t){super(),this.Wa=t,this.supportedEventTypes=[Qn.MOUSEDOWN,Qn.MOUSEUP,Qn.CLICK,Qn.MOUSEOVER,Qn.TAP,Qn.DRAG,Qn.FLICK]}baseEnhanceAnalysisEvent(t,e){return e.tgt||(e.tgt=this.Wa.getEventTargetPath(t)),e}}class or{constructor(t,e,s,i){this.$=t,this.Wa=e,this.Or=s,this.Ka=i,this.Ya=[],this.$.eMerchandisingEnabled&&csArray.prototype.push.call(this.Ya,new ir(this.Wa)),csArray.prototype.push.call(this.Ya,new rr(this.Wa))}processGesture(t,e){switch(t.type){case li.TAP:this.Qa(e);break;case li.FLICK:this.Ja(t,e);break;case li.DRAG:this.Xa(t,e)}}Qa(t){const e={type:Qn.TAP,ts:0,x:0,y:0,tgt:""},s=nr.build(t,e,this.Ya);s.tgt!==V.INVALID_ELEMENT&&this.zs(s)}Xa(t,e){var s,i;const n={type:Qn.DRAG,ts:0,fd:t.direction,tgt:""};(null===(s=this.Ka)||void 0===s?void 0:s.collectGestureDistance)&&(n.distance=t.distance),(null===(i=this.Ka)||void 0===i?void 0:i.collectGestureVelocity)&&(n.velocity=t.velocity);const r=nr.build(e,n,this.Ya);r.tgt!==V.INVALID_ELEMENT&&this.zs(r)}Ja(t,e){var s,i;const n={type:Qn.FLICK,ts:0,fd:t.direction,tgt:""};(null===(s=this.Ka)||void 0===s?void 0:s.collectGestureDistance)&&(n.distance=t.distance),(null===(i=this.Ka)||void 0===i?void 0:i.collectGestureVelocity)&&(n.velocity=t.velocity);const r=nr.build(e,n,this.Ya);r.tgt!==V.INVALID_ELEMENT&&this.zs(r)}onEvent(t){this.zs=t}start(){this.Or.subscribe(or.kr,((t,e)=>this.processGesture(t,e)))}stop(){this.Or.unsubscribe(or.kr)}}or.kr="AnalysisGestureTracker",Zt([Oe()],or.prototype,"processGesture",null),function(t){t.getRelativePosition=function(t){const e=Ne(t);if(!(e&&c(e)&&St(e.getBoundingClientRect)&&Et(t.pageX)&&Et(t.pageY)))return{xRel:-1,yRel:-1,valid:!1};const s=e.getBoundingClientRect();let i=t.pageX-s.left-ws.windowOffsetX(),n=t.pageY-s.top-ws.windowOffsetY();e!==document.documentElement&&(i+=e.scrollLeft,n+=e.scrollTop);const r=Math.max(e.scrollWidth,s.width),o=Math.max(e.scrollHeight,s.height);return{xRel:Math.round(i/r*65535),yRel:Math.round(n/o*65535),valid:!0}}}(tr||(tr={}));class ar extends sr{constructor(t,e){super(),this.V=t,this.Wa=e,this.supportedEventTypes=[Qn.MOUSEMOVE],this.tu=""}baseEnhanceAnalysisEvent(t,e){const{valid:s,xRel:i,yRel:n}=tr.getRelativePosition(t);if(s){const s=this.Wa.getEventTargetPath(t);s!==V.INVALID_ELEMENT&&(e.xRel=i,e.yRel=n,s!==this.tu||this.V.iframesTracking?(this.tu=s,e.tgtHM=s):e.tgtHM="")}else this.tu="";return e}}class hr extends sr{constructor(){super(...arguments),this.supportedEventTypes=[Qn.CHANGE],this.su=["text","email","number","search","tel","url","password"]}baseEnhanceAnalysisEvent(t,e){const s=Ne(t);return y(s)&&csArray.prototype.indexOf.call(this.su,s.type)>=0&&(e.isBlank=""===s.value),e}}class cr{constructor(t,e,s){this.V=t,this.Wa=e,this.iu=s,this.eu="select, select *, input, textarea",this.nu="select, select *, input, textarea",this.ru="a, a *, button, button *, select, select *, input, textarea",this.hu="input, select, textarea",this.ou=150,this.au=400,this.lu=!1,this.du=ni(((t,e)=>this.scrollListener(t,e)),this.ou),this.fu=ni((t=>this.resizeListener(t)),this.ou),this.wu=ye((t=>this.mouseMoveListener(t)),this.au),this.pu=[{boundElement:window,type:"resize",listener:()=>this.fu()},{boundElement:document,type:"scroll",listener:t=>this.du(t)},{boundElement:window,type:"mousemove",listener:t=>{this.wu(function(t){return t.composedPath&&Object.defineProperty(t,"__csOriginalTarget",{value:t.composedPath()[0],writable:!1,enumerable:!1}),t}(t))}},{boundElement:document,type:"mousedown",listener:t=>this.mouseDownListener(t)},{boundElement:document,type:"mouseup",listener:t=>this.mouseUpListener(t)},{boundElement:document,type:"click",listener:t=>this.clickListener(t)}],this.mu=[{type:"change",listener:this.iu.on(this.nu,(t=>this.changeListener(t)))}],this.Eu=[{boundElement:document,type:"mouseover",listener:this.iu.on(this.ru,(t=>this.mouseOverListener(t)))},{boundElement:document,type:"mouseout",listener:this.iu.on(this.ru,(t=>this.mouseOutListener(t)))},{boundElement:document,type:"focusin",listener:this.iu.on(this.eu,(t=>this.focusInListener(t)))},{boundElement:document,type:"focusout",listener:this.iu.on(this.eu,(t=>this.focusOutListener(t)))},{boundElement:document,type:"keyup",listener:this.iu.on(this.hu,(t=>this.keyUpListener(t)))},{boundElement:document,type:"keydown",listener:this.iu.on(this.hu,(t=>this.keyDownListener(t)))},{boundElement:document,type:"copy",listener:this.iu.on(this.hu,(t=>this.copyListener(t)))},{boundElement:document,type:"cut",listener:this.iu.on(this.hu,(t=>this.cutListener(t)))},{boundElement:document,type:"paste",listener:this.iu.on(this.hu,(t=>this.pasteListener(t)))},...csArray.prototype.map.call(this.mu,(t=>({...t,boundElement:document})))],this.Ya=[],this.Ns={},this.ls=new Set,this.yu=(t,e)=>{switch(e){case"initial":this.ls.add(t);break;case"added":this.ls.has(t)||(this.ls.add(t),this._s(t));break;case"removed":this.bs(t),this.ls.delete(t)}},vs.isSupported()&&(this.Au=new _s(this.yu)),this.gs(),this.V.eMerchandisingEnabled&&csArray.prototype.push.call(this.Ya,new ir(this.Wa)),this.V.mouseMoveHeatmapEnabled&&csArray.prototype.push.call(this.Ya,new ar(this.V,this.Wa)),csArray.prototype.push.call(this.Ya,new hr,new rr(this.Wa))}_s(t){if(A(t)){const t=this.gu();csArray.prototype.forEach.call(t,(t=>ge(t)))}else{const e=this.vu();csArray.prototype.forEach.call(e,(e=>{ge({...e,boundElement:t})}))}}bs(t){if(A(t)){const t=this.gu();csArray.prototype.forEach.call(t,(t=>me(t)))}else{const e=this.vu();csArray.prototype.forEach.call(e,(e=>{me({...e,boundElement:t})}))}}onEvent(t){this.zs=t}start(){var t;null===(t=this.Au)||void 0===t||t.observe(document),this._s(document),this.ls.forEach((t=>this._s(t))),this.resizeListener()}stop(){var t;this.bs(document),this.ls.forEach((t=>this.bs(t))),null===(t=this.Au)||void 0===t||t.disconnect(),this.ls.clear()}flushPendingDebouncedListeners(){this.du.flushPending(),this.fu.flushPending()}vu(){return this.iu.isMatchesSelectorSupported()?this.mu:(qt.warn("Element.matches is not implemented yet"),[])}gu(){return this.iu.isMatchesSelectorSupported()?[...this.pu,...this.Eu]:(qt.warn("Element.matches is not implemented yet"),this.pu)}resizeListener(t){const e=ke.getScrollContainer(),s=vt(e);s&&(this.lu=!0);const i={type:Qn.RESIZE,ts:0,x:s?e.clientWidth:ws.windowWidth(),y:s?e.clientHeight:ws.windowHeight()};void 0!==t&&(i.d=t),this.zs(i)}scrollListener(t,e){const s=ke.isEventOnScrollContainer(e);!this.lu&&s&&this.resizeListener();const i={type:Qn.SCROLL,ts:0,x:s?csEventtarget.apply(e).scrollLeft:ws.windowOffsetX(),y:s?csEventtarget.apply(e).scrollTop:ws.windowOffsetY(),d:t},n=nr.build(e,i,this.Ya);this.zs(n)}mouseMoveListener(t){const e={type:Qn.MOUSEMOVE,ts:0,x:t.pageX,y:t.pageY},s=nr.build(t,e,this.Ya);this.zs(s)}mouseDownListener(t){const e={type:Qn.MOUSEDOWN,ts:0,x:t.pageX,y:t.pageY,tgt:""},s=nr.build(t,e,this.Ya);this._u(s)}mouseUpListener(t){const e={type:Qn.MOUSEUP,ts:0,x:t.pageX,y:t.pageY,tgt:""},s=nr.build(t,e,this.Ya);this._u(s)}clickListener(t){const e={type:Qn.CLICK,ts:0,x:t.pageX,y:t.pageY,tgt:""},s=nr.build(t,e,this.Ya);this._u(s)}mouseOverListener(t){const e={type:Qn.MOUSEOVER,ts:0,x:t.pageX,y:t.pageY,tgt:""},s=nr.build(t,e,this.Ya);this._u(s)}mouseOutListener(t){const e={type:Qn.MOUSEOUT,ts:0,x:t.pageX,y:t.pageY,tgt:this.Wa.getEventTargetPath(t)},s=nr.build(t,e,this.Ya);this._u(s)}focusInListener(t){const e={type:Qn.FOCUSIN,ts:0,tgt:this.Wa.getEventTargetPath(t)},s=nr.build(t,e,this.Ya);this._u(s)}focusOutListener(t){const e={type:Qn.FOCUSOUT,ts:0,tgt:this.Wa.getEventTargetPath(t)},s=nr.build(t,e,this.Ya);this._u(s)}changeListener(t){const e={type:Qn.CHANGE,ts:0,tgt:this.Wa.getEventTargetPath(t)},s=nr.build(t,e,this.Ya);this._u(s)}copyListener(t){const e={type:Qn.COMMAND,ts:0,tgt:this.Wa.getEventTargetPath(t),key:ve.COPY};this._u(e)}cutListener(t){const e={type:Qn.COMMAND,ts:0,tgt:this.Wa.getEventTargetPath(t),key:ve.CUT};this._u(e)}pasteListener(t){const e={type:Qn.COMMAND,ts:0,tgt:this.Wa.getEventTargetPath(t),key:ve.PASTE};this._u(e)}keyUpListener(t){const e={type:Qn.KEYUP,ts:0,tgt:this.Wa.getEventTargetPath(t),key:this.Ru(t)};this._u(e)}keyDownListener(t){const e={type:Qn.KEYDOWN,ts:0,tgt:this.Wa.getEventTargetPath(t),key:this.Ru(t)};this._u(e)}Ru(t){const e=this.Ns[t.key];return void 0===e?Se.ALPHANUMERICAL:e}_u(t){er(t)&&t.tgt!==V.INVALID_ELEMENT&&this.zs(t)}gs(){this.Ns[" "]=Se.SPACE,this.Ns.Spacebar=Se.SPACE,this.Ns.Enter=Se.ENTER,this.Ns.Backspace=Se.BACKSPACE,this.Ns.Delete=Se.DELETE,this.Ns.ArrowUp=Se.ARROWUP,this.Ns.ArrowDown=Se.ARROWDOWN,this.Ns.ArrowLeft=Se.ARROWLEFT,this.Ns.ArrowRight=Se.ARROWRIGHT,this.Ns.Up=Se.ARROWUP,this.Ns.Down=Se.ARROWDOWN,this.Ns.Left=Se.ARROWLEFT,this.Ns.Right=Se.ARROWRIGHT,this.Ns.CapsLock=Se.CAPSLOCK,this.Ns.Shift=Se.SHIFT,this.Ns.Tab=Se.TAB}}Zt([Yt("Event handler type: resize")],cr.prototype,"resizeListener",null),Zt([Yt("Event handler type: scroll")],cr.prototype,"scrollListener",null),Zt([Yt("Event handler type: mouseMove"),Oe()],cr.prototype,"mouseMoveListener",null),Zt([Yt("Event handler type: mouseDown"),Oe()],cr.prototype,"mouseDownListener",null),Zt([Yt("Event handler type: mouseUp"),Oe()],cr.prototype,"mouseUpListener",null),Zt([Yt("Event handler type: click"),Oe()],cr.prototype,"clickListener",null),Zt([Yt("Event handler type: mouseOver"),Oe()],cr.prototype,"mouseOverListener",null),Zt([Yt("Event handler type: mouseOut"),Oe()],cr.prototype,"mouseOutListener",null),Zt([Yt("Event handler type: focusIn")],cr.prototype,"focusInListener",null),Zt([Yt("Event handler type: focusOut")],cr.prototype,"focusOutListener",null),Zt([Yt("Event handler type: change")],cr.prototype,"changeListener",null),Zt([Yt("Event handler type: copy")],cr.prototype,"copyListener",null),Zt([Yt("Event handler type: cut")],cr.prototype,"cutListener",null),Zt([Yt("Event handler type: paste")],cr.prototype,"pasteListener",null),Zt([Yt("Event handler type: keyup")],cr.prototype,"keyUpListener",null),Zt([Yt("Event handler type: keydown")],cr.prototype,"keyDownListener",null);class lr{constructor(){this.Su=100,this.Tu=0,this.Iu=ws.documentHeight(),this.Pu={boundElement:document,type:"scroll",listener:t=>this.maxScrollRateListener(t)}}onEvent(t){this.zs=t}start(){ge(this.Pu),this.reset()}stop(){me(this.Pu)}reset(){this.Iu=ws.documentHeight();const t=ke.getScrollContainer();if(null===t)this.Tu=this.bu(ws.documentHeight());else{const e=this.Vu(t);this.Tu=this.Cu(t,e)}this.zs()}maxScrollRateListener(t){let e,s;if(ke.isEventOnScrollContainer(t)){const i=csEventtarget.apply(t),n=this.Vu(i);e=this.Nu(i,n),s=this.Cu(i,n)}else e=ws.documentHeight(),s=this.bu(e);(s>this.Tu||e>this.Iu)&&(this.Tu=s,e>this.Iu&&(this.Iu=e),this.zs())}bu(t){const e=Math.round(this.Ou()/t*100);return Math.min(e,this.Su)}Ou(){const t=ws.windowHeight();return ws.windowOffsetY()+t}Cu(t,e){const s=t.scrollTop+t.clientHeight+t.getBoundingClientRect().top+e,i=this.Nu(t,e),n=Math.round(s/i*100);return Math.min(n,this.Su)}Vu(t){const e=window.getComputedStyle(t).paddingTop||"0px";return parseInt(e,10)}Nu(t,e){return t.scrollHeight+t.getBoundingClientRect().top+e}getRequestParameters(){return{sr:`${this.Tu}`,mdh:`${this.Iu}`}}}Zt([Yt("MaxScrollRate handler")],lr.prototype,"maxScrollRateListener",null);class ur{constructor(t,e,s,i,n,r,o,a,h,c,l,u,d,p,g,m,f,y,E,S,v){this.$=t,this.ku=e,this.Or=s,this.$u=i,this.Lu=n,this.xu=r,this.Mu=o,this.Du=a,this.Yi=h,this.Zt=c,this.Uu=l,this.zu=u,this.Ae=d,this.ie=p,this.Fu=g,this.Bu=m,this.Hu=f,this.qu=y,this.ju=E,this.Gu=S,this.Zu=v,this.ae=new Ye,this.Wu=!1}init(){var t,e,s,i,n,r,o;this.ku.onEvent((t=>this.pe(t))),this.Or.onEvent((t=>this.pe(t))),this.$u.onEvent((()=>{const t=this.$u.getRequestParameters();this.ie.setQueryParams(t),this.Mu.setQueryParams(t)})),this.zu.onEvent((t=>this.Ku(t))),this.Yu(),null===(t=this.Fu)||void 0===t||t.onEvent((t=>this.pe(t))),null===(e=this.ju)||void 0===e||e.onEvent((t=>this.pe(t))),null===(s=this.Bu)||void 0===s||s.onEvent((t=>this.pe(t))),null===(i=this.Hu)||void 0===i||i.onEvent((t=>this.pe(t))),this.Qu(),null===(n=this.qu)||void 0===n||n.onEvent((t=>this.Ku(t))),null===(r=this.Gu)||void 0===r||r.onEvent((t=>this.Ku(t))),null===(o=this.Zu)||void 0===o||o.onEvent((t=>this.Ku(t)))}Qu(){this.Mu.onBeaconSuccess((()=>{this.xu.clearEvents()})),this.Mu.onBeaconFailure((t=>{this.Ju(t)}))}initStates(){const t=this.Du.getRequestParameters(),e=this.Lu.getRequestParameters(),s=this.$u.getRequestParameters();this.ie.setQueryParams(t),this.ie.setQueryParams(e),this.ie.setQueryParams(s),this.Mu.setQueryParams(t),this.Mu.setQueryParams(e),this.Mu.setQueryParams(s),this.Xu()}start(t){var e,s,i,n,r,o,a;t||null===(e=this.qu)||void 0===e||e.start(),this.Ae.start(),this.ku.start(),this.$u.start(),this.Or.start(),null===(s=this.Fu)||void 0===s||s.start(),null===(i=this.Hu)||void 0===i||i.start(),t||this.zu.start(),null===(n=this.Bu)||void 0===n||n.start(),null===(r=this.ju)||void 0===r||r.start(),null===(o=this.Gu)||void 0===o||o.start(),null===(a=this.Zu)||void 0===a||a.start()}collectInitialEvents(){var t;null===(t=this.Fu)||void 0===t||t.collectInitialEvents()}onIframeAnalysisEvent(t){this.$e(t)}Ku(t){this.Yi.isCurrentPageviewValid()&&this.$e(t)}pe(t){this.Yi.isSessionValid()&&this.$e(t)}$e(t){this.xu.addEvent(this.tl(t)),this.xu.isFull()&&this.sendEvents(),this.$.emitDebugEvents&&this.ae.emit("analysisEvent",{...t,typeName:Qn[t.type]})}tl(t){return t.ts=this.sl(),t}il(){this.Mu.setQueryParams({hlm:"true"}),this.Wu=!0}sendLastMessageBeacon(){this.Mu.setQueryParams(this.Lu.getRequestParameters()),this.Mu.send(this.xu.stringifyEvents()),this.Mu.removeQueryParams(["hlm"]),this.Wu=!1}sendEvents(){this.xu.isEmpty()||(this.ie.setQueryParams(this.Du.getRequestParameters()),this.ie.setQueryParams(this.Lu.getRequestParameters()),this.ie.send(this.xu.getEvents()),this.xu.clearEvents())}stop(){var t,e,s,i,n,r,o;this.Ae.stop(),this.ku.stop(),this.$u.stop(),this.Or.stop(),this.zu.stop(),null===(t=this.Fu)||void 0===t||t.stop(),null===(e=this.Bu)||void 0===e||e.stop(),null===(s=this.Hu)||void 0===s||s.stop(),null===(i=this.ju)||void 0===i||i.stop(),this.xu.empty(),null===(n=this.qu)||void 0===n||n.stop(),null===(r=this.Gu)||void 0===r||r.stop(),null===(o=this.Zu)||void 0===o||o.stop()}clearStates(t){var e,s;this.ku.flushPendingDebouncedListeners(),null===(e=this.Bu)||void 0===e||e.flushPendingKeyboardNavigationEvent(),null===(s=this.Hu)||void 0===s||s.flushPendingTextHighlightEvent(),t?(this.il(),this.sendLastMessageBeacon()):this.sendEvents(),this.$u.reset(),this.zu.stop(),this.ie.removeQueryParams()}Xu(){this.el=ht()}sl(){return ht()-this.el}Yu(){this.Ae.onEvent((t=>{var e,s;null===(e=this.Bu)||void 0===e||e.flushPendingKeyboardNavigationEvent(),null===(s=this.Hu)||void 0===s||s.flushPendingTextHighlightEvent(),t===Qe.PagehideVisible?this.il():t===Qe.PagehideHidden?(this.il(),this.sendLastMessageBeacon()):this.xu.isEmpty()&&!this.Wu||this.sendLastMessageBeacon()}))}Ju(t){try{this.xu.isEmpty()&&!this.Wu||this.Zt.save({requestParameters:t,events:this.xu.getEvents()})}catch{}}pushSubmitEvent(t,e){if(!function(t){return t===Jn.SUCCESS||t===Jn.FAILURE||t===Jn.ATTEMPT}(t))return void qt.warn(`AnalysisEvents Service: invalid submit status: ${t}`);if(!vt(e))return void qt.warn(`AnalysisEvents Service: invalid element: ${e}`);const s={status:t,type:Qn.SUBMIT,ts:0,tgt:this.Uu.getElementPath(e)};s.tgt!==V.INVALID_ELEMENT&&this.Ku(s)}}class dr{constructor(t,e){this.Zt=t,this.ie=e,this.nl=()=>{"visible"===document.visibilityState&&this.rl()}}start(){this.rl(),this.Ai()}stop(){this._i()}getRecoveryStorage(){return this.Zt}rl(){const t=this.Zt.recover();if(null!==t){const{requestParameters:e,events:s}=t;this.ie.send(s,e)}}Ai(){document.addEventListener("visibilitychange",this.nl)}_i(){document.removeEventListener("visibilitychange",this.nl)}}class pr{constructor(t){this.oo=t}save(t){localStorage.setItem(this.oo,csJSON.stringify(t))}clear(){localStorage.removeItem(this.oo)}recover(){const t=localStorage.getItem(this.oo);if(null===t)return null;let e=null;try{e=csJSON.parse(t)}catch{qt.error(`Invalid item in localStorage.\n         (key:${this.oo}; value:${t})`)}finally{this.clear()}return e}}class gr{constructor(t){this.hl=t,this.ol=t=>this.processMetric(t),this.mi=!1}onEvent(t){this.zs=t}start(){this.mi||(this.mi=!0,this.hl.onFCP(this.ol),this.hl.onCLS(this.ol),this.hl.onFID(this.ol),this.hl.onLCP(this.ol),this.hl.onTTFB(this.ol),this.hl.onINP(this.ol))}stop(){this.mi=!1}processMetric(t){if(!this.mi)return;const e={type:Qn.PERFORMANCE,name:t.name,val:t.value,ts:0};this.zs(e)}}Zt([Yt("Performance metric handler")],gr.prototype,"processMetric",null);var mr,fr,yr,Er,Sr,vr=-1,wr=function(t){addEventListener("pageshow",(function(e){e.persisted&&(vr=e.timeStamp,t(e))}),!0)},Rr=function(){return window.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]},Ar=function(){var t=Rr();return t&&t.activationStart||0},Tr=function(t,e){var s=Rr(),i="navigate";return vr>=0?i="back-forward-cache":s&&(document.prerendering||Ar()>0?i="prerender":document.wasDiscarded?i="restore":s.type&&(i=s.type.replace(/_/g,"-"))),{name:t,value:void 0===e?-1:e,rating:"good",delta:0,entries:[],id:"v3-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:i}},_r=function(t,e,s){try{if(PerformanceObserver.supportedEntryTypes.includes(t)){var i=new PerformanceObserver((function(t){Promise.resolve().then((function(){e(t.getEntries())}))}));return i.observe(Object.assign({type:t,buffered:!0},s||{})),i}}catch(t){}},br=function(t,e,s,i){var n,r;return function(o){e.value>=0&&(o||i)&&((r=e.value-(n||0))||void 0===n)&&(n=e.value,e.delta=r,e.rating=function(t,e){return t>e[1]?"poor":t>e[0]?"needs-improvement":"good"}(e.value,s),t(e))}},Cr=function(t){requestAnimationFrame((function(){return requestAnimationFrame((function(){return t()}))}))},Nr=function(t){var e=function(e){"pagehide"!==e.type&&"hidden"!==document.visibilityState||t(e)};addEventListener("visibilitychange",e,!0),addEventListener("pagehide",e,!0)},Or=function(t){var e=!1;return function(s){e||(t(s),e=!0)}},Ir=-1,Pr=function(){return"hidden"!==document.visibilityState||document.prerendering?1/0:0},kr=function(t){"hidden"===document.visibilityState&&Ir>-1&&(Ir="visibilitychange"===t.type?t.timeStamp:0,Dr())},Lr=function(){addEventListener("visibilitychange",kr,!0),addEventListener("prerenderingchange",kr,!0)},Dr=function(){removeEventListener("visibilitychange",kr,!0),removeEventListener("prerenderingchange",kr,!0)},Mr=function(){return Ir<0&&(Ir=Pr(),Lr(),wr((function(){setTimeout((function(){Ir=Pr(),Lr()}),0)}))),{get firstHiddenTime(){return Ir}}},xr=function(t){document.prerendering?addEventListener("prerenderingchange",(function(){return t()}),!0):t()},Ur=[1800,3e3],$r=function(t,e){e=e||{},xr((function(){var s,i=Mr(),n=Tr("FCP"),r=_r("paint",(function(t){t.forEach((function(t){"first-contentful-paint"===t.name&&(r.disconnect(),t.startTime<i.firstHiddenTime&&(n.value=Math.max(t.startTime-Ar(),0),n.entries.push(t),s(!0)))}))}));r&&(s=br(t,n,Ur,e.reportAllChanges),wr((function(i){n=Tr("FCP"),s=br(t,n,Ur,e.reportAllChanges),Cr((function(){n.value=performance.now()-i.timeStamp,s(!0)}))})))}))},zr=[.1,.25],Vr={passive:!0,capture:!0},Wr=new Date,Br=function(t,e){mr||(mr=e,fr=t,yr=new Date,qr(removeEventListener),Hr())},Hr=function(){if(fr>=0&&fr<yr-Wr){var t={entryType:"first-input",name:mr.type,target:mr.target,cancelable:mr.cancelable,startTime:mr.timeStamp,processingStart:mr.timeStamp+fr};Er.forEach((function(e){e(t)})),Er=[]}},Fr=function(t){if(t.cancelable){var e=(t.timeStamp>1e12?new Date:performance.now())-t.timeStamp;"pointerdown"==t.type?function(t,e){var s=function(){Br(t,e),n()},i=function(){n()},n=function(){removeEventListener("pointerup",s,Vr),removeEventListener("pointercancel",i,Vr)};addEventListener("pointerup",s,Vr),addEventListener("pointercancel",i,Vr)}(e,t):Br(e,t)}},qr=function(t){["mousedown","keydown","touchstart","pointerdown"].forEach((function(e){return t(e,Fr,Vr)}))},Gr=[100,300],Yr=0,Zr=1/0,jr=0,Xr=function(t){t.forEach((function(t){t.interactionId&&(Zr=Math.min(Zr,t.interactionId),jr=Math.max(jr,t.interactionId),Yr=jr?(jr-Zr)/7+1:0)}))},Kr=function(){return Sr?Yr:performance.interactionCount||0},Qr=[200,500],Jr=0,to=function(){return Kr()-Jr},eo=[],so={},io=function(t){var e=eo[eo.length-1],s=so[t.interactionId];if(s||eo.length<10||t.duration>e.latency){if(s)s.entries.push(t),s.latency=Math.max(s.latency,t.duration);else{var i={id:t.interactionId,latency:t.duration,entries:[t]};so[i.id]=i,eo.push(i)}eo.sort((function(t,e){return e.latency-t.latency})),eo.splice(10).forEach((function(t){delete so[t.id]}))}},no=[2500,4e3],ro={},oo=[800,1800],ao=function t(e){document.prerendering?xr((function(){return t(e)})):"complete"!==document.readyState?addEventListener("load",(function(){return t(e)}),!0):setTimeout(e,0)},ho=function(t,e){e=e||{};var s=Tr("TTFB"),i=br(t,s,oo,e.reportAllChanges);ao((function(){var n=Rr();if(n){var r=n.responseStart;if(r<=0||r>performance.now())return;s.value=Math.max(r-Ar(),0),s.entries=[n],i(!0),wr((function(){s=Tr("TTFB",0),(i=br(t,s,oo,e.reportAllChanges))(!0)}))}}))};class co{onFCP(t){$r(t,{reportAllChanges:!0})}onCLS(t){!function(t,e){e=e||{},$r(Or((function(){var s,i=Tr("CLS",0),n=0,r=[],o=function(t){t.forEach((function(t){if(!t.hadRecentInput){var e=r[0],s=r[r.length-1];n&&t.startTime-s.startTime<1e3&&t.startTime-e.startTime<5e3?(n+=t.value,r.push(t)):(n=t.value,r=[t])}})),n>i.value&&(i.value=n,i.entries=r,s())},a=_r("layout-shift",o);a&&(s=br(t,i,zr,e.reportAllChanges),Nr((function(){o(a.takeRecords()),s(!0)})),wr((function(){n=0,i=Tr("CLS",0),s=br(t,i,zr,e.reportAllChanges),Cr((function(){return s()}))})),setTimeout(s,0))})))}(t,{reportAllChanges:!0})}onFID(t){!function(t,e){e=e||{},xr((function(){var s,i=Mr(),n=Tr("FID"),r=function(t){t.startTime<i.firstHiddenTime&&(n.value=t.processingStart-t.startTime,n.entries.push(t),s(!0))},o=function(t){t.forEach(r)},a=_r("first-input",o);s=br(t,n,Gr,e.reportAllChanges),a&&Nr(Or((function(){o(a.takeRecords()),a.disconnect()}))),a&&wr((function(){var i;n=Tr("FID"),s=br(t,n,Gr,e.reportAllChanges),Er=[],fr=-1,mr=null,qr(addEventListener),i=r,Er.push(i),Hr()}))}))}(t,{reportAllChanges:!0})}onLCP(t){!function(t,e){e=e||{},xr((function(){var s,i=Mr(),n=Tr("LCP"),r=function(t){var e=t[t.length-1];e&&e.startTime<i.firstHiddenTime&&(n.value=Math.max(e.startTime-Ar(),0),n.entries=[e],s())},o=_r("largest-contentful-paint",r);if(o){s=br(t,n,no,e.reportAllChanges);var a=Or((function(){ro[n.id]||(r(o.takeRecords()),o.disconnect(),ro[n.id]=!0,s(!0))}));["keydown","click"].forEach((function(t){addEventListener(t,(function(){return setTimeout(a,0)}),!0)})),Nr(a),wr((function(i){n=Tr("LCP"),s=br(t,n,no,e.reportAllChanges),Cr((function(){n.value=performance.now()-i.timeStamp,ro[n.id]=!0,s(!0)}))}))}}))}(t,{reportAllChanges:!0})}onTTFB(t){ho(t,{reportAllChanges:!0})}onINP(t){!function(t,e){e=e||{},xr((function(){var s;"interactionCount"in performance||Sr||(Sr=_r("event",Xr,{type:"event",buffered:!0,durationThreshold:0}));var i,n=Tr("INP"),r=function(t){t.forEach((function(t){t.interactionId&&io(t),"first-input"===t.entryType&&!eo.some((function(e){return e.entries.some((function(e){return t.duration===e.duration&&t.startTime===e.startTime}))}))&&io(t)}));var e,s=(e=Math.min(eo.length-1,Math.floor(to()/50)),eo[e]);s&&s.latency!==n.value&&(n.value=s.latency,n.entries=s.entries,i())},o=_r("event",r,{durationThreshold:null!==(s=e.durationThreshold)&&void 0!==s?s:40});i=br(t,n,Qr,e.reportAllChanges),o&&("PerformanceEventTiming"in window&&"interactionId"in PerformanceEventTiming.prototype&&o.observe({type:"first-input",buffered:!0}),Nr((function(){r(o.takeRecords()),n.value<0&&to()>0&&(n.value=0,n.entries=[]),i(!0)})),wr((function(){eo=[],Jr=Kr(),n=Tr("INP"),i=br(t,n,Qr,e.reportAllChanges)})))}))}(t,{reportAllChanges:!0})}}class lo{constructor(t=[]){this.Ws=t}stringifyEvents(){return csJSON.stringify(this.Ws)}addEvent(t){csArray.prototype.push.call(this.Ws,t)}eventsCount(){return this.Ws.length}clearEvents(){this.Ws=[]}empty(){this.clearEvents()}isFull(){return this.eventsCount()>=50}isEmpty(){return 0===this.Ws.length}getEvents(){return this.Ws}}const uo="v2/events",po=["submit"];class go{constructor(t,e,s,i,n,r,o,a,h,c){this.$=t,this.Bo=e,this.Z=s,this.Uu=i,this.iu=n,this.Wc=r,this.Yi=o,this.Or=a,this.Ca=h,this.Jc=c}init(){const t=new lo,e=this.Jc.create(`${this.$.getTrackerUri()}/${uo}`,!0,"base64");this.cl=this.al(e),this.ul=this.ll(t,this.cl.getRecoveryStorage(),e),this.ul.init(),this.Ca.addListener(this.ul),this.Wc.register(po,((t,e)=>{this.ul.pushSubmitEvent(t,e)}))}onStartTracking(t){this.cl.start(),this.ul.start(t)}onAfterNaturalPageView(){this.ul.initStates()}onAfterArtificialPageView(){this.ul.initStates(),this.ul.collectInitialEvents()}onArtificialPageViewEnd(){this.ul.clearStates(!0)}onBeforeSessionRenewal(){this.ul.clearStates(),this.ul.stop(),this.cl.stop()}onOptout(){this.ul.stop(),this.cl.stop()}ll(t,e,s){const i=new Kn(window),n=new lr,r=new cr(this.$,this.Uu,this.iu),o=new or(this.$,this.Uu,this.Or),a=new gr(new co),h=new os,c=new Ri(`${this.$.getTrackerUri()}/${uo}`),l=new ii(this.Bo,this.Z);return new ur(this.$,r,o,n,i,t,c,l,this.Yi,e,this.Uu,a,h,s,void 0,void 0,void 0,void 0,void 0,void 0,void 0)}al(t){return new dr(new pr("csAnalysisEventsPersisted"),t)}}var mo;!function(t){t.Artificial="a",t.Renewal="r",t.Natural="n"}(mo||(mo={}));class fo extends Ze{constructor(t,e,s,i){super(),this.Ls=t,this.dl=e,this.X=s,this.da=i}init(){this.wl()}onStart(t){t?this.pl():this.ml()}onStop(){}triggerArtificialPageView(t){this.isStarted?this.El(t):this.X.overridePath(t)}ml(){this.da.setPageViewType(mo.Natural),this.Ls.emitBeforeNaturalPageView(),this.dl.send(),this.Ls.emitAfterNaturalPageView()}pl(){this.da.setPageViewType(mo.Renewal),this.Ls.emitBeforeNaturalPageView(),this.dl.send(),this.Ls.emitAfterNaturalPageView()}El(t){this.da.setPageViewType(mo.Artificial),this.Ls.emitArtificialPageViewEnd(),t&&this.X.overridePath(t),this.Ls.emitBeforeArtificialPageView(),this.dl.send(),this.Ls.emitAfterArtificialPageView()}wl(){window.addEventListener("pageshow",(t=>{this.isStarted&&t.persisted&&this.El()}))}}const yo=window.navigator.language||window.navigator.userLanguage||window.navigator.browserLanguage||window.navigator.systemLanguage||"unknown";function Eo(){return{la:yo}}class So{constructor(t){this.Xc=t,this.yl=[],this.Al=!1}getRequestParameters(){return{dr:this.gl()}}addUrlMaskingPattern(t){const e=this.Xc.getUrlMaskingPattern(t);csArray.prototype.push.call(this.yl,e)}enableRemoveQueryString(){this.Al=!0}disableRemoveQueryString(){this.Al=!1}gl(){const t=this.Al?this.Xc.removeQueryString(this.vl()):this.vl();return this.Xc.anonymizeUrl(t,this.yl)}vl(){let t="";try{t=window.top.document.referrer}catch(e){if(window.parent)try{t=window.parent.document.referrer}catch{t=""}}return""===t&&(t=document.referrer),"string"!=typeof t&&(t=""),t}}class vo{constructor(t){this.W=t,this._l=this.Rl()&&"currentScript"in document}Sl(){const t=document.currentScript;if(!t)return null;const e=window.performance.getEntriesByName(t.src,"resource")[0];return!e||this.Tl(e)?null:Math.round(e.responseEnd-e.fetchStart)}Tl(t){const e=t.transferSize;return void 0!==e?0===e||e<t.encodedBodySize:t.connectStart===t.domainLookupEnd}getRequestParameters(){if(!this._l||1!==this.wa())return{};const t=this.Sl();return null===t?{}:{dt:`${Math.min(t,99999)}`}}wa(){var t;return(null===(t=this.W.getSession())||void 0===t?void 0:t.pageNumber)||null}Rl(){return"object"==typeof window.performance&&"function"==typeof window.performance.getEntriesByName}}const wo=["trackPageview"],Ro=["setPath"],Ao=["setQuery"],To=["referrer:maskUrl"],_o=["referrer:removeQueryString"],bo=["referrer:keepQueryString"];class Co{constructor(t,e,s,i,n,r,o,a,h,c,l,u){this.$=t,this.Wc=e,this.Ls=s,this.jo=i,this.Z=n,this.W=r,this.Hh=o,this.rs=a,this.Xc=h,this.X=c,this.Qc=l,this.da=u}init(){const t=new J(this.$.getTrackerUri(),"pageview");this.Il=new fo(this.Ls,t,this.X,this.da);const s=new So(this.Xc);this.Il.init();const i=new ii(this.jo,this.Z,ws,s,this.X,this.Hh,e,this.rs,this.da,new vo(this.W),this.Qc);t.setRequestParametersProviders(i),this.Wc.register(wo,(t=>this.Il.triggerArtificialPageView(t))),this.Wc.register(Ro,(t=>this.X.overridePath(t))),this.Wc.register(Ao,(t=>this.X.overrideQuery(t))),this.Wc.register(To,(t=>s.addUrlMaskingPattern(t))),this.Wc.register(_o,(()=>s.enableRemoveQueryString())),this.Wc.register(bo,(()=>s.disableRemoveQueryString()))}start(t){this.Il.start(t)}onBeforeSessionRenewal(){this.Il.stop()}}class No{constructor(t){this.Wa=t}on(t,e){return s=>{this.Wa.hasValidEventTarget(s)&&this.Pl(s,t)&&e(s)}}Pl(t,e){const s=Ne(t);return I.call(s,e)}isMatchesSelectorSupported(){return!!I}}class Oo{constructor(){}onLoad(t){this.Yt=t}onLoadCallbackExecute(){this.Yt()}start(){const t=this.onLoadCallbackExecute.bind(this);this.bl(t)}bl(t){function e(){document.removeEventListener("DOMContentLoaded",e),window.removeEventListener("load",e),t()}"complete"===document.readyState||"loading"!==document.readyState&&!document.documentElement.doScroll?setTimeout(t):(document.addEventListener("DOMContentLoaded",e),window.addEventListener("load",e))}}Zt([Yt("onLoad")],Oo.prototype,"onLoadCallbackExecute",null);class Io{constructor(t,e,s){this.$=t,this.Z=e,this.W=s,this.el=ht()}resetStartTime(){this.el=ht()}getSessionData(){const{projectId:t}=this.$,e=this.Z.getVisitor();null==e&&qt.warn("Visitor is null. This happens when a snippet tries to get Session Data before the tag was initialized.");const{id:s,visitsCount:i}=null!=e?e:{},n=this.W.getSession();null===n&&qt.warn("Session is null. This happens when a snippet tries to get Session Data before the tag was initialized.");const{pageNumber:r}=null!=n?n:{};return{projectId:t,userId:s,sessionNumber:i,pageNumber:r,relativeTimestamp:ht()-this.el}}}const Po=["clearSession"],ko=["extendSession"],Lo=["getSessionData"],Do=["session:start:newVisitor"],Mo=["session:clear:visitor"];class xo{constructor(t,e,s,i){this.$=t,this.Z=e,this.W=s,this.Wc=i}init(){this.Vl=new Io(this.$,this.Z,this.W),this.Wc.register(Po,(()=>this.W.removeSession())),this.Wc.register(ko,(()=>this.W.extendSessionPeriodically()),{disableApplyPending:!0}),this.Wc.register(Lo,(()=>this.Vl.getSessionData()),{disableApplyPending:!0}),this.Wc.register(Do,(()=>this.Z.renewVitor())),this.Wc.register(Mo,(()=>{this.Z.resetVisitor()}),{disableApplyImmediate:!0})}onBeforeNaturalPageView(){this.Z.createOrUpdateVisitor(),this.W.createOrUpdateSession()}onBeforeArtificialPageView(){this.W.abortQuotaServiceRequest(),this.Z.createOrUpdateVisitor(),this.W.createOrUpdateSession()}onAfterNaturalPageView(){this.Vl.resetStartTime()}onAfterArtificialPageView(){this.Vl.resetStartTime()}onOptout(){this.Z.removeVisitor(),this.W.removeSession()}onRecordingStateChange(t,e){this.W.updateRecordingState(t,e)}}class Uo{constructor(t,e){this.W=t,this.Z=e,this.Cl=!1}onSessionExpired(t){this.Nl=t}isSessionValid(){if(this.Cl)return!0;const t=this.W.hasValidSession();let e=!1;return this.W.pollCacheRefreshEvent()&&(e=this.Z.isSessionRenewed()),t&&!e||!this.Ol()?t:(this.kl=ht(),this.Cl=!0,this.Nl(),this.Cl=!1,this.W.hasValidSession())}isCurrentPageviewValid(){const t=this.W.hasValidSession();return this.W.pollCacheRefreshEvent(!1)?!this.Z.isSessionRenewed():t}startNewSession(){this.Nl()}Ol(){return!yt(this.kl)||ht()-this.kl>6e4}}class $o extends Ze{constructor(t,e,s,i,n,r,o,a){super(),this.X=t,this.$l=e,this.Ae=s,this.Ll=i,this.xl=n,this.Ml=r,this.Dl=o,this.Ul=a}init(){this.zl(),this.Yu(),this.Fl(),this.Bl()}collectInitialProducts(){this.$l.collectProductsAndAnchors(document,(({products:t,anchors:e})=>{this.Hl(e),this.Ll.send(this.ql(t))}))}startDisplayAdExposureTracking(){var t;null===(t=this.Ul)||void 0===t||t.restart()}Hl(t){csArray.prototype.forEach.call(t,(t=>{this.Dl.pushProduct(t)}))}onIframeEmerchandisingMessage(t){this.Ll.send(t)}clearState(){var t,e;this.Ml.clearState(),null===(t=this.Ul)||void 0===t||t.cancleTimers(),null===(e=this.Ul)||void 0===e||e.clearState(),this.$l.flushEvents(),this.xl.isEmpty()||this.jl(!1),this.Ll.clearState()}initStates(){this.Ll.initStates()}onStart(){var t;this.Ae.start(),this.$l.start(),this.Ml.start(),null===(t=this.Ul)||void 0===t||t.start()}onStop(){var t;this.Ae.stop(),this.$l.stop(),this.Ml.stop(),null===(t=this.Ul)||void 0===t||t.stop()}Fl(){this.Ml.onProductExposed((t=>{this.xl.addProductExposure(t),this.xl.isFull()&&this.jl(!1)}))}ql(t,e=[],s=[]){const i={products:t,targetUrl:this.X.getAnonymizedUrl(),windowWidth:ws.windowWidth(),windowHeight:ws.windowHeight()};return e.length>0&&(i.exposures=e),s.length>0&&(i.contentExposures=s),i}zl(){this.$l.init(),this.$l.onProductsDetection((({products:t,anchors:e})=>{this.xl.addProducts(t),this.xl.isFull()&&this.jl(!1),this.Hl(e)}))}Yu(){this.Ae.onEvent((t=>{var e;this.Ml.clearState(),null===(e=this.Ul)||void 0===e||e.cancleTimers(),this.Gl()}))}Gl(){this.xl.isEmpty()||this.jl(!0)}jl(t){const e=this.ql(this.xl.getProducts(),this.xl.getProductsExposure(),this.xl.getExposedContentItems());t?this.Ll.sendBeacon(e):this.Ll.send(e)}Bl(){this.Ul&&(this.Ul.init(),this.Ul.onDisplayAdExposed((t=>{this.xl.addExposedContentItems(t),this.xl.isFull()&&this.jl(!1)})))}}class zo{constructor(t,e=30,s=0){this.Zl=t,this.Wl=e,this.Kl=s,this.Yl=new ts,this.Y=!1,this.Ql=0,this.Jl=()=>{for(this.Ql=0;this.Yl.length;){if(this.Ql>=this.Wl)return void setTimeout(this.Jl,this.Kl);const t=ht(),e=this.Yl.pop();if(!e)break;this.runTask(e);const s=ht()-t;this.Ql+=s}this.Y=!1}}schedule(t,e=!1){this.Zl&&!e?(this.Yl.push(t),this.Xl()):t()}Xl(){this.Y||(this.Y=!0,setTimeout((()=>{this.Jl()})))}runTask(t){t()}runPendingTasks(){this.Yl.forEach((t=>{this.runTask(t)})),this.Yl.clear()}clearQueue(){this.Yl.clear()}isEmpty(){return 0===this.Yl.length}}Zt([Yt("TaskScheduler"),Ce("runTask")],zo.prototype,"runTask",null),Zt([Ce("runPendingTasks")],zo.prototype,"runPendingTasks",null);class Vo{constructor(t,e){this.configuration=t,this.projectPathComputation=e,this.hr=new zo(!0)}collectProductsAndAnchors(t=document,e){this.hr.schedule((()=>{const s=[];this.getAllValidAnchors(this.configuration.hostnames,t,(t=>{for(const e of t)csArray.prototype.push.call(s,this.buildProductFromAnchor(e));e({products:s,anchors:t})}))}))}getAllValidAnchors(t,e=document,s){const i=[],n=new IntersectionObserver((e=>{csArray.prototype.forEach.call(e,(e=>{const s=e.target;("https:"===s.protocol||"http:"===s.protocol)&&""!==s.hostname&&Math.round(e.boundingClientRect.height)>0&&Math.round(e.boundingClientRect.width)>0&&Dt(s.hostname,t)&&csArray.prototype.push.call(i,s)})),s(i),n.disconnect()})),r=Ts.findAllElements("a",e);csArray.prototype.forEach.call(r,(t=>{n.observe(t)}))}isAnchorValid(t,e){return("https:"===t.protocol||"http:"===t.protocol)&&t.offsetHeight>0&&t.offsetWidth>0&&""!==t.hostname&&Dt(t.hostname,e)}buildProductFromAnchor(t){return{targetPath:this.projectPathComputation.getElementPath(t),href:t.href}}}Zt([Ce("getAllValidAnchors")],Vo.prototype,"getAllValidAnchors",null);class Wo extends Vo{constructor(t,e,s){super(t,e),this.ks=s,this.td={subtree:!0,childList:!0}}init(){this.ur()}start(){this.ks.start(),this.sd()}stop(){this.ks.stop()}flushEvents(){this.ks.flushPendingMutations()}onProductsDetection(t){this.nd=t}ur(){this.ks.init(),this.rd()}rd(){this.ks.onChildListMutation((t=>this.od(t))),this.ks.onAttachShadowMutation((t=>this.ad(t)))}od(t){for(let e=0;e<t.addedNodes.length;e+=1){const s=t.addedNodes[e];if(p(s)&&this.isAnchorValid(s,this.configuration.hostnames)){const t=this.buildProductFromAnchor(s);this.ud({products:[t],anchors:[s]})}else vt(s)&&this.collectProductsAndAnchors(s,(t=>{this.ud(t)}))}}ad(t){const{shadowRoot:e}=t;this.collectProductsAndAnchors(e,(t=>{this.ud(t)})),this.ks.observe(e,this.td)}ud(t){t.products.length>0&&this.nd(t)}sd(){this.ks.observe(document,this.td),this.Ni(document)}Ni(t){const e=vs.getAllShadowHosts(t);csArray.prototype.forEach.call(e,(t=>{csElementshadowRoot.apply(t)&&this.ks.observe(csElementshadowRoot.apply(t),this.td)}))}}class Bo{constructor(t=Bo.ld){this.dd=[],this.wd=[],this.pd=[],this.md=new Fe(t)}addProducts(t){this.md.addString(csJSON.stringify(t)),csArray.prototype.push.call(this.dd,...t)}addProductExposure(t){this.md.addString(csJSON.stringify(t)),csArray.prototype.push.call(this.wd,t)}addExposedContentItems(t){this.md.addString(csJSON.stringify(t)),csArray.prototype.push.call(this.pd,...t)}reset(){this.md.reset(),this.dd=[],this.wd=[],this.pd=[]}isEmpty(){return 0===this.dd.length&&0===this.wd.length&&0===this.pd.length}isFull(){return this.md.isThresholdReached()}getProducts(){return this.dd}getProductsExposure(){return this.wd}getExposedContentItems(){return this.pd}}Bo.ld=10240;class Ho{static create(t,e){if(!Ho.isSupported())throw new Error("IntersectionObserver is not supported");if(e&&e.delay&&e.delay<100)throw new Error("Visibility delay should be > 100ms");return(null==e?void 0:e.trackVisibility)&&(t=Ho.Ed(t)),new IntersectionObserver(t,e)}static isSupported(){return!!window.IntersectionObserver&&!!window.IntersectionObserverEntry}static Ed(t){return(e,s)=>t(function(t,e){const s=t.length,i=new csArray(s);for(let n=0;n<s;n+=1)i[n]=e(t[n]);return i}(e,Fo),s)}}function Fo(t){return t.isVisible||!Ts.isVisibleInViewportInForeground(t.target)?t:{boundingClientRect:t.boundingClientRect,intersectionRatio:t.intersectionRatio,intersectionRect:t.intersectionRect,isIntersecting:t.isIntersecting,rootBounds:t.rootBounds,target:t.target,time:t.time,isVisible:!0}}class qo{constructor(t){this.ii=t,this.yd=[],this.Ad=new Set}observe(t,e){if(!t.getRootNode())throw new Error("Node has no root node");if(this.Ad.has(t))return;this.Ad.add(t);const s=!!(null==e?void 0:e.subtree),i=()=>this.ii(t),n=t.parentElement||t.getRootNode(),r=Ts.getAncestors(t,s),o=new Set(r),a=new csMutationObserver((e=>{setTimeout((()=>{for(const s of e)if(o.has(s.target)&&Ue(s.removedNodes,(t=>o.has(t))))return i(),a.disconnect(),void this.Ad.delete(t)}))}));if(s)for(const t of r)csArray.prototype.includes.call([11,9],t.nodeType)&&a.observe(t,{childList:!0,subtree:!0});else a.observe(n,{childList:!0});csArray.prototype.push.call(this.yd,(()=>{a.disconnect()}))}disconnect(){xe(this.yd,(t=>t())),this.yd=[],this.Ad.clear()}}class Go{constructor(t){this.gd=new Set,this.vd=new qo((t=>this._d(t))),this.Ms=!1,this.Ka=t?{...Zo,...t}:Zo}stop(){this.Ms=!1,this.Rd.disconnect(),this.ks.disconnect()}start(t){if(this.Ms)throw new Error("VisibilityObserver is already started");this.ii=t;this.Rd=Ho.create((t=>this.handleIntersection(t)),{root:null,rootMargin:"0px",threshold:.5,trackVisibility:!0,delay:300}),this.ks=new gs((t=>setTimeout((()=>{xe(t,(t=>this._d(t.target)))})))),this.wo(),this.Ms=!0}observe(t){if(!this.Ms)throw new Error("Observer is stopped.");t[this.Sd]||(t[this.Sd]=!0,this.watchIntersection(t))}wo(){this.Td=ls("isVisible"),this.Sd=ls("ObservedElement"),this.Id=ls("LinkedElement"),this.Pd=ls("Tracked")}_d(t){this.gd.add(t);for(const e of this.bd(t))this.gd.add(e);this.recheckCssVisibilityAll()}recheckCssVisibilityAll(){xe(this.gd.keys(),(t=>{t.isConnected&&!Ts.areAncestorsHiddenByCSS(t)&&t[this.Sd]&&this.watchIntersection(t)})),this.gd.clear()}watchIntersection(t){this.ks.unobserve(t),this.Rd.unobserve(t);const e=Ts.getTopAncestorHiddenByCSS(t);e?(e!==t&&(this.Vd(e,t),this.watchMutation(e)),this.watchMutation(t)):this.Rd.observe(t)}watchMutation(t,e=!0){e&&delete t[this.Td],this.Rd.unobserve(t),this.ks.observe(t,{attributeFilter:["style","class","hidden"]})}handleIntersection(t){for(const e of t){const t=e.target;if(!e.isVisible){switch(Ts.isVisibleInDocument(t)?Yo.VisibleOutsideViewPort:e.isIntersecting?Yo.HiddenByAnother:Yo.Hidden){case Yo.Hidden:case Yo.HiddenByAnother:this.Cd(t);break;case Yo.VisibleOutsideViewPort:this.onVisibilityChanged(e.target,Yo.VisibleOutsideViewPort)}continue}const s=null===e.target[this.Td];e.target[this.Td]=!0,s&&!this.Ka.delay&&this.onVisibilityChanged(e.target,Yo.VisibleInViewPort)}this.Ka.delay&&setTimeout((()=>{for(const e of t){const t=e.isIntersecting&&e.isVisible;e.target[this.Td]&&t&&this.onVisibilityChanged(e.target,Yo.VisibleInViewPort)}}),this.Ka.delay)}Cd(t){const e=Ts.getTopElement(t);this.watchMutation(t),e&&(this.vd.observe(e),this.Vd(e,t),this.watchMutation(e,!1))}Vd(t,e){var s;(t[this.Id]=null!==(s=t[this.Id])&&void 0!==s?s:new Set).add(e)}bd(t){var e,s;const i=[];return xe(null!==(s=null===(e=t[this.Id])||void 0===e?void 0:e.values())&&void 0!==s?s:[],(t=>csArray.prototype.push.call(i,t))),i}onVisibilityChanged(t,e){if(e===Yo.VisibleInViewPort&&this.Ka.trackOnce){if(this.Rd.unobserve(t),this.ks.unobserve(t),t[this.Pd])return;t[this.Pd]=!0}this.ii(t,e)}static isSupported(){return Ho.isSupported()}}var Yo;as([Yt()],Go.prototype,"observe",null),as([Ee({wait:50}),Yt()],Go.prototype,"recheckCssVisibilityAll",null),as([Yt()],Go.prototype,"watchIntersection",null),as([Yt()],Go.prototype,"watchMutation",null),as([Yt()],Go.prototype,"handleIntersection",null),as([Yt()],Go.prototype,"onVisibilityChanged",null),function(t){t.VisibleInViewPort="VisibleInViewPort",t.VisibleOutsideViewPort="VisibleOutsideViewPort",t.HiddenByAnother="HiddenByAnother",t.Hidden="Hidden"}(Yo||(Yo={}));const Zo={delay:1e3,trackOnce:!0};class jo extends Ze{constructor(t,e,s,i=new Go){super(),this.Nd=t,this.hr=e,this.$=s,this.Od=i}onProductExposed(t){this.kd=t}clearState(){Go.isSupported()&&this.isStarted&&this.$d()}onStart(){Go.isSupported()&&(this.Ld=new Map,this.xd())}onStop(){Go.isSupported()&&(this.$d(),this.Od.stop(),this.Ld.clear())}xd(){try{this.Od.start(((t,e)=>{e===Yo.VisibleInViewPort?this.Md(t):this.Dd(t)}))}catch(t){return void qt.error(t)}this.Nd.onElementAvailable((t=>this.hr.schedule((()=>this.Od.observe(t)))))}$d(){this.Ld.forEach(((t,e)=>{this.Dd(e)})),this.Ld.clear()}Md(t){this.Ld.set(t,ht())}Dd(t){const e=this.Ld.get(t);if(void 0===e)return;const s=ht()-e;this.Ld.delete(t),s<jo.EXPOSURE_DURATION_THRESHOLD||this.kd(this.Ud(t,s))}Ud(t,e){const{href:s}=t;return{targetPath:V.getElementPath(t,{dynamicIdRegex:this.$.dynamicIdRegex}),duration:e,href:s}}}jo.EXPOSURE_DURATION_THRESHOLD=150;class Xo{constructor(t){this.ii=t}push(t){this.zd||(this.zd=[],setTimeout((()=>this.flush()))),csArray.prototype.push.call(this.zd,t)}flush(){csArray.prototype.forEach.call(this.zd,this.ii),this.zd=void 0}}Zt([Yt("MicrotaskBuffer.flush")],Xo.prototype,"flush",null);class Ko{constructor(){this.zd=new Xo((t=>t.isConnected&&this.Fd&&this.Fd(t)))}onElementAvailable(t){this.Fd=t}pushProduct(t){this.zd.push(t)}*getElements(t){}}class Qo{constructor(t,e,s,i){this.ie=t,this.Bd=e,this.xl=s,this.Hd=i}initStates(){this.qd()}clearState(){this.ie.removeQueryParams()}send(t){this.jd(t)}sendBeacon(t){this.Gd(t)}qd(){const t=this.Hd.getRequestParameters();this.ie.setQueryParams(t),this.Bd.setQueryParams(t)}jd(t){this.ie.send(t),this.xl.reset()}Gd(t){this.Bd.send(csJSON.stringify(t)),this.xl.reset()}}const Jo="display";class ta{constructor(t,e,s,i,n,r,o,a,h){this.$=t,this.Uu=e,this.Jc=s,this.Bo=i,this.rs=n,this.X=r,this.Ca=o,this.Wc=a,this.hr=h}init(){const t=new vi(this.hr),e=new Wo(this.$,this.Uu,t),s=new os,i=new Bo,n=new Ko,r=new jo(n,this.hr,this.$),o=new Qo(this.Jc.create(`${this.$.getTrackerUri()}/${Jo}`,!0,"base64"),new Ri(`${this.$.getTrackerUri()}/${Jo}`),i,new ii(this.Bo,this.rs));this.Zd=new $o(this.X,e,s,o,i,r,n,this.Ul),this.Zd.init(),this.Ca.addListener(this.Zd)}onStartTracking(){this.Mi()&&(this.Zd.start(),this.Zd.collectInitialProducts())}onArtificialPageViewEnd(){this.Zd.clearState()}onAfterNaturalPageView(){this.Zd.initStates()}onAfterArtificialPageView(){this.Zd.initStates(),this.Zd.collectInitialProducts(),this.Zd.startDisplayAdExposureTracking()}onBeforeSessionRenewal(){this.Zd.clearState(),this.Zd.stop()}onOptout(){this.Zd.stop()}Mi(){return!!window.IntersectionObserver}}var ea,sa;function ia(t){return t.tagDeploymentMode===ea.DualCollectionReview||t.tagDeploymentMode===ea.DualCollection}Zt([Ce("Emerch.onStartTracking")],ta.prototype,"onStartTracking",null),function(t){t.ContentSquare="CONTENTSQUARE",t.LoadedByClicktale="LOADED_BY_CLICKTALE",t.LoadClicktalePtc="LOAD_CLICKTALE_PTC",t.DualCollectionReview="DUAL_COLLECTION_REVIEW",t.DualCollection="DUAL_COLLECTION",t.ContentSquareTagClickTaleEndpoints="CONTENTSQUARE_TAG_CLICKTALE_ENDPOINTS"}(ea||(ea={})),function(t){t.isRecording=function(){return window.ClickTaleIsRecording&&window.ClickTaleIsRecording()},t.stopRecording=function(){window.ClickTaleStop&&window.ClickTaleStop()},t.triggerLogicalPageView=function(t){window.ClickTaleLogicalWithUploadPage&&window.ClickTaleLogicalWithUploadPage(t)},t.sendPageEvent=function(t){window.ClickTaleEvent&&window.ClickTaleEvent(t)},t.sendEventTriggerRecording=function(t){window.ClickTaleEventTrigger&&window.ClickTaleEventTrigger(t)}}(sa||(sa={}));class na extends Ze{constructor(t,e,s,i,n){super(),this.$=t,this.Wd=e,this.Zc=s,this.Kd=i,this.Yd=n,this.Qd=[],this.Se=[]}onStart(){csArray.prototype.forEach.call(this.Qd,(t=>this.trackPageEvent(t))),this.Qd=[],csArray.prototype.forEach.call(this.Se,(t=>this.trackEventTriggerRecording(t))),this.Se=[]}onStop(){}trackPageEvent(t){this.isStarted?na.Jd(t)&&(this.Xd(t)?this.Yd.isSupported()&&this.tf(t):this.sf(t)):csArray.prototype.push.call(this.Qd,t)}Xd(t){return H(t,"@user-identifier@")}async tf(t){if(!this.$.customHashIdEnabled)return;const e=csString.prototype.slice.call(t,17);if(!this.Yd.isValidInput(e))return void qt.warn("UserIdentifier event: invalid user identifier");const s=await this.Yd.digest(e,this.$.projectId);s?(this.if={eventName:s,isETR:!1,isCustomHashId:!0},this.ef()):qt.warn("Page event: unable to compute customHashId"),this.$.encryptionEnabled&&this.Kd.emitUserIdentifierEvent(e)}sf(t){this.Kd.emitPageEvent(t),this.if={eventName:t,isETR:!1,isCustomHashId:!1},this.ef(),this.$.tagDeploymentMode===ea.LoadClicktalePtc&&sa.sendPageEvent(t)}trackEventTriggerRecording(t){this.isStarted?na.Jd(t)&&(this.$.malkaEtrEnabled?this.nf(t):this.rf(t)):csArray.prototype.push.call(this.Se,t)}nf(t){H(t,"@ETP@")?this.Kd.emitEventTriggerRecording(t,Ke.ETR_PAGE):this.Kd.emitEventTriggerRecording(t,Ke.ETR_SESSION),this.if={eventName:t,isETR:!0,isCustomHashId:!1},this.ef()}rf(t){var e;(ia(e=this.$)||e.tagDeploymentMode===ea.LoadClicktalePtc)&&(this.Kd.emitEventTriggerRecording(t,Ke.ETR_LEGACY),this.if={eventName:t,isETR:!0,isCustomHashId:!1},this.ef(),this.$.tagDeploymentMode===ea.LoadClicktalePtc&&sa.sendEventTriggerRecording(t))}getRequestParameters(){return{value:this.Zc.compressSync(this.if.eventName,"base64"),ct:this.Zc.algorithm,isETR:`${this.if.isETR}`,isCustomHashId:`${this.if.isCustomHashId}`}}ef(){this.Wd.send()}static Jd(t){return mt(t)&&!!csString.prototype.trim.call(t)}}const ra=["trackPageEvent"],oa=["trackEventTriggerRecording"];class aa{constructor(t,e,s,i,n){this.$=t,this.Wc=e,this.Zc=s,this.jo=i,this.Kd=n}init(){const t=new J(this.$.getTrackerUri(),"pageEvent"),e=new bi(window.crypto);e.init(),this.hf=new na(this.$,t,this.Zc,this.Kd,e),t.setRequestParametersProviders(this.hf,this.jo),this.Wc.register(ra,(t=>{this.hf.trackPageEvent(t)})),this.Wc.register(oa,(t=>{this.hf.trackEventTriggerRecording(t)}))}onStartTracking(){this.hf.start()}}const ha=document.createElement("div");function ca(t){if(!t||!mt(t))return qt.warn(`isValidSelector: invalid selector provided '${t}'`),!1;try{return I.call(ha,t),!0}catch{return qt.warn(`isValidSelector: invalid selector provided '${t}'`),!1}}const la=["#c1_card_info_id"];var ua,da;!function(t){t[t.Sensitive=1]="Sensitive",t[t.SensitiveChild=2]="SensitiveChild"}(ua||(ua={}));class pa{constructor(t){this.$=t,this.cf=["value","checked","src","data","alt"],this.af=["[data-cs-mask]","script",...la],this.uf=[{selector:"input:not([type=button]):not([type=submit])",attrName:"value"}],this.lf={PIISelectors:[".ctHidden, textarea","#c1_card_info_id",...la],Attributes:[{selector:".ctHidden, input:not([type=button]):not([type=submit])",attrName:"value"}]},this.df=[],this.ff="",this.wf=()=>{},ia(this.$)||(this.ff=this.pf(this.ff,this.af),csArray.prototype.push.call(this.df,...this.uf)),this.mf=this.Ef()}Ef(){if(window.ResizeObserver)return new ResizeObserver((t=>{csArray.prototype.forEach.call(t,(t=>{this.wf(t)}))}))}setPIISelectors(t){var e;if(t){if(null===(e=t.PIISelectors)||void 0===e?void 0:e.length){const e=csArray.prototype.filter.call(t.PIISelectors,(t=>ca(t)));this.ff=this.pf(this.ff,e)}t.Attributes instanceof Array&&csArray.prototype.forEach.call(t.Attributes,(t=>{t&&t.attrName&&ca(t.selector)&&!this.yf(t)&&csArray.prototype.push.call(this.df,t)}))}}getPIISelectors(){return{PIISelectors:[this.ff],Attributes:this.df}}initCTPII(){var t,e;if(this.ff=this.pf(this.ff,this.lf.PIISelectors),!(null===(e=null===(t=null===window||void 0===window?void 0:window.ClickTaleSettings)||void 0===t?void 0:t.DOM)||void 0===e?void 0:e.PII))return;const s=csArray.prototype.filter.call(window.ClickTaleSettings.DOM.PII.Text,(t=>ca(t)));this.ff=this.pf(this.ff,s),csArray.prototype.push.call(this.df,...this.lf.Attributes),csArray.prototype.forEach.call(window.ClickTaleSettings.DOM.PII.Attributes,(t=>{t.attr&&ca(t.rule)&&csArray.prototype.push.call(this.df,{selector:t.rule,attrName:t.attr})}))}isSensitiveAttribute(t,e){return this.isSensitive(t)&&-1!==csArray.prototype.indexOf.call(this.cf,e)||this.Af(t,e,this.df)}isSensitive(t){return t.__contentsquare_sensitive===ua.Sensitive}isSensitiveChild(t){return t.__contentsquare_sensitive===ua.SensitiveChild}identifySensitiveNodes(t){if(!c(t)&&!R(t))return;this.gf(t);const e=vs.getAllShadowHosts(t);csArray.prototype.forEach.call(e,(t=>csElementshadowRoot.apply(t)&&this.gf(csElementshadowRoot.apply(t))))}unidentifySensitiveNodes(t){if(!c(t)&&!R(t))return;this.vf(t);const e=vs.getAllShadowHosts(t);csArray.prototype.forEach.call(e,(t=>csElementshadowRoot.apply(t)&&this.vf(csElementshadowRoot.apply(t))))}onSensitiveElementResize(t){this.wf=t}disconnectResizeObserver(){var t;null===(t=this.mf)||void 0===t||t.disconnect()}vf(t){const e=document.createNodeIterator(t,NodeFilter.SHOW_ELEMENT,null,!1);let s;for(;s=e.nextNode();)"__contentsquare_sensitive"in s&&delete s.__contentsquare_sensitive}gf(t){if(this._f(t))return this.Rf(t),void this.Sf(t);this.Tf(t,this.ff)?(this.If(t),this.Sf(t)):xe(window.csquerySelectorAll[t.nodeType].call(t,this.ff),(t=>{this.If(t),this.Sf(t)}))}If(t){t.__contentsquare_sensitive=ua.Sensitive,this.Pf(t)}Pf(t){this.mf&&c(t)&&!S(t)&&this.mf.observe(t)}Rf(t){t.__contentsquare_sensitive=ua.SensitiveChild}Sf(t){const e=document.createNodeIterator(t,NodeFilter.SHOW_ELEMENT,null,!1);let s=e.nextNode();for(t===s&&(s=e.nextNode());s;)this.Rf(s),s=e.nextNode()}_f(t){return!(!csNodeparentNode.apply(t)||!c(csNodeparentNode.apply(t))&&!R(csNodeparentNode.apply(t))||!this.isSensitive(csNodeparentNode.apply(t))&&!this.isSensitiveChild(csNodeparentNode.apply(t)))||T(t)&&(this.isSensitive(t.host)||this.isSensitiveChild(t.host))}Tf(t,e){return c(t)&&I.call(t,e)}Af(t,e,s){return csArray.prototype.some.call(s,(s=>t.hasAttribute(e)&&csString.prototype.indexOf.call(s.attrName,e)>-1&&I.call(t,s.selector)))}pf(t,e){if(0===e.length)return t;if(0===t.length)return csArray.prototype.join.call(e,",");const s=csString.prototype.split.call(t,",");for(const t of e){const e=csString.prototype.split.call(t,",");for(const t of e)-1===csArray.prototype.indexOf.call(s,t)&&csArray.prototype.push.call(s,t)}return csArray.prototype.join.call(s,",")}yf(t){return csArray.prototype.some.call(this.df,(e=>e.selector===t.selector&&e.attrName===t.attrName))}}class ga{constructor(t){this.Wc=t}init(){this.bf(ga.Vf,At),this.bf(ga.Cf,Rt)}bf(t,e){this.Wc.register([t],((t,s)=>{mt(t)&&(mt(s)||wt(s))&&qt.error(s,`${e}${t}`)}))}}ga.Cf="logSnippetError",ga.Vf="logImplementationSnippetError";class ma{constructor(t,e,s,i){this.$=t,this.Pa=e,this.Gc=s,this.Ca=i}init(){this.Pa.onChildMessage(((t,e,s)=>this.Ca.emitIframeEvent(t,e,s))),this.Pa.setRecordingStatusCallback((()=>this.Gc.getRecordingStatus()))}onStartTracking(){this.$.iframesTracking&&this.Pa.start()}onOptout(){this.$.iframesTracking&&this.Pa.stop()}onRecordingStatusChange(){this.$.iframesTracking&&this.Pa.onRecordingStatusChange(this.Gc.getRecordingStatus())}}class fa extends Ze{constructor(t,e){super(),this.$=t,this.us=e,this.Nf=0,this.Of=new Map,this.kf={boundElement:window,type:"message",listener:t=>this.$f(t)}}onChildMessage(t){this.Lf=t}setRecordingStatusCallback(t){this.xf=t}onRecordingStatusChange(t){const e=Wt.buildBaseMessage(Vt.RecordingStatus,zt.Parent,this.$.projectId);e.content=t,this.Of.forEach((t=>{!this.Mf(t)&&t.port&&Wt.sendChannelMessage(t.port,e)}))}sendToChildren(t,e){const s=Wt.buildBaseMessage(t,zt.Parent,this.$.projectId);s.content=e,this.Df(s)}onStart(){ge(this.kf,!1),this.Uf()}onStop(){this.zf(),me(this.kf,!1),this.Ff()}Uf(){const t=this.Bf();this.Hf(t),csArray.prototype.forEach.call(t,(t=>{if(null===this.qf(t)){const e={iframe:t};this.Of.set(this.Nf,e),this.Nf+=1}})),this.jf()}Bf(){return csArray.prototype.filter.call(Ts.findAllElements("iframe"),(t=>this.Gf(t)))}Hf(t){this.Of.forEach(((e,s)=>{e.iframe&&-1===csArray.prototype.indexOf.call(t,e.iframe)&&this.Zf(s,e)}))}Zf(t,e){e.port&&Wt.closeChannelPort(e.port),this.Of.delete(t)}Ff(){this.Of.forEach((t=>{t.port&&Wt.closeChannelPort(t.port)})),this.Of.clear()}qf(t){let e=null;return this.Of.forEach(((s,i)=>{null===e&&s.iframe===t&&(e=i)})),e}Gf(t){return t.id!==s&&(!t.src||Dt(Lt(t.src),this.$.hostnames))}Df(t){this.Of.forEach((e=>{e.port&&Wt.sendChannelMessage(e.port,t)}))}jf(){this.Of.forEach(((t,e)=>{if(t.iframe.contentWindow){const s=this.Wf(e);Wt.sendPostMessage(t.iframe.contentWindow,"*",s)}}))}zf(){const t=this.Kf();this.Of.forEach((e=>{e.port?Wt.sendChannelMessage(e.port,t):e.iframe.contentWindow&&Wt.sendPostMessage(e.iframe.contentWindow,"*",t)}))}Wf(t){return Wt.buildBaseMessage(Vt.Discovery,zt.Parent,this.$.projectId,t)}Kf(){return Wt.buildBaseMessage(Vt.Stop,zt.Parent,this.$.projectId)}Yf(t,e){const s=this.Of.get(t);void 0!==s?(s.port=e,s.port.onmessage=t=>{this.Qf(t,s)}):qt.error(`Parent received channel messaging initialization from unknow child id : ${t} (${this.Nf})`)}Jf(t){if(!t.port)return;const e=Wt.buildBaseMessage(Vt.RecordingStatus,zt.Parent,this.$.projectId),s=this.xf();this.Mf(t)&&(s.isRecording=!1,s.isMutationTrackerStarted=!1),e.content=s,Wt.sendChannelMessage(t.port,e)}Qf(t,e){if(void 0===e)return void qt.error(`Parent received channelMessage from unknown child : ${csJSON.stringify(t.data)}`);const s=t.data.type,i=t.data.content;s===Vt.EndOfBufferedMessages?this.Jf(e):this.Lf(e.iframe,s,i)}$f(t){if(Wt.isMessageValid(t,zt.Child,this.$.projectId,this.$.hostnames))switch(t.data.type){case Vt.Discovery:if(void 0===t.data.id)return void this.Uf();if(t.ports&&1===t.ports.length&&this.Of.has(t.data.id))return void this.Yf(t.data.id,t.ports[0]);qt.error(`Parent received wrong channelMessage initialization : (${t.origin}) : ${csJSON.stringify(t.data)}`);break;case Vt.ChildLogMessage:this.Lf(null,Vt.ChildLogMessage,t.data.content);break;default:qt.warn(`Parent received unexpected postMessage type from child (${t.origin}) : ${csJSON.stringify(t.data)}`)}}Mf(t){return this.us.isSensitive(t.iframe)||this.us.isSensitiveChild(t.iframe)}}class ya{compute(t,e){const s=this.Xf(e.x)-this.Xf(t.x),i=this.Xf(e.y)-this.Xf(t.y),n=e.time-t.time;return{duration:n,distance:this.tw(s,i),direction:this.iw(s,i),velocity:this.ew(s,i,n)}}computePinchMetrics(t,e){const s=this.Xf(e.x)-this.Xf(t.x),i=this.Xf(e.y)-this.Xf(t.y);return{duration:e.time-t.time,distance:this.tw(s,i)}}getScale(t,e){return Math.abs(e/t-1)}Xf(t){return t/window.devicePixelRatio}tw(t,e){return Math.round(Math.sqrt(t*t+e*e))}ew(t,e,s){const i=s/1e3,n=t/i,r=e/i;return Math.round(Math.abs(n)+Math.abs(r))}iw(t,e){return Math.abs(t)>Math.abs(e)?t>0?ui.RIGHT:ui.LEFT:e>0?ui.DOWN:ui.UP}}class Ea{constructor(){this.nw={},this.rw=new ya,this.hw()}onGesture(t){this.ow=t}isValidTouchEvent(t){return"touches"in t&&"changedTouches"in t}processActionDown(t){if(!this.cw(t))return;this.aw(t)&&this.hw();const e={x:t.touches[0].clientX,y:t.touches[0].clientY,time:ht()};if(1===t.touches.length)this.nw.startPinchTime=e.time,this.nw.firstTouch=e;else if(2===t.touches.length&&(this.nw.secondTouch={x:t.touches[1].clientX,y:t.touches[1].clientY,time:ht()},this.nw.firstTouch&&this.nw.secondTouch)){const t=this.rw.computePinchMetrics(this.nw.firstTouch,this.nw.secondTouch);this.uw=t.distance}csArray.prototype.push.call(this.lw,e),this.fw=Ne(t)}processActionMove(){this.pw=!0}processActionUp(t){if(this.mw(t)){if(csArray.prototype.push.call(this.lw,{x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY,time:ht()}),this.Ew(t)&&this.nw.startPinchTime){const e={x:t.touches[0].clientX,y:t.touches[0].clientY,time:this.nw.startPinchTime},s={x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY,time:ht()};this.nw.firstTouch&&(this.nw.firstTouch=e,this.nw.secondTouch=s),this.yw(t)}this.uw||this.Aw()&&this.gw(t)}}hw(){this.lw=[],this.fw=null,this.pw=!1,this.uw=null,this._w=!0}gw(t){const e=this.rw.compute(this.lw[0],this.lw[1]);this._w=t.isTrusted;const s=this.pw?this.Rw(e):this.Sw(e);this.ow(s,t)}yw(t){if(!this.nw.firstTouch||!this.nw.secondTouch)return;const e=this.rw.computePinchMetrics(this.nw.firstTouch,this.nw.secondTouch);this._w=t.isTrusted;const s=this.Tw(e);s&&this.ow(s,t)}Tw(t){if(this.uw&&!(this.rw.getScale(this.uw,t.distance)<.1))return{type:this.uw>t.distance?li.PINCH_IN:li.PINCH_OUT,target:this.fw,distance:t.distance,isTrusted:this._w}}Rw(t){return{type:t.velocity<100?li.DRAG:li.FLICK,target:this.fw,velocity:t.velocity,distance:t.distance,direction:t.direction,isTrusted:this._w}}Sw(t){return{type:t.duration<1e3?li.TAP:li.LONG_PRESS,target:this.fw,isTrusted:this._w}}aw(t){return 1===t.touches.length}Aw(){return 2===this.lw.length}cw(t){return t.touches.length>0}mw(t){return t.changedTouches.length>0}Ew(t){return this.pw&&!!this.uw&&1===t.changedTouches.length&&1===t.touches.length}}class Sa{constructor(){this.subscriptions={}}subscribe(t,e){this.subscriptions[t]=e,1===Object.keys(this.subscriptions).length&&this.onStartTracking()}unsubscribe(t){delete this.subscriptions[t],0===Object.keys(this.subscriptions).length&&this.onStopTracking()}}class va extends Sa{constructor(t){super(),this.Iw=t,this.Nn=[{boundElement:document,type:"touchstart",listener:t=>this.$e(t)},{boundElement:document,type:"touchmove",listener:t=>this.$e(t)},{boundElement:document,type:"touchend",listener:t=>this.$e(t)}],this.Pw=new Ea,this.Pw.onGesture(((t,e)=>this.bw(t,e)))}bw(t,e){for(const s in this.subscriptions)(0,this.subscriptions[s])(t,e)}onStartTracking(){this.canDetectGesture()&&csArray.prototype.forEach.call(this.Nn,(t=>ge(t)))}onStopTracking(){this.canDetectGesture()&&csArray.prototype.forEach.call(this.Nn,(t=>me(t)))}canDetectGesture(){return void 0!==window.devicePixelRatio}$e(t){this.Iw.tryToExecute("process gesture event",(()=>{if(this.Pw.isValidTouchEvent(t))switch(t.type){case"touchstart":this.Pw.processActionDown(t);break;case"touchmove":this.Pw.processActionMove();break;case"touchend":this.Pw.processActionUp(t)}}))()}static isSwipe(t){return t.type===li.FLICK||t.type===li.DRAG}}class wa extends Ze{constructor(t,e){super(),this.ie=t,this.Vw=e,this.Cw=0}onStart(){qt.isPerfLoggingActive()&&(this.Nw=window.setInterval((()=>this.Ow()),wa.kw))}onStop(){qt.isPerfLoggingActive()&&(this.Ow(),clearInterval(this.Nw))}Ow(){if(we.isEmpty()||this.Cw>=wa.$w)return;const t=we.getAll();this.Cw++;const e={a:wa.Lw,l:wa.xw,...this.Vw.getRequestParameters()},s=csArray.prototype.map.call(t,(t=>({...t,...e})));this.ie.send(s),we.clear()}}wa.Lw="uxa",wa.xw="perf",wa.kw=5e3,wa.$w=5;class Ra{constructor(t,e,s){this.$=t,this.Vw=e,this.Jc=s}init(){this.Mw=new wa(this.Jc.create(this.$.getLoggerUri(),!0),this.Vw)}onStartTracking(){this.Mw.start()}onOptout(){this.Mw.stop()}}class Aa{constructor(){this.Dw=!1}enableRecordingStatus(t,e,s,i,n,r){this.Dw=!0,this.kn=t,this.us=e,this.$n=s,this.ia=i,this.W=n,this.se=r}getRecordingStatus(){var t,e,s,i;return this.Dw?{isRecording:this.kn.isRecording(),isMutationTrackerStarted:this.kn.isMutationTrackerStarted(),PIISelectors:this.us.getPIISelectors(),capturedElementSelector:this.ia.getWhitelistedElementsSelector(),useAnonymization:this.$n.shouldUseAnonymization(),encryptionSelectors:null===(t=this.se)||void 0===t?void 0:t.getEncryptionSelectors(),activateOnlineAssetsOnNextStart:null===(e=this.kn.getStaticResourceManagerStatus())||void 0===e?void 0:e.onlineAssets.enabledForChildrenOnNextStart,recordingStartTimestamp:parseInt(this.kn.getRecordingStartTimestamp(),10),etrState:null!==(i=null===(s=this.W.getSession())||void 0===s?void 0:s.etrState)&&void 0!==i?i:Xe.ETR_OFF}:{isRecording:!1,recordingStartTimestamp:0,etrState:Xe.ETR_OFF}}}class Ta{constructor(){this.Uw=mo.Natural}setPageViewType(t){this.Uw=t}getPageViewType(){return this.Uw}getRequestParameters(){return{pvt:this.Uw}}}class _a{constructor(t){this.Yi=t}onAfterVisitorRenewal(){this.Yi.startNewSession()}}class ba{constructor(t,e,s,i,n,r,o,a,h,c,l,u,d,p,g,m,f,y,E,S,v,w,R,A,T){this.Bo=t,this.Zc=e,this.Z=s,this.W=i,this.Ls=n,this.Wc=r,this.zw=o,this.$=a,this.Fw=h,this.Bw=c,this.Hw=l,this.Hh=u,this.L=d,this.Uu=p,this.Xc=g,this.X=m,this.qw=f,this.Kd=y,this.Ca=E,this.rs=S,this.jw=v,this.Qc=w,this.Gw=R,this.hr=A,this.Jc=T,this.Zw=(t=!1)=>{this.Ww.start(t),this.Kw.start()}}start(){if(this.Fw.init(),this.Bw.init(),this.Bw.isActive())return;let t,e,s,i,n,r,o,a,h,c,l,u,d,p,g;this.hr.schedule((()=>{u=new Uo(this.W,this.Z),g=new _a(u),l=new No(this.Uu),p=new va(qt),t=new go(this.$,this.Bo,this.Z,this.Uu,l,this.Wc,u,p,this.Ca,this.Jc),e=new Wn(this.Wc,this.W,this.$,this.Bo,this.Zc,this.L),d=new pa(this.$),c=new Aa;const m=new fa(this.$,d);h=new ma(this.$,m,c,this.Ca),h.init();const f=new Ta;s=new xn(this.Z,this.W,this.Wc,this.Ca,m,this.$,f,c),i=new Xn(this.$,this.Bo,this.Z,this.Wc,this.L,u,this.X),this.Ww=new Co(this.$,this.Wc,this.Ls,this.Bo,this.Z,this.W,this.Hh,this.rs,this.Xc,this.X,this.Qc,f),n=new xo(this.$,this.Z,this.W,this.Wc),r=new aa(this.$,this.Wc,this.Zc,this.Bo,this.Kd),o=new ga(this.Wc),a=new Ra(this.$,new dt(this.$,this.L),this.Jc),this.Kw=new Oo})),this.hr.schedule((()=>{this.Hw.init()})),this.hr.schedule((()=>{s.init()})),this.hr.schedule((()=>{e.init()})),this.hr.schedule((()=>{i.init()})),this.hr.schedule((()=>{this.jw.init()})),this.hr.schedule((()=>{this.Ww.init()})),this.hr.schedule((()=>{n.init()})),this.hr.schedule((()=>{r.init()})),this.hr.schedule((()=>{this.qw.init()})),this.hr.schedule((()=>{o.init()})),this.hr.schedule((()=>{a.init()})),this.hr.schedule((()=>{this.Gw.init()})),this.hr.schedule((()=>{this.Ls.addListener(n),this.Ls.addListener(this.zw),this.Ls.addListener(t),this.Ls.addListener(this.Hw),this.Ls.addListener(s),this.Ls.addListener(this.jw),this.Ls.addListener(this.Ww),this.Ls.addListener(r),this.Ls.addListener(e),this.Ls.addListener(h),this.Ls.addListener(a),this.Ls.addListener(g)})),en.isRecordingSupported()&&this.hr.schedule((()=>{const t=new An(c,this.W,this.$,this.Zc,this.Hh,this.Bo,this.Wc,this.L,u,this.X,d,this.Qi,this.Ji,this.Xi,p,this.te,this.Ls,this.Kd,this.Ca,this.Qc,this.hr,this.Jc,this.Xc);t.init(),this.Ls.addListener(t),s.setRecordingService(t.recordingService)})),this.$.eMerchandisingEnabled&&this.hr.schedule((()=>{const t=new ta(this.$,this.Uu,this.Jc,this.Bo,this.rs,this.X,this.Ca,this.Wc,this.hr);t.init(),this.Ls.addListener(t)})),this.hr.schedule((()=>{t.init()})),this.hr.schedule((()=>{u.onSessionExpired((()=>{this.Ls.emitBeforeSessionRenewal(),this.Yw(!0),this.Ls.emitAfterSessionRenewal()})),this.Yw()}))}Yw(t=!1){this.Wc.start(),this.Kw.onLoad((()=>{this.Ls.emitStartTracking(t)})),ia(this.$)&&!t||this.Zw(t)}}class Ca{constructor(t,e,s,i,n,r,o,a){this.$=t,this.Z=e,this.ns=s,this.Qw=i,this.Jw=n,this.Xw=r,this.tp=o,this.sp=a}compute(t){var e,s;this.$.crossDomainTracking&&!this.$.cookielessTrackingEnabled?this.$.crossDomainSingleIframeTracking?null===(e=this.tp)||void 0===e||e.start((()=>this.ip(t))):null===(s=this.Xw)||void 0===s||s.applyUpToDate((()=>this.ip(t))):this.ip(t)}ip(t){this.Jw.handle(),this.Qw.clear(),this.ep()?(this.Qw.restoreClearedVisitor(),t(!0)):(this.ns.exclude(this.$),t(!1))}ep(){const t=q.boolean(this.$.sampleRate);return this.sp.isForceIncluded()||!this.ns.isExcluded()&&this.Z.doesVisitorExist()||!this.ns.isExcluded()&&t}}!function(t){t.generate=function(){const t=navigator.userAgent+navigator.language+navigator.platform,e=csString.prototype.slice.call(function(t){let e=0;for(let s=0;s<t.length;s+=1)e=csString.prototype.charCodeAt.call(t,s)+(e<<6)+(e<<16)-e;return Math.abs(e)}(t).toString(16),-4);let s=(new csDate).getTime();const i="xxxxxxxx-hhhh-axxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const e=(s+16*Math.random())%16|0;return s=Math.floor(s/16),("x"===t?e:7&e|8).toString(16)}));return csString.prototype.replace.call(i,"hhhh",e)}}(da||(da={}));class Na{constructor(t,e,s,i){this.$=t,this.np=e,this.W=s,this.Ls=i,this.rp=1e4}createOrUpdateVisitor(){let t=this.getVisitor();null===t&&(t=this.hp(),this.W.removeSession()),this.op(t),this.setVisitor(t)}hp(){return{id:da.generate(),visitsCount:0,appliedTrackingDraw:this.$.lastTrackingDraw,creationTimestamp:ct(),lastVisitTimestamp:0,hitTimestamp:0,expires:ht()+this.$.visitorCookieTimeout,allowSubdomains:this.$.allowSubdomains}}op(t){const e=ct();this.W.doesSessionExist()||(t.visitsCount+=1,t.lastVisitTimestamp=e),t.hitTimestamp=e,t.appliedTrackingDraw=this.$.lastTrackingDraw,this.cp=t.visitsCount}getRequestParameters(){const t=this.getVisitor();return t?{uu:t.id,sn:`${t.visitsCount}`,hd:`${t.hitTimestamp}`}:{}}getVisitor(){return this.np.get()}setVisitor(t){this.np.set(t)}doesVisitorExist(){return null!==this.np.get()}resetVisitor(){this.ap(),this.Ls.emitAfterVisitorCleared()}removeVisitor(){this.np.remove()}hasAllowSubdomainsChanged(){const t=this.getVisitor();return!!t&&t.allowSubdomains!==this.$.allowSubdomains}handleSubdomainChange(){this.np.handleSubdomainChange()}isSessionRenewed(){const t=this.getVisitor();return null!==t&&void 0!==this.cp&&t.visitsCount!==this.cp}up(){return!yt(this.lp)||ht()-this.lp>this.rp}renewVitor(){this.up()?(this.lp=ht(),this.ap(),this.Ls.emitAfterVisitorRenewal()):qt.warn("session:start:newVisitor is trying to renew visitor under time limit")}ap(){this.Ls.emitBeforeVisitorRenewal(),this.removeVisitor()}}const Oa="_cs_s",Ia=18e5,Pa=/^(\d+\.[013567TBW](\.[01])?)(\.\d+)?$/,ka=".";var La,Da;!function(t){t[t.NOT_FOUND=0]="NOT_FOUND",t[t.EXPIRED=1]="EXPIRED",t[t.FOUND=2]="FOUND"}(La||(La={}));class Ma{constructor(t,e,s){this.$=t,this.dp=e,this.fp=s,this.Eo=null,this.wp=!1}get(t){const e=this.getRawSession(t);return this.isValid(e)?Ma.fromString(e):null}getRawSession(t){if(t){const t=this.pp();return Ma.mp(t)}const{sessionString:e,status:s}=this.Ep(),i=Ma.mp(e);if(s!==La.EXPIRED)return i;if(this.$.cookielessTrackingEnabled)return null;const n=this.pp();if(!n)return null;const r=csString.prototype.split.call(n,ka);if(!Ma.yp(r))return n;const o=r[r.length-1],a=parseInt(o,10);return isNaN(a)||this.Ap(a),i}onCookieToSet(t){this.gp=t}onCookieToRemove(t){this.vp=t}set(t,e=18e5){var s;const i=ht()+e;let n=this.toString(t);n+=`${ka}${i}`,this._p(n,i),this.$.cookielessTrackingEnabled?this.fp.setItem(Oa,n):(this.dp.set(Oa,n,e),null===(s=this.gp)||void 0===s||s.call(this,Oa,n,e))}remove(){var t;this.$.cookielessTrackingEnabled?this.fp.removeItem(Oa):(this.dp.delete(Oa),null===(t=this.vp)||void 0===t||t.call(this,Oa)),this.Rp()}handleSubdomainChange(){if(this.$.cookielessTrackingEnabled)return;const t=this.get(!0);t&&(this.$.allowSubdomains?this.dp.delete(Oa,Jt.CURRENT_DOMAIN):this.dp.delete(Oa,this.dp.getRootDomain()),this.set(t))}isValid(t){return null!==t&&Ma.isValidSessionString(t)}toString(t){return csArray.prototype.join.call([t.pageNumber,t.recordingState,t.etrState],ka)}_p(t,e){this.Eo={sessionString:t,expires:e}}Ep(){return this.Eo?this.Eo&&ht()<=this.Eo.expires?{sessionString:this.Eo.sessionString,status:La.FOUND}:{sessionString:this.Eo.sessionString,status:La.EXPIRED}:{sessionString:this.pp(),status:La.NOT_FOUND}}Rp(){this.Eo=null}Ap(t){this.Eo&&(this.Eo.expires=t,this.wp=!0)}isCacheRefreshed(){return this.wp}resetCacheRefreshed(){this.wp=!1}pp(){if(this.$.cookielessTrackingEnabled){const t=this.fp.getItem(Oa);return!t||this.Sp(t)?null:t}const t=this.dp.get(Oa);return!t||this.Sp(t)?null:t}Sp(t){const e=csString.prototype.split.call(t,ka);if(!Ma.yp(e))return!1;const s=parseInt(e[e.length-1],10);return!isNaN(s)&&ht()>s}static yp(t){return 13===t[t.length-1].length}static mp(t){var e;if(!t)return null;const s=null===(e=csString.prototype.match.call(t,Pa))||void 0===e?void 0:e[1];return null!=s?s:null}static fromRawString(t){const e=Ma.mp(t);return null!==e?Ma.fromString(e):null}static fromString(t){var e;const[s,i,n]=csString.prototype.split.call(t,ka);return{recordingState:i,etrState:null!==(e=n)&&void 0!==e?e:Xe.ETR_OFF,pageNumber:parseInt(s,10)}}static isValidSessionString(t){return Pa.test(t)}}!function(t){t[t.NO=0]="NO",t[t.WITHDRAWN=1]="WITHDRAWN",t[t.GRANTED=2]="GRANTED"}(Da||(Da={}));class xa{constructor(t,e){this.Tp=t,this.Ip=e,this.Pp=null,this.bp=0,this.Vp=Da.NO}setDynamicVariablesService(t){this.Cp=t}createOrUpdateSession(){this.Np(),this.Op=ht(),this.bp=0;let t=this.kp();null===t?(t=this.$p(),this.Lp(t),this.xp(t)):(t=this.Ip.sanitizeSessionRecordingState(t),this.Lp(t),t.recordingState=this.Ip.updateRecordingState(t)),this.setSession(t)}grantReplayRecording(t){t.recordingState=this.Ip.getDisabledRecordingState(),t.recordingState=this.Ip.computeInitialRecordingStateFromRecordingConsentGranted(t),this.setSession(t)}grantReplayRecordingBeforeSessionStart(){this.Vp=Da.GRANTED}withdrawnReplayRecording(t){t.recordingState=this.Ip.getConsentWithdrawnRecordingState(),this.setSession(t)}withdrawnReplayRecordingBeforeSessionStart(){this.Vp=Da.WITHDRAWN}xp(t){this.Vp===Da.WITHDRAWN?(t.recordingState=this.Ip.getConsentWithdrawnRecordingState(),this.setSession(t)):this.Vp===Da.GRANTED?t.recordingState=this.Ip.computeInitialRecordingStateFromRecordingConsentGranted(t):t.recordingState=this.Ip.computeInitialRecordingState(t),this.Vp=Da.NO}$p(){return{pageNumber:0,recordingState:this.Ip.getDisabledRecordingState(),etrState:Xe.ETR_OFF}}Lp(t){t.pageNumber+=1}isReplayRecorded(){const t=this.getSession();return!!t&&this.Ip.isReplayRecorded(t)}isTemporarilyRecorded(){const t=this.getSession();return(null==t?void 0:t.recordingState)===je.TEMPORARILY_RECORDED}abortQuotaServiceRequest(){this.Ip.abortQuotaServiceRequest()}getRequestParameters(){const t={},e=this.getSession();return null!==e&&(t.pn=`${e.pageNumber}`),t}getSession(){return this.Tp.get()}kp(){return this.Tp.get(!0)}doesSessionExist(){return null!==this.Tp.get()}setSession(t){this.Tp.set(t)}removeSession(){this.Tp.remove()}getRecordingStates(){const t=this.getSession(),e=[];return t&&(t.recordingState!==je.NOT_RECORDED&&csArray.prototype.push.call(e,t.recordingState),t.etrState===Xe.ETR_ON&&csArray.prototype.push.call(e,je.ETR_SAMPLING)),e}updateRecordingState(t,e){const s=this.getSession();null!==s&&(s.recordingState=t,s.etrState=e,this.setSession(s))}hasValidSession(){const t=this.Tp.getRawSession();return this.Tp.isValid(t)}handleSubdomainChange(){this.Tp.handleSubdomainChange()}pollCacheRefreshEvent(t=!0){const e=this.Tp.isCacheRefreshed();return e&&t&&this.Tp.resetCacheRefreshed(),e}extendSessionPeriodically(){this.Pp||this.Mp()}Mp(){if(this.Dp())return void this.Np();const t=this.getSession();if(null===t)return qt.warn("extendSession is trying to extend an expired session"),void this.Np();this.Tp.set(t,Ia),this.zp(),this.Fp()}Fp(){this.Pp=window.setTimeout((()=>{this.Mp()}),174e4)}Dp(){return 1434e4-(ht()+Ia-this.Op)<0}Np(){this.Pp&&(window.clearTimeout(this.Pp),this.Pp=null)}zp(){this.bp+=1,this.Cp.trackDynamicVariable("session_expiry_update",this.bp)}}class Ua{constructor(t,e,s){this.$=t,this.Z=e,this.ns=s}clear(){this.Bp()&&(this.Hp=this.Z.getVisitor(),this.Z.removeVisitor()),this.qp()&&this.ns.removeExclusion()}Bp(){return this.Z.doesVisitorExist()&&this.Z.getVisitor().appliedTrackingDraw!==this.$.lastTrackingDraw}qp(){return this.ns.getAppliedTrackingDraw()!==this.$.lastTrackingDraw}restoreClearedVisitor(){this.Hp&&this.Z.setVisitor(this.Hp)}}class $a{constructor(t,e,s){this.Z=t,this.W=e,this.jp=s}handle(){this.Z.hasAllowSubdomainsChanged()&&(this.Z.handleSubdomainChange(),this.W.handleSubdomainChange(),this.jp.handleSubdomainChange())}}class za{constructor(){this.listeners=[]}addListener(t){csArray.prototype.push.call(this.listeners,t)}}class Va extends za{constructor(t){super(),this.hr=t}emitBeforeNaturalPageView(){for(const t of this.listeners)t.onBeforeNaturalPageView&&t.onBeforeNaturalPageView()}emitAfterNaturalPageView(){for(const t of this.listeners)t.onAfterNaturalPageView&&t.onAfterNaturalPageView()}emitInitTracking(){for(const t of this.listeners)t.onInitTracking&&t.onInitTracking()}emitStartTracking(t){for(const e of this.listeners)e.onStartTracking&&this.hr.schedule((()=>e.onStartTracking(t)))}emitArtificialPageViewEnd(){for(const t of this.listeners)if(t.onArtificialPageViewEnd)try{t.onArtificialPageViewEnd()}catch(t){qt.error(t)}}emitBeforeArtificialPageView(){for(const t of this.listeners)t.onBeforeArtificialPageView&&t.onBeforeArtificialPageView()}emitAfterArtificialPageView(){for(const t of this.listeners)t.onAfterArtificialPageView&&t.onAfterArtificialPageView()}emitBeforeSessionRenewal(){for(const t of this.listeners)t.onBeforeSessionRenewal&&t.onBeforeSessionRenewal()}emitAfterSessionRenewal(){for(const t of this.listeners)t.onAfterSessionRenewal&&t.onAfterSessionRenewal()}emitOptout(){for(const t of this.listeners)t.onOptout&&t.onOptout()}emitReplayUnanonymizationConsentGranted(){for(const t of this.listeners)t.onReplayUnanonymizationConsentGranted&&t.onReplayUnanonymizationConsentGranted()}emitReplayUnanonymizationConsentWithdrawn(){for(const t of this.listeners)t.onReplayUnanonymizationConsentWithdrawn&&t.onReplayUnanonymizationConsentWithdrawn()}emitAfterReplayRecordingConsentGranted(){for(const t of this.listeners)t.onAfterReplayRecordingConsentGranted&&t.onAfterReplayRecordingConsentGranted()}emitAfterReplayRecordingConsentWithdrawn(){for(const t of this.listeners)t.onAfterReplayRecordingConsentWithdrawn&&t.onAfterReplayRecordingConsentWithdrawn()}emitRecordingStateChange(t,e){for(const s of this.listeners)s.onRecordingStateChange&&s.onRecordingStateChange(t,e)}emitInitialDomStart(){for(const t of this.listeners)t.onInitialDomStart&&t.onInitialDomStart()}emitInitialDomDone(t){for(const e of this.listeners)e.onInitialDomDone&&e.onInitialDomDone(t)}emitRecordingStatusChange(){for(const t of this.listeners)t.onRecordingStatusChange&&t.onRecordingStatusChange()}emitBeforeVisitorRenewal(){for(const t of this.listeners)t.onBeforeVisitorRenewal&&t.onBeforeVisitorRenewal()}emitAfterVisitorCleared(){for(const t of this.listeners)t.onAfterVisitorCleared&&t.onAfterVisitorCleared()}emitAfterVisitorRenewal(){for(const t of this.listeners)t.onAfterVisitorRenewal&&t.onAfterVisitorRenewal()}}Zt([Ce("emitStartTracking")],Va.prototype,"emitStartTracking",null);const Wa="_cs_c";var Ba;!function(t){t[t.NOT_REQUIRED=0]="NOT_REQUIRED",t[t.NOT_EXPRESSED=1]="NOT_EXPRESSED",t[t.GRANTED=2]="GRANTED",t[t.WITHDRAWN=3]="WITHDRAWN"}(Ba||(Ba={}));class Ha{constructor(t,e,s){this.$=t,this.dp=e,this.Gp=s}get(){let t;return t=this.$.cookielessTrackingEnabled?this.Gp.getItem(Wa):this.dp.get(Wa),null===t?t:Number(t)}set(t){this.$.cookielessTrackingEnabled?this.Gp.setItem(Wa,csString(t)):this.dp.set(Wa,csString(t),F)}remove(){this.$.cookielessTrackingEnabled?this.Gp.removeItem(Wa):this.dp.delete(Wa)}handleSubdomainChange(){this.$.cookielessTrackingEnabled||(this.$.allowSubdomains?this.dp.delete(Wa,Jt.CURRENT_DOMAIN):this.dp.delete(Wa,this.dp.getRootDomain()))}}class Fa{constructor(t,e,s){this.$=t,this.W=e,this.Ls=s}grantReplayConsent(){if(!_n.isReplayConsentNeeded(this.$))return;const t=this.W.getSession();t?_n.isRecordingBlockedByConsent(t)&&(this.W.grantReplayRecording(t),this.Ls.emitAfterReplayRecordingConsentGranted()):this.W.grantReplayRecordingBeforeSessionStart()}withdrawReplayConsent(){if(!_n.isReplayConsentNeeded(this.$))return;const t=this.W.getSession();t?_n.isRecordingWithDrawn(t)||(this.W.withdrawnReplayRecording(t),this.Ls.emitAfterReplayRecordingConsentWithdrawn()):this.W.withdrawnReplayRecordingBeforeSessionStart()}}const qa=["replay:consent:unanonymized:granted","trackConsentGranted"],Ga=["replay:consent:unanonymized:withdrawn","trackConsentWithdrawn"],Ya=["replay:consent:startForSession:granted"],Za=["replay:consent:startForSession:withdrawn"];class ja{constructor(t,e,s,i,n){this.$=t,this.Wc=e,this.Hh=s,this.W=i,this.Ls=n}init(){this.Zp=new Fa(this.$,this.W,this.Ls),this.Hh.setInitialConsent(),this.Wp()}Wp(){this.Wc.register(qa,(()=>{this.Hh.grantReplayAnonymizationConsent()})),this.Wc.register(Ga,(()=>{this.Hh.withdrawReplayAnonymizationConsent()})),this.Wc.register(Ya,(()=>{this.Zp.grantReplayConsent()})),this.Wc.register(Za,(()=>{this.Zp.withdrawReplayConsent()}))}onOptout(){this.Hh.removeAllConsents()}onBeforeVisitorRenewal(){this.Hh.removeAllConsents()}onAfterVisitorRenewal(){this.Hh.setInitialConsent()}onAfterVisitorCleared(){this.Hh.setInitialConsent()}}class Xa{constructor(t,e,s){this.$=t,this.np=e,this.Ls=s}setInitialConsent(){const t=this.np.get();(null===t||this.hasConsentRequiredChanged(t))&&this.setDefaultReplayAnonymization()}hasConsentRequiredChanged(t){const e=this.$.consentRequired;return e&&t===Ba.NOT_REQUIRED||!e&&t!==Ba.NOT_REQUIRED}handleSubdomainChange(){this.np.handleSubdomainChange()}setDefaultReplayAnonymization(){const t=this.$.consentRequired?Ba.NOT_EXPRESSED:Ba.NOT_REQUIRED;this.np.set(t)}grantReplayAnonymizationConsent(){this.$.consentRequired&&(this.np.set(Ba.GRANTED),this.Ls.emitReplayUnanonymizationConsentGranted())}withdrawReplayAnonymizationConsent(){this.$.consentRequired&&(this.np.set(Ba.WITHDRAWN),this.Ls.emitReplayUnanonymizationConsentWithdrawn())}removeAllConsents(){this.np.remove()}isReplayUnanonymizedAllowedByConsent(){return!this.$.consentRequired||this.np.get()===Ba.GRANTED}getRequestParameters(){return{uc:`${this.np.get()}`}}}class Ka{constructor(t,e,s,i,n,r,o){this.Ls=t,this.Wc=e,this.zw=s,this.Fw=i,this.Bw=n,this.Kp=r,this.Hw=o}start(){this.Ls.addListener(this.Kp),this.Ls.addListener(this.Hw),this.Ls.addListener(this.zw),this.Hw.init(),this.Fw.init(),this.Bw.init(),this.Bw.isActive()||this.Wc.start()}}const Qa="_cs_ex",Ja=2592e6,th=/^[0-9]+$/;class eh{constructor(t,e,s){this.$=t,this.dp=e,this.fp=s}onCookieToSet(t){this.gp=t}onCookieToRemove(t){this.vp=t}get(){return this.$.cookielessTrackingEnabled?Number(this.fp.getItem(Qa)):Number(this.dp.get(Qa))}set(t){var e;this.$.cookielessTrackingEnabled?this.fp.setItem(Qa,t):(this.dp.set(Qa,t,Ja),null===(e=this.gp)||void 0===e||e.call(this,Qa,t,Ja))}remove(){var t;this.$.cookielessTrackingEnabled?this.fp.removeItem(Qa):(this.dp.delete(Qa),null===(t=this.vp)||void 0===t||t.call(this,Qa))}static isValidExclusionString(t){return th.test(t)}}class sh{constructor(t,e){this.Vn=t,this.np=e}exclude(t){this.np.set(csString(t.lastTrackingDraw))}removeExclusion(){this.np.remove()}isExcluded(){return this.Yp()||this.Qp()}Yp(){return 0!==this.getAppliedTrackingDraw()}getAppliedTrackingDraw(){return this.np.get()}Qp(){return csString.prototype.indexOf.call(this.Vn.href,Qa)>0}}class ih{constructor(t){this.Ua=t}onOptout(){this.Ua.removeExclusion()}}var nh;!function(t){t.SessionReplay="SR",t.None=""}(nh||(nh={}));class rh{constructor(t){this.X=t,this.Jp=new RegExp(".^")}setExcludeUrlForSessionReplay(t){this.Jp=new RegExp(t)}Xp(){return this.Jp.test(this.X.getAnonymizedUrl())?nh.SessionReplay:nh.None}isUrlExcludedForSessionReplay(){return this.Xp()===nh.SessionReplay}getRequestParameters(){return{ex:this.Xp()}}}const oh=["excludeURLforReplay"];class ah{constructor(t,e){this.Ua=t,this.Wc=e}init(){this.Wc.register(oh,(t=>{mt(t)&&this.Ua.setExcludeUrlForSessionReplay(t)}))}}const hh="_cs_inc";class ch{constructor(t,e){this.Vn=t,this.dp=e}isForceIncluded(){return this.tm()||this.sm()}isForceReplayRecorded(){return this.im(je.GLOBAL_SAMPLING)}tm(){return null!==this.dp.get(hh)}im(t){return this.dp.get(hh)===t}sm(){return csString.prototype.indexOf.call(this.Vn.href,hh)>0}}const lh="_cs_optout";class uh{constructor(t,e,s){this.$=t,this.dp=e,this.Gp=s}get(){return this.$.cookielessTrackingEnabled?this.Gp.getItem(lh):this.dp.get(lh)}set(t){this.$.cookielessTrackingEnabled?this.Gp.setItem(lh,t):this.dp.set(lh,t,F)}}class dh{constructor(t,e,s){this.Ls=t,this.Vn=e,this.np=s}init(){!this.isActive()&&this.nm()&&this.activate()}isActive(){return"1"===this.np.get()}activate(){this.Ls.emitOptout(),this.np.set("1")}nm(){return csString.prototype.indexOf.call(this.Vn.href,lh)>0}}const ph=["optout"];class gh{constructor(t,e){this.Wc=t,this.Bw=e}init(){this.Wc.register(ph,(()=>{this.Bw.activate()}))}}class mh{constructor(t,e){this.Wc=t,this.Ca=e}init(){this.Ca.addListener(this.Wc)}onOptout(){this.Wc.stop()}onBeforeSessionRenewal(){this.Wc.stop()}}var fh;!function(t){t.UXA="_uxa",t.WVT="cs_wvt"}(fh||(fh={}));class yh extends Ze{constructor(t){super(),this.rm=t,this.hm={}}register(t,e,s){for(const i of t)this.hm[i]={callback:e,configuration:s},this.hm}onStart(){this.om(),this.am()}onStop(){for(const t of this.rm)window[t]=[]}applyFromIntegration(t,e,s){this.isStarted?qt.tryToExecute(`Commands.apply.from.integration: ${s}`,(()=>{if(this.hm[t])return this.hm[t].callback(...e)}))():window._uxa.push([t,...e])}onIframeCommands(t){for(const e of t.commands)this.um(e.name,e.params,t.iframePath)}um(t,e,s){qt.tryToExecute(`Commands.apply.from.iframe: ${s}`,(()=>{if(this.hm[t])return this.hm[t].callback(...e)}))()}om(){for(const t of this.rm)window[t].forEach((([t,...e])=>this.lm(t,e,!1)))}am(){for(const t of this.rm)window[t]={push:([t,...e])=>this.lm(t,e,!0)}}lm(t,e,s){var i,n;if(this.hm[t]){if((null===(i=this.hm[t].configuration)||void 0===i?void 0:i.disableApplyPending)&&!s||(null===(n=this.hm[t].configuration)||void 0===n?void 0:n.disableApplyImmediate)&&s)return;try{return this.hm[t].callback(...e)}catch(s){qt.error(`Command ${t} failed - params: ${csJSON.stringify(e)}`,s)}}}}class Eh{constructor(t,e,s,i){this.$=t,this.Z=e,this.W=s,this.dm=i}getRequestParameters(){var t;const e={v:"13.89.2",...this.$.getRequestParameters()},s=this.W.getSession();s&&(e.pn=`${s.pageNumber}`);const i=this.Z.getVisitor();return i&&(e.sn=`${i.visitsCount}`,e.uu=`${i.id}`),(null===(t=this.dm)||void 0===t?void 0:t.hasSubProjectId())&&(e.subProjectID=`${this.dm.getSubProjectId()}`),e}}class Sh{constructor(t,e){this.Wc=t,this.V=e}init(){this.Wc.register(["debugEvents"],(t=>{"boolean"==typeof t&&this.V.updateDynamicFields("emitDebugEvents",t)}))}}class vh{constructor(t,e){this.Vn=t,this.Xc=e}overridePath(t){yt(t)&&mt(t)&&(this.fm=""===t?void 0:t)}overrideQuery(t){yt(t)&&mt(t)&&(this.wm=t)}computeOverriddenUrl(t){return this.pm(t)?this.getAnonymizedUrl():t}pm(t){const e=this.Em(this.Vn.href);return this.Em(t)===e}Em(t){return e=t,-1!==csString.prototype.indexOf.call(e,"/",e.length-1)?csString.prototype.slice.call(t,0,-1):t;var e}getAnonymizedUrl(){const t=function(t,e,s){if(!yt(e)&&!yt(s))return t.href;const i=yt(e)?function(t){return H(t,"/")?t:`/${t}`}(e):t.pathname,n=yt(s)?function(t){return H(t,"?")||""===t?t:`?${t}`}(s):t.search;return`${t.protocol}//${t.host}${i}${n}`}(this.Vn,this.fm,this.wm);return this.Xc.anonymizeUrl(t,[])}getUrlProtocol(){return this.Vn.protocol}getRequestParameters(){return{url:this.getAnonymizedUrl()}}}class wh extends za{emitPageEvent(t){for(const e of this.listeners)e.onPageEvent&&e.onPageEvent(t)}emitEventTriggerRecording(t,e){for(const s of this.listeners)s.onEventTriggerRecording&&s.onEventTriggerRecording(t,e)}emitCustomJavaScriptErrorEvent(t){for(const e of this.listeners)e.onCustomJavaScriptErrorEvent&&e.onCustomJavaScriptErrorEvent(t)}emitCustomErrorEvent(t){for(const e of this.listeners)e.onCustomErrorEvent&&e.onCustomErrorEvent(t)}emitUserIdentifierEvent(t){for(const e of this.listeners)e.onUserIdentifierEvent&&e.onUserIdentifierEvent(t)}}class Rh{constructor(t,e,s,i,n){this.configuration=t,this.ym=e,this.Ls=s,this.sp=i,this.X=n,this.Am=[]}init(){this.gm()}sanitizeSessionRecordingState(t){return t.recordingState===je.TEMPORARILY_RECORDED&&(t.recordingState=je.NOT_RECORDED),t}computeInitialRecordingState(t){return _n.isReplayConsentNeeded(this.configuration)?je.BLOCKED_BY_CONSENT_NOT_EXPRESSED:this.xp(t)}computeInitialRecordingStateFromRecordingConsentGranted(t){return this.xp(t)}xp(t){return en.isRecordingSupported()?(this.Am=[],q.percentage()<this.configuration.replayRecordingRate||this.sp.isForceReplayRecorded()?csArray.prototype.push.call(this.Am,je.GLOBAL_SAMPLING):this.configuration.malkaUrlEnabled&&csArray.prototype.push.call(this.Am,je.URL_SAMPLING),this.configuration.malkaEtrEnabled&&csArray.prototype.push.call(this.Am,je.ETR_SAMPLING),this.Am.length>0?(this.vm(t),je.TEMPORARILY_RECORDED):je.NOT_RECORDED):je.NOT_RECORDED}updateRecordingState(t){return en.isRecordingSupported()?_n.isRecordingBlockedByConsent(t)?t.recordingState===je.BLOCKED_BY_CONSENT_WITHDRAWN?je.BLOCKED_BY_CONSENT_WITHDRAWN:je.BLOCKED_BY_CONSENT_NOT_EXPRESSED:t.recordingState===je.GLOBAL_SAMPLING?je.GLOBAL_SAMPLING:(this.Am=[],this.configuration.malkaUrlEnabled&&(csArray.prototype.push.call(this.Am,je.URL_SAMPLING),this.configuration.malkaEtrEnabled&&csArray.prototype.push.call(this.Am,je.ETR_SAMPLING)),this.Am.length>0?(this.vm(t),je.TEMPORARILY_RECORDED):je.NOT_RECORDED):je.NOT_RECORDED}vm(t){var e;const s=null===(e=this.Z)||void 0===e?void 0:e.getVisitor();this.ym.send({recordingTypes:csArray.prototype.map.call(this.Am,Number),url:this.X.getAnonymizedUrl(),projectId:this.configuration.projectId,uu:(null==s?void 0:s.id)||"",sn:(null==s?void 0:s.visitsCount)||"",pn:(null==t?void 0:t.pageNumber)||""})}abortQuotaServiceRequest(){this.ym.abort()}isReplayRecorded(t){return!_n.isRecordingBlockedByConsent(t)&&(t.recordingState===je.TEMPORARILY_RECORDED||t.recordingState===je.GLOBAL_SAMPLING||t.recordingState===je.URL_SAMPLING||t.etrState===Xe.ETR_ON)}gm(){this.ym.onError((()=>this.quotaServiceErrorHandler("NetworkError"))),this.ym.onTimeout((()=>this.quotaServiceTimeoutHandler()),3e3),this.ym.onLoad((t=>this.quotaServiceLoadHandler(t)))}quotaServiceErrorHandler(t){this._m(`error - ${t}`)}quotaServiceTimeoutHandler(){this._m("timeout")}_m(t){let e=je.NOT_RECORDED;this.Rm(this.Am)?(e=je.GLOBAL_SAMPLING,qt.warn(`Quota Service: request ${t} - bypassed by GLOBAL_SAMPLING`)):qt.warn(`Quota Service: request ${t}`),this.Ls.emitRecordingStateChange(e,Xe.ETR_OFF)}quotaServiceLoadHandler(t){if(200!==t.status)return void this.quotaServiceErrorHandler(`Status code: ${t.status}`);let e;try{e=csJSON.parse(t.responseText)}catch(e){return void this.quotaServiceErrorHandler(`Unable to parse the quota service response: ${t.responseText}`)}const s=null==e.allowedRecordingTypes?void 0:csArray.prototype.map.call(e.allowedRecordingTypes,csString);if(!s)return void this.quotaServiceErrorHandler("recording types missing from quota service response");let i=Xe.ETR_OFF,n=je.NOT_RECORDED;this.Rm(s)?n=je.GLOBAL_SAMPLING:this.Sm(s)&&(n=je.URL_SAMPLING),this.Tm(s)&&(i=Xe.ETR_ON),this.Ls.emitRecordingStateChange(n,i)}Rm(t){return csArray.prototype.some.call(t,(t=>t===je.GLOBAL_SAMPLING))}Sm(t){return csArray.prototype.some.call(t,(t=>t===je.URL_SAMPLING))}Tm(t){return csArray.prototype.some.call(t,(t=>t===je.ETR_SAMPLING))}setVisitorService(t){this.Z=t}getDisabledRecordingState(){return je.NOT_RECORDED}getConsentWithdrawnRecordingState(){return je.BLOCKED_BY_CONSENT_WITHDRAWN}}Zt([Yt("Quota Service: onerror")],Rh.prototype,"quotaServiceErrorHandler",null),Zt([Yt("Quota Service: ontimeout")],Rh.prototype,"quotaServiceTimeoutHandler",null),Zt([Yt("Quota Service: onload")],Rh.prototype,"quotaServiceLoadHandler",null);const Ah="|iframe|";class Th extends za{constructor(t,e,s,i){super(),this.Im=t,this.Pm=e,this.bm=s,this.Vm=i}emitIframeEvent(t,e,s){if(this.Cm(e)&&null===t)qt.error(`iframeEventEmitter received event ${e} with null iframe, content:${csJSON.stringify(s)}`);else switch(e){case Vt.ChildLogMessage:this.Nm(s);break;case Vt.AnalysisEvent:{const e=this.Im.transformEvent(t,s);this.Om(e);break}case Vt.RecordingEvent:{const e=s,i=this.Vm.transformEvents(t,e);if(0===i.events.length)return;i.containsUserEvent?this.km(i.events):this.$m(i.events);break}case Vt.JavascriptError:this.Lm(s);break;case Vt.ApiError:this.xm(s);break;case Vt.DetailedApiError:this.Mm(s);break;case Vt.CustomError:this.Dm(s);break;case Vt.EmerchandisingMessage:{const e=this.bm.transformEvent(t,s);this.Um(e);break}case Vt.Commands:{const e=this.Pm.transformEvent(t,s);this.zm(e);break}case Vt.IntegrationCallback:this.Fm(s);break;case Vt.StaticResource:this.Bm(s);break;case Vt.TrackingContextRequestMessage:this.Hm(s);break;default:qt.error(`Parent received unknown data type from iframe : ${csJSON.stringify(s)}`)}}Cm(t){const e=[Vt.AnalysisEvent,Vt.RecordingEvent,Vt.EmerchandisingMessage,Vt.Commands];return-1!==csArray.prototype.indexOf.call(e,t)}Nm(t){const{message:e,errorCode:s,level:i}=t;switch(i){case X.debug:qt.debug(e,s);break;case X.warn:qt.warn(e,s);break;case X.error:qt.error(e,s);break;case X.critical:qt.critical(e,s)}}Om(t){for(const e of this.listeners)e.onIframeAnalysisEvent&&e.onIframeAnalysisEvent(t)}km(t){for(const e of this.listeners)e.onIframeRecordingUserEvent&&e.onIframeRecordingUserEvent(t)}$m(t){for(const e of this.listeners)e.onIframeRecordingBrowserEvent&&e.onIframeRecordingBrowserEvent(t)}Lm(t){for(const e of this.listeners)e.onIframeJavascriptError&&e.onIframeJavascriptError(t)}xm(t){for(const e of this.listeners)e.onIframeApiError&&e.onIframeApiError(t)}Mm(t){for(const e of this.listeners)e.onIframeDetailedApiError&&e.onIframeDetailedApiError(t)}Um(t){for(const e of this.listeners)e.onIframeEmerchandisingMessage&&e.onIframeEmerchandisingMessage(t)}zm(t){for(const e of this.listeners)e.onIframeCommands&&e.onIframeCommands(t)}Fm(t){for(const e of this.listeners)e.onIframeIntegrationCallback&&e.onIframeIntegrationCallback(t)}Bm(t){for(const e of this.listeners)e.onIframeStaticResource&&e.onIframeStaticResource(t)}Hm(t){for(const e of this.listeners)e.onTrackingContextRequestCallback&&e.onTrackingContextRequestCallback(t)}Dm(t){for(const e of this.listeners)e.onIframeCustomError&&e.onIframeCustomError(t)}}var _h;!function(t){t.COMPRESSION_DISABLED="compressionDisabled"}(_h||(_h={}));class bh{constructor(){}static init(t=document.cookie){var e;const s=null===(e=/_cs_debug=((\w|\.|\:|=)+)/g.exec(t))||void 0===e?void 0:e[1];if(this.qm=new Map,s){const t=csString.prototype.split.call(s,".");for(let e=0;e<t.length;e++){const[s,i]=csString.prototype.split.call(t[e],"=");this.qm.set(s,i||"true")}}}static getBoolean(t){const e=this.getString(t);return null!=e&&"false"!==e&&0!==parseInt(e)}static getString(t){var e;return null===(e=this.qm)||void 0===e?void 0:e.get(t)}static isCompressionEnabled(){return!this.getBoolean(_h.COMPRESSION_DISABLED)}static Log(t){return(e,s,i)=>{var n;const r=s.toString(),o=`${null===(n=e.constructor)||void 0===n?void 0:n.name}.${r}`,a=i.value;(function(t,e){var s;return null!=t&&(t===e||!!(null===(s=csString.prototype.match.call(t,new RegExp("(^|,)("+e+")(,|$)")))||void 0===s?void 0:s.length))})(bh.getString("debugLog"),t)&&(i.value=function(...t){return console.log(o,...t),a.bind(this)(...t)})}}}function Ch(){function t(t){let e=t.length;for(;--e>=0;)t[e]=0}const e=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),s=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),i=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),n=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),r=new Array(576);t(r);const o=new Array(60);t(o);const a=new Array(512);t(a);const h=new Array(256);t(h);const c=new Array(29);t(c);const l=new Array(30);function u(t,e,s,i,n){this.static_tree=t,this.extra_bits=e,this.extra_base=s,this.elems=i,this.max_length=n,this.has_stree=t&&t.length}let d,p,g;function m(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}t(l);const f=t=>t<256?a[t]:a[256+(t>>>7)],y=(t,e)=>{t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255},E=(t,e,s)=>{t.bi_valid>16-s?(t.bi_buf|=e<<t.bi_valid&65535,y(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=s-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=s)},S=(t,e,s)=>{E(t,s[2*e],s[2*e+1])},v=(t,e)=>{let s=0;do{s|=1&t,t>>>=1,s<<=1}while(--e>0);return s>>>1},w=(t,e,s)=>{const i=new Array(16);let n,r,o=0;for(n=1;n<=15;n++)i[n]=o=o+s[n-1]<<1;for(r=0;r<=e;r++){let e=t[2*r+1];0!==e&&(t[2*r]=v(i[e]++,e))}},R=t=>{let e;for(e=0;e<286;e++)t.dyn_ltree[2*e]=0;for(e=0;e<30;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0},A=t=>{t.bi_valid>8?y(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},T=(t,e,s,i)=>{const n=2*e,r=2*s;return t[n]<t[r]||t[n]===t[r]&&i[e]<=i[s]},_=(t,e,s)=>{const i=t.heap[s];let n=s<<1;for(;n<=t.heap_len&&(n<t.heap_len&&T(e,t.heap[n+1],t.heap[n],t.depth)&&n++,!T(e,i,t.heap[n],t.depth));)t.heap[s]=t.heap[n],s=n,n<<=1;t.heap[s]=i},b=(t,i,n)=>{let r,o,a,u,d=0;if(0!==t.last_lit)do{r=t.pending_buf[t.d_buf+2*d]<<8|t.pending_buf[t.d_buf+2*d+1],o=t.pending_buf[t.l_buf+d],d++,0===r?S(t,o,i):(a=h[o],S(t,a+256+1,i),u=e[a],0!==u&&(o-=c[a],E(t,o,u)),r--,a=f(r),S(t,a,n),u=s[a],0!==u&&(r-=l[a],E(t,r,u)))}while(d<t.last_lit);S(t,256,i)},C=(t,e)=>{const s=e.dyn_tree,i=e.stat_desc.static_tree,n=e.stat_desc.has_stree,r=e.stat_desc.elems;let o,a,h,c=-1;for(t.heap_len=0,t.heap_max=573,o=0;o<r;o++)0!==s[2*o]?(t.heap[++t.heap_len]=c=o,t.depth[o]=0):s[2*o+1]=0;for(;t.heap_len<2;)h=t.heap[++t.heap_len]=c<2?++c:0,s[2*h]=1,t.depth[h]=0,t.opt_len--,n&&(t.static_len-=i[2*h+1]);for(e.max_code=c,o=t.heap_len>>1;o>=1;o--)_(t,s,o);h=r;do{o=t.heap[1],t.heap[1]=t.heap[t.heap_len--],_(t,s,1),a=t.heap[1],t.heap[--t.heap_max]=o,t.heap[--t.heap_max]=a,s[2*h]=s[2*o]+s[2*a],t.depth[h]=(t.depth[o]>=t.depth[a]?t.depth[o]:t.depth[a])+1,s[2*o+1]=s[2*a+1]=h,t.heap[1]=h++,_(t,s,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],((t,e)=>{const s=e.dyn_tree,i=e.max_code,n=e.stat_desc.static_tree,r=e.stat_desc.has_stree,o=e.stat_desc.extra_bits,a=e.stat_desc.extra_base,h=e.stat_desc.max_length;let c,l,u,d,p,g,m=0;for(d=0;d<=15;d++)t.bl_count[d]=0;for(s[2*t.heap[t.heap_max]+1]=0,c=t.heap_max+1;c<573;c++)l=t.heap[c],d=s[2*s[2*l+1]+1]+1,d>h&&(d=h,m++),s[2*l+1]=d,l>i||(t.bl_count[d]++,p=0,l>=a&&(p=o[l-a]),g=s[2*l],t.opt_len+=g*(d+p),r&&(t.static_len+=g*(n[2*l+1]+p)));if(0!==m){do{for(d=h-1;0===t.bl_count[d];)d--;t.bl_count[d]--,t.bl_count[d+1]+=2,t.bl_count[h]--,m-=2}while(m>0);for(d=h;0!==d;d--)for(l=t.bl_count[d];0!==l;)u=t.heap[--c],u>i||(s[2*u+1]!==d&&(t.opt_len+=(d-s[2*u+1])*s[2*u],s[2*u+1]=d),l--)}})(t,e),w(s,c,t.bl_count)},N=(t,e,s)=>{let i,n,r=-1,o=e[1],a=0,h=7,c=4;for(0===o&&(h=138,c=3),e[2*(s+1)+1]=65535,i=0;i<=s;i++)n=o,o=e[2*(i+1)+1],++a<h&&n===o||(a<c?t.bl_tree[2*n]+=a:0!==n?(n!==r&&t.bl_tree[2*n]++,t.bl_tree[32]++):a<=10?t.bl_tree[34]++:t.bl_tree[36]++,a=0,r=n,0===o?(h=138,c=3):n===o?(h=6,c=3):(h=7,c=4))},O=(t,e,s)=>{let i,n,r=-1,o=e[1],a=0,h=7,c=4;for(0===o&&(h=138,c=3),i=0;i<=s;i++)if(n=o,o=e[2*(i+1)+1],!(++a<h&&n===o)){if(a<c)do{S(t,n,t.bl_tree)}while(0!=--a);else 0!==n?(n!==r&&(S(t,n,t.bl_tree),a--),S(t,16,t.bl_tree),E(t,a-3,2)):a<=10?(S(t,17,t.bl_tree),E(t,a-3,3)):(S(t,18,t.bl_tree),E(t,a-11,7));a=0,r=n,0===o?(h=138,c=3):n===o?(h=6,c=3):(h=7,c=4)}};let I=!1;const P=(t,e,s,i)=>{E(t,0+(i?1:0),3),((t,e,s)=>{A(t),y(t,s),y(t,~s),t.pending_buf.set(t.window.subarray(e,e+s),t.pending),t.pending+=s})(t,e,s)};var k={_tr_init:t=>{I||((()=>{let t,n,m,f,y;const E=new Array(16);for(m=0,f=0;f<28;f++)for(c[f]=m,t=0;t<1<<e[f];t++)h[m++]=f;for(h[m-1]=f,y=0,f=0;f<16;f++)for(l[f]=y,t=0;t<1<<s[f];t++)a[y++]=f;for(y>>=7;f<30;f++)for(l[f]=y<<7,t=0;t<1<<s[f]-7;t++)a[256+y++]=f;for(n=0;n<=15;n++)E[n]=0;for(t=0;t<=143;)r[2*t+1]=8,t++,E[8]++;for(;t<=255;)r[2*t+1]=9,t++,E[9]++;for(;t<=279;)r[2*t+1]=7,t++,E[7]++;for(;t<=287;)r[2*t+1]=8,t++,E[8]++;for(w(r,287,E),t=0;t<30;t++)o[2*t+1]=5,o[2*t]=v(t,5);d=new u(r,e,257,286,15),p=new u(o,s,0,30,15),g=new u(new Array(0),i,0,19,7)})(),I=!0),t.l_desc=new m(t.dyn_ltree,d),t.d_desc=new m(t.dyn_dtree,p),t.bl_desc=new m(t.bl_tree,g),t.bi_buf=0,t.bi_valid=0,R(t)},_tr_stored_block:P,_tr_flush_block:(t,e,s,i)=>{let a,h,c=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=(t=>{let e,s=4093624447;for(e=0;e<=31;e++,s>>>=1)if(1&s&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0})(t)),C(t,t.l_desc),C(t,t.d_desc),c=(t=>{let e;for(N(t,t.dyn_ltree,t.l_desc.max_code),N(t,t.dyn_dtree,t.d_desc.max_code),C(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*n[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e})(t),a=t.opt_len+3+7>>>3,h=t.static_len+3+7>>>3,h<=a&&(a=h)):a=h=s+5,s+4<=a&&-1!==e?P(t,e,s,i):4===t.strategy||h===a?(E(t,2+(i?1:0),3),b(t,r,o)):(E(t,4+(i?1:0),3),((t,e,s,i)=>{let r;for(E(t,e-257,5),E(t,s-1,5),E(t,i-4,4),r=0;r<i;r++)E(t,t.bl_tree[2*n[r]+1],3);O(t,t.dyn_ltree,e-1),O(t,t.dyn_dtree,s-1)})(t,t.l_desc.max_code+1,t.d_desc.max_code+1,c+1),b(t,t.dyn_ltree,t.dyn_dtree)),R(t),i&&A(t)},_tr_tally:(t,e,s)=>(t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&s,t.last_lit++,0===e?t.dyn_ltree[2*s]++:(t.matches++,e--,t.dyn_ltree[2*(h[s]+256+1)]++,t.dyn_dtree[2*f(e)]++),t.last_lit===t.lit_bufsize-1),_tr_align:t=>{E(t,2,3),S(t,256,r),(t=>{16===t.bi_valid?(y(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(t)}},L=(t,e,s,i)=>{let n=65535&t,r=t>>>16&65535,o=0;for(;0!==s;){o=s>2e3?2e3:s,s-=o;do{n=n+e[i++]|0,r=r+n|0}while(--o);n%=65521,r%=65521}return n|r<<16};const D=new Uint32Array((()=>{let t,e=[];for(var s=0;s<256;s++){t=s;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;e[s]=t}return e})());var M=(t,e,s,i)=>{const n=D,r=i+s;t^=-1;for(let s=i;s<r;s++)t=t>>>8^n[255&(t^e[s])];return~t},x={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},U={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:$,_tr_stored_block:z,_tr_flush_block:V,_tr_tally:W,_tr_align:B}=k,{Z_NO_FLUSH:H,Z_PARTIAL_FLUSH:F,Z_FULL_FLUSH:q,Z_FINISH:G,Z_BLOCK:Y,Z_OK:Z,Z_STREAM_END:j,Z_STREAM_ERROR:X,Z_DATA_ERROR:K,Z_BUF_ERROR:Q,Z_DEFAULT_COMPRESSION:J,Z_FILTERED:tt,Z_HUFFMAN_ONLY:et,Z_RLE:st,Z_FIXED:it,Z_DEFAULT_STRATEGY:nt,Z_UNKNOWN:rt,Z_DEFLATED:ot}=U,at=258,ht=262,ct=103,lt=113,ut=666,dt=(t,e)=>(t.msg=x[e],e),pt=t=>(t<<1)-(t>4?9:0),gt=t=>{let e=t.length;for(;--e>=0;)t[e]=0};let mt=(t,e,s)=>(e<<t.hash_shift^s)&t.hash_mask;const ft=t=>{const e=t.state;let s=e.pending;s>t.avail_out&&(s=t.avail_out),0!==s&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+s),t.next_out),t.next_out+=s,e.pending_out+=s,t.total_out+=s,t.avail_out-=s,e.pending-=s,0===e.pending&&(e.pending_out=0))},yt=(t,e)=>{V(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,ft(t.strm)},Et=(t,e)=>{t.pending_buf[t.pending++]=e},St=(t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e},vt=(t,e,s,i)=>{let n=t.avail_in;return n>i&&(n=i),0===n?0:(t.avail_in-=n,e.set(t.input.subarray(t.next_in,t.next_in+n),s),1===t.state.wrap?t.adler=L(t.adler,e,n,s):2===t.state.wrap&&(t.adler=M(t.adler,e,n,s)),t.next_in+=n,t.total_in+=n,n)},wt=(t,e)=>{let s,i,n=t.max_chain_length,r=t.strstart,o=t.prev_length,a=t.nice_match;const h=t.strstart>t.w_size-ht?t.strstart-(t.w_size-ht):0,c=t.window,l=t.w_mask,u=t.prev,d=t.strstart+at;let p=c[r+o-1],g=c[r+o];t.prev_length>=t.good_match&&(n>>=2),a>t.lookahead&&(a=t.lookahead);do{if(s=e,c[s+o]===g&&c[s+o-1]===p&&c[s]===c[r]&&c[++s]===c[r+1]){r+=2,s++;do{}while(c[++r]===c[++s]&&c[++r]===c[++s]&&c[++r]===c[++s]&&c[++r]===c[++s]&&c[++r]===c[++s]&&c[++r]===c[++s]&&c[++r]===c[++s]&&c[++r]===c[++s]&&r<d);if(i=at-(d-r),r=d-at,i>o){if(t.match_start=e,o=i,i>=a)break;p=c[r+o-1],g=c[r+o]}}}while((e=u[e&l])>h&&0!=--n);return o<=t.lookahead?o:t.lookahead},Rt=t=>{const e=t.w_size;let s,i,n,r,o;do{if(r=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-ht)){t.window.set(t.window.subarray(e,e+e),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,i=t.hash_size,s=i;do{n=t.head[--s],t.head[s]=n>=e?n-e:0}while(--i);i=e,s=i;do{n=t.prev[--s],t.prev[s]=n>=e?n-e:0}while(--i);r+=e}if(0===t.strm.avail_in)break;if(i=vt(t.strm,t.window,t.strstart+t.lookahead,r),t.lookahead+=i,t.lookahead+t.insert>=3)for(o=t.strstart-t.insert,t.ins_h=t.window[o],t.ins_h=mt(t,t.ins_h,t.window[o+1]);t.insert&&(t.ins_h=mt(t,t.ins_h,t.window[o+3-1]),t.prev[o&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=o,o++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<ht&&0!==t.strm.avail_in)},At=(t,e)=>{let s,i;for(;;){if(t.lookahead<ht){if(Rt(t),t.lookahead<ht&&e===H)return 1;if(0===t.lookahead)break}if(s=0,t.lookahead>=3&&(t.ins_h=mt(t,t.ins_h,t.window[t.strstart+3-1]),s=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==s&&t.strstart-s<=t.w_size-ht&&(t.match_length=wt(t,s)),t.match_length>=3)if(i=W(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=mt(t,t.ins_h,t.window[t.strstart+3-1]),s=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=mt(t,t.ins_h,t.window[t.strstart+1]);else i=W(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(yt(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,e===G?(yt(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(yt(t,!1),0===t.strm.avail_out)?1:2},Tt=(t,e)=>{let s,i,n;for(;;){if(t.lookahead<ht){if(Rt(t),t.lookahead<ht&&e===H)return 1;if(0===t.lookahead)break}if(s=0,t.lookahead>=3&&(t.ins_h=mt(t,t.ins_h,t.window[t.strstart+3-1]),s=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==s&&t.prev_length<t.max_lazy_match&&t.strstart-s<=t.w_size-ht&&(t.match_length=wt(t,s),t.match_length<=5&&(t.strategy===tt||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){n=t.strstart+t.lookahead-3,i=W(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=n&&(t.ins_h=mt(t,t.ins_h,t.window[t.strstart+3-1]),s=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,i&&(yt(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if(i=W(t,0,t.window[t.strstart-1]),i&&yt(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=W(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,e===G?(yt(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(yt(t,!1),0===t.strm.avail_out)?1:2};function _t(t,e,s,i,n){this.good_length=t,this.max_lazy=e,this.nice_length=s,this.max_chain=i,this.func=n}const bt=[new _t(0,0,0,0,((t,e)=>{let s=65535;for(s>t.pending_buf_size-5&&(s=t.pending_buf_size-5);;){if(t.lookahead<=1){if(Rt(t),0===t.lookahead&&e===H)return 1;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;const i=t.block_start+s;if((0===t.strstart||t.strstart>=i)&&(t.lookahead=t.strstart-i,t.strstart=i,yt(t,!1),0===t.strm.avail_out))return 1;if(t.strstart-t.block_start>=t.w_size-ht&&(yt(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===G?(yt(t,!0),0===t.strm.avail_out?3:4):(t.strstart>t.block_start&&(yt(t,!1),t.strm.avail_out),1)})),new _t(4,4,8,4,At),new _t(4,5,16,8,At),new _t(4,6,32,32,At),new _t(4,4,16,16,Tt),new _t(8,16,32,32,Tt),new _t(8,16,128,128,Tt),new _t(8,32,128,256,Tt),new _t(32,128,258,1024,Tt),new _t(32,258,258,4096,Tt)];function Ct(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=ot,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),gt(this.dyn_ltree),gt(this.dyn_dtree),gt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),gt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),gt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Nt=t=>{if(!t||!t.state)return dt(t,X);t.total_in=t.total_out=0,t.data_type=rt;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?42:lt,t.adler=2===e.wrap?0:1,e.last_flush=H,$(e),Z},Ot=t=>{const e=Nt(t);return e===Z&&(t=>{t.window_size=2*t.w_size,gt(t.head),t.max_lazy_match=bt[t.level].max_lazy,t.good_match=bt[t.level].good_length,t.nice_match=bt[t.level].nice_length,t.max_chain_length=bt[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0})(t.state),e},It=(t,e,s,i,n,r)=>{if(!t)return X;let o=1;if(e===J&&(e=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),n<1||n>9||s!==ot||i<8||i>15||e<0||e>9||r<0||r>it)return dt(t,X);8===i&&(i=9);const a=new Ct;return t.state=a,a.strm=t,a.wrap=o,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=n+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<n+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=3*a.lit_bufsize,a.level=e,a.strategy=r,a.method=s,Ot(t)};var Pt=It,kt=(t,e)=>t&&t.state?2!==t.state.wrap?X:(t.state.gzhead=e,Z):X,Lt=(t,e)=>{let s,i;if(!t||!t.state||e>Y||e<0)return t?dt(t,X):X;const n=t.state;if(!t.output||!t.input&&0!==t.avail_in||n.status===ut&&e!==G)return dt(t,0===t.avail_out?Q:X);n.strm=t;const r=n.last_flush;if(n.last_flush=e,42===n.status)if(2===n.wrap)t.adler=0,Et(n,31),Et(n,139),Et(n,8),n.gzhead?(Et(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),Et(n,255&n.gzhead.time),Et(n,n.gzhead.time>>8&255),Et(n,n.gzhead.time>>16&255),Et(n,n.gzhead.time>>24&255),Et(n,9===n.level?2:n.strategy>=et||n.level<2?4:0),Et(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(Et(n,255&n.gzhead.extra.length),Et(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(t.adler=M(t.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(Et(n,0),Et(n,0),Et(n,0),Et(n,0),Et(n,0),Et(n,9===n.level?2:n.strategy>=et||n.level<2?4:0),Et(n,3),n.status=lt);else{let e=ot+(n.w_bits-8<<4)<<8,s=-1;s=n.strategy>=et||n.level<2?0:n.level<6?1:6===n.level?2:3,e|=s<<6,0!==n.strstart&&(e|=32),e+=31-e%31,n.status=lt,St(n,e),0!==n.strstart&&(St(n,t.adler>>>16),St(n,65535&t.adler)),t.adler=1}if(69===n.status)if(n.gzhead.extra){for(s=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>s&&(t.adler=M(t.adler,n.pending_buf,n.pending-s,s)),ft(t),s=n.pending,n.pending!==n.pending_buf_size));)Et(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>s&&(t.adler=M(t.adler,n.pending_buf,n.pending-s,s)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73;if(73===n.status)if(n.gzhead.name){s=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>s&&(t.adler=M(t.adler,n.pending_buf,n.pending-s,s)),ft(t),s=n.pending,n.pending===n.pending_buf_size)){i=1;break}i=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,Et(n,i)}while(0!==i);n.gzhead.hcrc&&n.pending>s&&(t.adler=M(t.adler,n.pending_buf,n.pending-s,s)),0===i&&(n.gzindex=0,n.status=91)}else n.status=91;if(91===n.status)if(n.gzhead.comment){s=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>s&&(t.adler=M(t.adler,n.pending_buf,n.pending-s,s)),ft(t),s=n.pending,n.pending===n.pending_buf_size)){i=1;break}i=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,Et(n,i)}while(0!==i);n.gzhead.hcrc&&n.pending>s&&(t.adler=M(t.adler,n.pending_buf,n.pending-s,s)),0===i&&(n.status=ct)}else n.status=ct;if(n.status===ct&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&ft(t),n.pending+2<=n.pending_buf_size&&(Et(n,255&t.adler),Et(n,t.adler>>8&255),t.adler=0,n.status=lt)):n.status=lt),0!==n.pending){if(ft(t),0===t.avail_out)return n.last_flush=-1,Z}else if(0===t.avail_in&&pt(e)<=pt(r)&&e!==G)return dt(t,Q);if(n.status===ut&&0!==t.avail_in)return dt(t,Q);if(0!==t.avail_in||0!==n.lookahead||e!==H&&n.status!==ut){let s=n.strategy===et?((t,e)=>{let s;for(;;){if(0===t.lookahead&&(Rt(t),0===t.lookahead)){if(e===H)return 1;break}if(t.match_length=0,s=W(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,s&&(yt(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===G?(yt(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(yt(t,!1),0===t.strm.avail_out)?1:2})(n,e):n.strategy===st?((t,e)=>{let s,i,n,r;const o=t.window;for(;;){if(t.lookahead<=at){if(Rt(t),t.lookahead<=at&&e===H)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(n=t.strstart-1,i=o[n],i===o[++n]&&i===o[++n]&&i===o[++n])){r=t.strstart+at;do{}while(i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&n<r);t.match_length=at-(r-n),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(s=W(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(s=W(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),s&&(yt(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===G?(yt(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(yt(t,!1),0===t.strm.avail_out)?1:2})(n,e):bt[n.level].func(n,e);if(3!==s&&4!==s||(n.status=ut),1===s||3===s)return 0===t.avail_out&&(n.last_flush=-1),Z;if(2===s&&(e===F?B(n):e!==Y&&(z(n,0,0,!1),e===q&&(gt(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),ft(t),0===t.avail_out))return n.last_flush=-1,Z}return e!==G?Z:n.wrap<=0?j:(2===n.wrap?(Et(n,255&t.adler),Et(n,t.adler>>8&255),Et(n,t.adler>>16&255),Et(n,t.adler>>24&255),Et(n,255&t.total_in),Et(n,t.total_in>>8&255),Et(n,t.total_in>>16&255),Et(n,t.total_in>>24&255)):(St(n,t.adler>>>16),St(n,65535&t.adler)),ft(t),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?Z:j)},Dt=t=>{if(!t||!t.state)return X;const e=t.state.status;return 42!==e&&69!==e&&73!==e&&91!==e&&e!==ct&&e!==lt&&e!==ut?dt(t,X):(t.state=null,e===lt?dt(t,K):Z)},Mt=(t,e)=>{let s=e.length;if(!t||!t.state)return X;const i=t.state,n=i.wrap;if(2===n||1===n&&42!==i.status||i.lookahead)return X;if(1===n&&(t.adler=L(t.adler,e,s,0)),i.wrap=0,s>=i.w_size){0===n&&(gt(i.head),i.strstart=0,i.block_start=0,i.insert=0);let t=new Uint8Array(i.w_size);t.set(e.subarray(s-i.w_size,s),0),e=t,s=i.w_size}const r=t.avail_in,o=t.next_in,a=t.input;for(t.avail_in=s,t.next_in=0,t.input=e,Rt(i);i.lookahead>=3;){let t=i.strstart,e=i.lookahead-2;do{i.ins_h=mt(i,i.ins_h,i.window[t+3-1]),i.prev[t&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=t,t++}while(--e);i.strstart=t,i.lookahead=2,Rt(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,t.next_in=o,t.input=a,t.avail_in=r,i.wrap=n,Z};const xt=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var Ut=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const s=e.shift();if(s){if("object"!=typeof s)throw new TypeError(s+"must be non-object");for(const e in s)xt(s,e)&&(t[e]=s[e])}}return t},$t=t=>{let e=0;for(let s=0,i=t.length;s<i;s++)e+=t[s].length;const s=new Uint8Array(e);for(let e=0,i=0,n=t.length;e<n;e++){let n=t[e];s.set(n,i),i+=n.length}return s};let zt=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){zt=!1}const Vt=new Uint8Array(256);for(let t=0;t<256;t++)Vt[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;Vt[254]=Vt[254]=1;const Wt=(t,e=t.length)=>{if(e<65534&&t.subarray&&zt)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let s="";for(let i=0;i<e;i++)s+=String.fromCharCode(t[i]);return s};var Bt=t=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);let e,s,i,n,r,o=t.length,a=0;for(n=0;n<o;n++)s=t.charCodeAt(n),55296==(64512&s)&&n+1<o&&(i=t.charCodeAt(n+1),56320==(64512&i)&&(s=65536+(s-55296<<10)+(i-56320),n++)),a+=s<128?1:s<2048?2:s<65536?3:4;for(e=new Uint8Array(a),r=0,n=0;r<a;n++)s=t.charCodeAt(n),55296==(64512&s)&&n+1<o&&(i=t.charCodeAt(n+1),56320==(64512&i)&&(s=65536+(s-55296<<10)+(i-56320),n++)),s<128?e[r++]=s:s<2048?(e[r++]=192|s>>>6,e[r++]=128|63&s):s<65536?(e[r++]=224|s>>>12,e[r++]=128|s>>>6&63,e[r++]=128|63&s):(e[r++]=240|s>>>18,e[r++]=128|s>>>12&63,e[r++]=128|s>>>6&63,e[r++]=128|63&s);return e},Ht=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const Ft=Object.prototype.toString,{Z_NO_FLUSH:qt,Z_SYNC_FLUSH:Gt,Z_FULL_FLUSH:Yt,Z_FINISH:Zt,Z_OK:jt,Z_STREAM_END:Xt,Z_DEFAULT_COMPRESSION:Kt,Z_DEFAULT_STRATEGY:Qt,Z_DEFLATED:Jt}=U;function te(t){this.options=Ut({level:Kt,method:Jt,chunkSize:16384,windowBits:15,memLevel:8,strategy:Qt},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ht,this.strm.avail_out=0;let s=Pt(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(s!==jt)throw new Error(x[s]);if(e.header&&kt(this.strm,e.header),e.dictionary){let t;if(t="string"==typeof e.dictionary?Bt(e.dictionary):"[object ArrayBuffer]"===Ft.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,s=Mt(this.strm,t),s!==jt)throw new Error(x[s]);this._dict_set=!0}}return te.prototype.push=function(t,e){const s=this.strm,i=this.options.chunkSize;let n,r;if(this.ended)return!1;for(r=e===~~e?e:!0===e?Zt:qt,"string"==typeof t?s.input=Bt(t):"[object ArrayBuffer]"===Ft.call(t)?s.input=new Uint8Array(t):s.input=t,s.next_in=0,s.avail_in=s.input.length;;)if(0===s.avail_out&&(s.output=new Uint8Array(i),s.next_out=0,s.avail_out=i),(r===Gt||r===Yt)&&s.avail_out<=6)this.onData(s.output.subarray(0,s.next_out)),s.avail_out=0;else{if(n=Lt(s,r),n===Xt)return s.next_out>0&&this.onData(s.output.subarray(0,s.next_out)),n=Dt(this.strm),this.onEnd(n),this.ended=!0,n===jt;if(0!==s.avail_out){if(r>0&&s.next_out>0)this.onData(s.output.subarray(0,s.next_out)),s.avail_out=0;else if(0===s.avail_in)break}else this.onData(s.output)}return!0},te.prototype.onData=function(t){this.chunks.push(t)},te.prototype.onEnd=function(t){t===jt&&(this.result=$t(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},(t,e,s)=>{let i=function(t,e){return(e=e||{}).gzip=!0,function(t,e){const s=new te(e=e||{});if(s.push(t,!0),s.err)throw s.msg||x[s.err];return s.result}(t,e)}(t);return i="base64"===e?btoa(Wt(i)):i.buffer,s&&s(i),i}}bh.init();class Nh extends le{constructor(t){super(t),this.algorithm=re.GZIP,this.jm=Ch(),this.Gm=(t,e,s)=>{s(this.jm(t,e))},this.compress=Oh(),"undefined"!=typeof CompressionStream&&Ie||(this.compress=this.Gm,this.getCompressorSourceCode=()=>Ch.toString())}compressSync(t,e){return this.jm(t,e)}getCompressorSourceCode(){return Oh.toString()}}function Oh(){return(t,e,s)=>{const i=new Response(t).body.pipeThrough(new CompressionStream("gzip")),n=new Response(i).arrayBuffer();"base64"!==e?n.then((t=>s(t))):n.then((t=>{return e=t,new Promise((t=>{const s=new FileReader;s.onload=e=>t(e.target.result.split(",")[1]),s.readAsDataURL(new Blob([e]))}));var e})).then((t=>s(t)))}}class Ih extends le{constructor(){super(...arguments),this.algorithm=re.UNCOMPRESSED}compress(t,e,s){s(this.compressSync(t,e))}compressSync(t,e){return t}getCompressorSourceCode(){return function(){return(t,e,s)=>s(t)}.toString()}}class Ph{static create(t){return this.instance?this.instance:bh.isCompressionEnabled()?this.instance=new Nh(t):new Ih(t)}}class kh{setItem(t,e){window.sessionStorage.setItem(t,e)}getItem(t){return window.sessionStorage.getItem(t)}removeItem(t){window.sessionStorage.removeItem(t)}}class Lh{setItem(t,e){window.localStorage.setItem(t,e)}getItem(t){return window.localStorage.getItem(t)}removeItem(t){window.localStorage.removeItem(t)}}const Dh="_cs_cvars";class Mh{constructor(t,e,s){this.$=t,this.dp=e,this.fp=s}onCookieToSet(t){this.gp=t}onCookieToRemove(t){this.vp=t}get(){return this.$.cookielessTrackingEnabled?this.fp.getItem(Dh):this.dp.get(Dh)}set(t){var e;this.$.cookielessTrackingEnabled?this.fp.setItem(Dh,t):(this.dp.set(Dh,t),null===(e=this.gp)||void 0===e||e.call(this,Dh,t))}remove(){var t;this.$.cookielessTrackingEnabled?this.fp.removeItem(Dh):(this.dp.delete(Dh),null===(t=this.vp)||void 0===t||t.call(this,Dh))}static isValidCustomVarString(t){return"string"==typeof t}}const xh=["visit",2],Uh=["page",3],$h=["nextPageOnly",4];class zh{constructor(t,e){this.L=t,this.np=e,this.Zm={},this.Wm={}}set(t,e,s,i){let n,r;if(t>0&&Et(e)&&Et(s)&&!St(e)&&!St(s)){const o=this.L.anonymizePII(csString(e)),a=this.L.anonymizePII(csString(s));if(n=[csString.prototype.slice.call(o,0,512),csString.prototype.slice.call(a,0,255)],r=""!==s,!yt(i)||csArray.prototype.indexOf.call(xh,i)>=0){const e=this.getCustomVariablesSession();r?e[t]=n:delete e[t],this.setCustomVariableSession(e)}(!yt(i)||csArray.prototype.indexOf.call(Uh,i)>=0)&&(r?this.Zm[t]=n:delete this.Zm[t]),yt(i)&&csArray.prototype.indexOf.call($h,i)>=0&&(r?this.Wm[t]=n:delete this.Wm[t])}}getCustomVariablesSession(){const t=this.np.get();if(!t)return{};const e=window.csJSON.parse(t);return null!==e&&ft(e)?e:{}}setCustomVariableSession(t){this.np.set(window.csJSON.stringify(t))}removeCustomVariablesSession(){this.np.remove()}removeCustomVariablesPage(){this.Zm={}}getRequestParameters(){const t=this.getCustomVariablesSession();for(const t in this.Wm)this.Wm.hasOwnProperty(t)&&(this.Zm[t]=this.Wm[t]);for(const e in this.Zm)this.Zm.hasOwnProperty(e)&&(t[e]=this.Zm[e]);if(window.csJSON.stringify(t).length<=2)return{};const e={cvars:this.Km(t)};return this.Zm&&window.csJSON.stringify(this.Zm).length>2&&(e.cvarp=this.Km(this.Zm)),e}deleteNextPageOnlyCustomVariables(){if(Object.keys(this.Wm).length>0)for(const t in this.Wm)this.Wm[t]===this.Zm[t]&&(delete this.Zm[t],delete this.Wm[t])}Km(t){for(const s in t)if(t.hasOwnProperty(s)){const i=parseInt(s,10),n=t[s],r=n[0],o=n[1];(!(gt(e=i)&&e>=1&&e<=20)||r.length>512||o.length>255)&&delete t[s]}var e;const s=function(t){let e;for(e in t)return!1;return!0}(t)?[]:t;return window.csJSON.stringify(s)}}const Vh=["setCustomVariable"];class Wh{constructor(t,e){this.Wc=t,this.rs=e}init(){this.Wc.register(Vh,((t,e,s,i)=>{this.rs.set(t,e,s,i)}))}onAfterArtificialPageView(){this.rs.deleteNextPageOnlyCustomVariables()}onAfterNaturalPageView(){this.rs.deleteNextPageOnlyCustomVariables()}onOptout(){this.rs.removeCustomVariablesSession()}onBeforeVisitorRenewal(){this.rs.removeCustomVariablesSession(),this.rs.removeCustomVariablesPage()}}const Bh="_cs_id",Hh=/^(([a-z0-9\-])+(\.[0-9]+){6})(\.(None|Lax|X)\.(0|1))?(\.[0-1])?$/;class Fh{constructor(t,e,s){this.$=t,this.dp=e,this.fp=s}onCookieToSet(t){this.gp=t}onCookieToRemove(t){this.vp=t}get(){let t;return t=this.$.cookielessTrackingEnabled?this.fp.getItem(Bh):this.dp.get(Bh),t?Fh.fromString(t):null}set(t){var e;const s=Fh.toString(t);if(this.$.cookielessTrackingEnabled)this.fp.setItem(Bh,s);else{const i=new csDate(t.expires);this.dp.set(Bh,s,i),null===(e=this.gp)||void 0===e||e.call(this,Bh,s,i)}}remove(){var t;this.$.cookielessTrackingEnabled?this.fp.removeItem(Bh):(this.dp.delete(Bh),null===(t=this.vp)||void 0===t||t.call(this,Bh))}handleSubdomainChange(){if(this.$.cookielessTrackingEnabled)return;const t=this.get();t&&(t.allowSubdomains=this.$.allowSubdomains,this.$.allowSubdomains?this.dp.delete(Bh,Jt.CURRENT_DOMAIN):this.dp.delete(Bh,this.dp.getRootDomain()),this.set(t))}static fromString(t){const[e,s,i,n,r,o,a,h]=csString.prototype.split.call(t,".");return{id:e,creationTimestamp:Number(s),visitsCount:Number(i),hitTimestamp:Number(n),lastVisitTimestamp:Number(r),appliedTrackingDraw:Number(o),expires:Number(a),allowSubdomains:void 0===h?void 0:!!Number(h)}}static toString(t){return csArray.prototype.join.call([t.id,t.creationTimestamp,t.visitsCount,t.hitTimestamp,t.lastVisitTimestamp,t.appliedTrackingDraw,t.expires,t.allowSubdomains?1:0],".")}static isValidVisitorString(t){return Hh.test(t)}}class qh{constructor(t){this.L=t}getUrlMaskingPattern(t){const e=[],s=csString.prototype.split.call(t,"/");for(const t of s)H(t,qh.Ym)?csArray.prototype.push.call(e,{key:t,value:`CS_ANONYMIZED_${csString.prototype.toUpperCase.call(csString.prototype.slice.call(t,1))}`}):csArray.prototype.push.call(e,{key:t,value:null});return e}anonymizeUrl(t,e){let s=this.L.anonymizePII(t);return s=this.L.anonymizeJwt(s),e.length>0?this.Qm(s,e):s}removeQueryString(t){const{path:e,queryString:s}=this.Jm(t);return""!==s?`${e}?`:e}Jm(t){const e=csString.prototype.indexOf.call(t,"?");let s="",i="";return-1!==e?(s=csString.prototype.slice.call(t,0,e),i=csString.prototype.slice.call(t,e,t.length)):s=t,{path:s,queryString:i}}Qm(t,e){const{path:s,queryString:i}=this.Jm(t),n=csString.prototype.split.call(s,"/");for(const t of e){const e=this.Xm(n,t);if(null!==e)return`${e}${i}`}return t}Xm(t,e){if(t.length<e.length)return null;let s="";for(let i=0;i<t.length;i+=1)if(i>=e.length)s+=`${t[i]}/`;else if(H(e[i].key,qh.Ym))s+=`${e[i].value}/`;else{if(t[i]!==e[i].key)return null;s+=`${t[i]}/`}return csString.prototype.slice.call(s,0,-1)}}qh.Ym=":";class Gh{constructor(t,e){this.Wa=t,this.$=e}getEventTargetPath(t){const e=Ne(t);return this.Wa.getElementPath(e,{dynamicIdRegex:this.$.dynamicIdRegex,...this.$.pathComputationRules})}getEventTargetPathAndTargetLink(t){const e=Ne(t),{path:s,firstAnchorParent:i}=this.Wa.getElementPathAndFirstAnchorParent(e,{dynamicIdRegex:this.$.dynamicIdRegex,...this.$.pathComputationRules});return{path:s,targetLink:this.tE(i)?i.href:""}}hasValidEventTarget(t){const e=Ne(t);return this.Wa.isValidElement(e)}getElementPath(t){return this.Wa.getElementPath(t,{dynamicIdRegex:this.$.dynamicIdRegex,...this.$.pathComputationRules})}tE(t){var e;return null!==t&&t.hasAttribute("href")&&!H(null!==(e=t.getAttribute("href"))&&void 0!==e?e:"","#")}}class Yh{constructor(t){this.Uu=t}transformEvent(t,e){const s=this.sE(t,e),i=this.Uu.getElementPath(t);return this.iE(i,s)}sE(t,e){if(function(t){return void 0!==t.x&&void 0!==t.y}(e)){const s=t.getBoundingClientRect();e.x=Math.round(s.left+e.x+ws.windowOffsetX()),e.y=Math.round(s.top+e.y+ws.windowOffsetY())}return e}iE(t,e){return er(e)&&(e.tgt=`${t}${Ah}${e.tgt}`),function(t){return void 0!==t.tgtHM}(e)&&(e.tgtHM=`${t}${Ah}${e.tgtHM}`),function(t){return void 0!==t.tgtLk}(e)&&(e.tgtLk=`${t}${Ah}${e.tgtLk}`),e}}class Zh{constructor(t){this.Uu=t}transformEvent(t,e){const s=this.Uu.getElementPath(t);return{iframePath:e.iframePath?`${s}${Ah}${e.iframePath}`:s,commands:e.commands}}}class jh{constructor(t){this.Uu=t}transformEvent(t,e){if(0===e.products.length)return e;const s=this.Uu.getElementPath(t),i=csArray.prototype.map.call(e.products,(t=>({...t,targetPath:`${s}${Ah}${t.targetPath}`})));return{...e,products:i}}}class Xh{constructor(t){this.cs=t,this.eE={clientX:2,clientY:3},this.nE={clientX:1,clientY:2},this.rE=[oe.POINTER_DOWN,oe.POINTER_MOVE,oe.POINTER_UP],this.hE=[oe.TOUCH_START,oe.TOUCH_MOVE,oe.TOUCH_END]}transformEvents(t,e){if(!Ts.isConnected(t))return e.events=csArray.prototype.filter.call(e.events,(t=>t.type!==oe.VISIBILITY_CHANGE)),0===e.events.length||(qt.warn(`IframeRecordingEventsTransformer received event ${Vt.RecordingEvent}\n        from disconnected iframe, content:${csJSON.stringify(e.events)}`),e.events=[]),e;const s=this.cs.getId(t);if(void 0===s)return qt.error(`IframeRecordingEventsTransformer received event ${Vt.RecordingEvent}\n        from unidentified iframe, content:${csJSON.stringify(e.events)}`),e.events=[],e;let i=null;csArray.prototype.some.call(e.events,(t=>this.oE(t)||this.cE(t)))&&(i=t.getBoundingClientRect());for(const t of e.events)this.oE(t)?this.aE(i,t):this.cE(t)&&this.uE(i,t),t.context=t.context&&t.context.length>0?`${s}/${t.context}`:`${s}`;return e}uE(t,e){this.lE(this.nE,t,e)}aE(t,e){this.lE(this.eE,t,e)}lE(t,e,s){s.args&&(s.args[t.clientX]=Math.round(e.left+s.args[t.clientX]),s.args[t.clientY]=Math.round(e.top+s.args[t.clientY]))}oE(t){return-1!==csArray.prototype.indexOf.call(this.rE,t.type)}cE(t){return-1!==csArray.prototype.indexOf.call(this.hE,t.type)}}class Kh{constructor(t){this.dE=t}start(){this.dE.onEvent((t=>this.$e(t))),this.dE.start()}stop(){this.dE.stop()}$e(t){const e=`Content Security Policy error. Violated directive: ${t.violatedDirective} - Source file: ${t.sourceFile}`;qt.warn(e)}}class Qh{constructor(){this.fE={boundElement:document,type:"securitypolicyviolation",listener:t=>this.securityPolicyViolationListener(t)}}start(){ge(this.fE)}stop(){me(this.fE)}onEvent(t){this.zs=t}wE(t){if(!t)return!1;const e=t.disposition;return mt(t.sourceFile)&&csArray.prototype.some.call(Qh.pE,(e=>csString.prototype.indexOf.call(t.sourceFile,e)>0))&&"report"!==e}securityPolicyViolationListener(t){this.wE(t)&&this.zs({violatedDirective:t.violatedDirective,sourceFile:t.sourceFile})}}Qh.pE=["contentsquare","cdnssl.clicktale.net"],Zt([Yt("Event handler type: securitypolicyviolation")],Qh.prototype,"securityPolicyViolationListener",null);class Jh{init(){this.mE=new Kh(new Qh),this.mE.start()}onOptout(){this.mE.stop()}}class tc{constructor(t,e,s,i){this.$=t,this.tt=e,this.M=s,this.hr=i}init(){let t,e,s,i,n,r,o,a,h,c,l,u,d,p,g,m,f,y,E,S,v,w,R,A,T,_,b,C,N,O,I,P,k;this.hr.schedule((()=>{t=new Va(this.hr),e=new at,s=new qh(e),n=new vh(window.location,s),i=new Jt(this.$,n,this.tt),i.init()})),this.hr.schedule((()=>{r=new kh,o=new Lh,y=new ch(window.location,i),(new Jh).init(),E=Ph.create(qt.warn),f=new de(E);const e=f.create(`${this.$.getQuotaServiceUri()}/quota`,!0);c=new Rh(this.$,e,t,y,n),c.init()})),this.hr.schedule((()=>{a=new Ma(this.$,i,r),h=new xa(a,c)})),this.hr.schedule((()=>{l=new Fh(this.$,i,r),u=new Na(this.$,l,h,t),this.M.setContext(u,h),c.setVisitorService(u)})),this.hr.schedule((()=>{k=new Xa(this.$,new Ha(this.$,i,o),t),d=new $a(u,h,k),p=new eh(this.$,i,r),g=new sh(window.location,p),m=new ih(g),S=new Ua(this.$,u,g);const s=new pn;I=new Gh(V,this.$),_=new Yh(I),b=new Zh(I),C=new jh(I),N=new Xh(s),O=new Th(_,b,C,N),T=new yh([fh.UXA]),v=new mh(T,O),w=new rh(n),R=new ah(w,T);const a=new Mh(this.$,i,r);P=new zh(e,a),A=new Wh(T,P),new pe(u,h,g,P,this.$)})),this.hr.schedule((()=>{new Ca(this.$,u,g,S,d,void 0,void 0,y).compute((r=>{this.hr.schedule((()=>{v.init();const a=new wh,c=new ja(this.$,T,k,h,t),l=new uh(this.$,i,o),d=new dh(t,window.location,l),p=new gh(T,d),g=new Sh(T,this.$),y=new Eh(this.$,u,h,void 0);r?(t.emitInitTracking(),new ba(y,E,u,h,t,T,v,this.$,p,d,c,k,e,I,s,n,g,a,O,P,A,w,R,this.hr,f).start()):new Ka(t,T,v,p,d,m,c).start()}))}))}))}}var ec,sc;!function(t){let e;const s={loadBundle(t){const o=t.source,a=t.data;if(n(a)){const n=()=>{!function(t,e){const s=document.createElement("script");s.type="text/javascript",s.async=!0,s.src=t,s.onload=e,s.charset="utf-8",document.head.appendChild(s)}(i("{domain}/tag/tag.bundle.js?v={version}",a),(()=>o.postMessage("csBundleLoaded",t.origin)))};e=a.token,c(s.loadBundle),r(t.origin)?n():function(t,e){const s=function(t){const e=document.createElement("iframe");return e.src=t,e.id="content-square-bridge",e.setAttribute("style","display: none !important; visibility: hidden !important;"),e}(i("{domain}/tag/bridge.html?v={version}#{token}",t)),n=t=>{t.source===s.contentWindow&&"TOKEN_VALID"===t.data&&(c(n),s.remove(),e())};h(n),document.head.appendChild(s)}(a,n)}}};function i(t,e){return csString.prototype.replace.call(csString.prototype.replace.call(csString.prototype.replace.call(t,"{version}",e.version),"{token}",e.token),"{domain}",e.domain)}function n(t){return t&&"csBundleInjection"===t.type&&r(t.domain)&&a(t.version)&&o(t.token)}function r(t){return/^https?:\/\/[a-zA-Z0-9\.\-]+\.(content-square\.fr|contentsquare\.com|csq\.io)$/.test(t)}function o(t){return/^[a-zA-Z0-9]+$/.test(t)}function a(t){return/^[a-zA-Z0-9\.]+$/.test(t)}function h(t){window.addEventListener("message",t,!1)}function c(t){window.removeEventListener("message",t,!1)}t.getToken=function(){return e},t.isAuthorizedIncomingMessage=n,t.isAuthorizedDomain=r,t.isAuthorizedToken=o,t.isAuthorizedTagVersion=a,t.isActivable=function(){const t=window.opener||window.parent;return window!==t&&window.addEventListener},t.waitForBundleInjection=function(){h(s.loadBundle)},t.listen=h,t.removeListener=c}(ec||(ec={})),function(t){const e=window.opener||window.parent,s=[/^https:\/\/app\.contentsquare\.com$/,/^https:\/\/dev-app\.contentsquare\.com$/,/^https:\/\/staging-app\.contentsquare\.com$/,/^https:\/\/.*\.test\.contentsquare\.com$/,/^https:\/\/app\.[a-z0-9-]+\.csiab\.[a-z0-9-]+\.csq\.io$/];let i;const n={ping(t){"ping"===t.data&&r(t.origin)&&(i=t.origin,h(n.ping),a(n.insertMessageScript),o(`utils.js?cb=${(new csDate).getTime()}`))},insertMessageScript:c((t=>{const e=t.data;"string"==typeof e&&"ping"!==e&&(h(n.insertMessageScript),o(e))}))};function r(t){return csArray.prototype.some.call(s,(e=>e.test(t)))}function o(t,e){const s=document.createElement("script");s.type="text/javascript",s.async=!0;const n=csString.prototype.replace.call(i,/^https?:/,"");s.src=`${n}/tag/${t}`,s.onload=e,s.charset="utf-8",document.getElementsByTagName("head")[0].appendChild(s)}function a(t){window.addEventListener("message",t,!1)}function h(t){window.removeEventListener("message",t,!1)}function c(t){return function(e){e.origin===i&&t(e)}}t.getToken=function(){return ec.getToken()},t.isActivable=function(){return window!==e&&window.addEventListener},t.isAuthorizedDomain=r,t.waitForConnection=function(){a(n.ping),ec.waitForBundleInjection()},t.listen=a,t.removeListener=h,t.secureListener=c,t.post=function(t){i&&e.postMessage(t,i)}}(sc||(sc={}));const ic=window.CSFrameCommunication||sc;class nc{constructor(t,e,s){this.$=t,this.Et=e,this.M=s}start(){var t,e,s,i,n;if(window.UXAnalytics)return;const r=new zo(!!(null===(t=this.$.taskSchedulerOptions)||void 0===t?void 0:t.enabled),null===(e=this.$.taskSchedulerOptions)||void 0===e?void 0:e.maxProcessingTime,null===(s=this.$.taskSchedulerOptions)||void 0===s?void 0:s.waitDuration),o=new ee(this.Et,this.$);o.init();const a=new se(this.$,o);if(this.Et.isTopWindowTracker()&&a.canTrack()){if((null===(i=window.CSProtectnativeFunctionsLogs)||void 0===i?void 0:i.Warning)&&qt.warn(`protectNativeFunctions failed: ${window.CSProtectnativeFunctionsLogs.Warning}`),null===(n=window.CSProtectnativeFunctionsLogs)||void 0===n?void 0:n.Critical)return void qt.error(`protectNativeFunctions failed: ${window.CSProtectnativeFunctionsLogs.Critical}`);new tc(this.$,o,this.M,r).init()}window.UXAnalytics={},!window.CSFrameCommunication&&ic.isActivable()&&(window.CSFrameCommunication=ic,ic.waitForConnection())}}var rc;Zt([Ce("main.start"),Yt("main.start")],nc.prototype,"start",null),function(t){t.isCSJavascriptBridgeDefined=function(){return"object"==typeof window.CSJavascriptBridge&&"function"==typeof window.CSJavascriptBridge.optIn&&"function"==typeof window.CSJavascriptBridge.optOut&&"function"==typeof window.CSJavascriptBridge.sendEvent&&"function"==typeof window.CSJavascriptBridge.sendDynamicVar&&"function"==typeof window.CSJavascriptBridge.sendTransaction},t.getBridgeVersion=function(){if("function"==typeof window.CSJavascriptBridge.getVersion)try{const t=window.CSJavascriptBridge.getVersion();if(pt(t))return t}catch(t){qt.warn("an error occurred when calling getVersion")}return null},t.notifyIsReadyForTracking=function(){"function"==typeof window.CSJavascriptBridge.onWebviewTrackingReady&&window.CSJavascriptBridge.onWebviewTrackingReady()},t.sendAnalysisEvent=function(t){window.CSJavascriptBridge.sendEvent(csJSON.stringify(t))},t.sendSREvent=function(t){if(window.CSJavascriptBridge.sendSREvent)for(const e of t.events)window.CSJavascriptBridge.sendSREvent(csJSON.stringify(e))},t.sendLog=function(t){window.CSJavascriptBridge&&window.CSJavascriptBridge.sendLog&&window.CSJavascriptBridge.sendLog(csJSON.stringify(t))},t.sendOptIn=function(){window.CSJavascriptBridge.optIn()},t.sendOptOut=function(){window.CSJavascriptBridge.optOut()},t.sendDynamicVariable=function(t,e){window.CSJavascriptBridge.sendDynamicVar(t,e)},t.sendTransaction=function(t,e,s){window.CSJavascriptBridge.sendTransaction(t,e,s)},t.sendAssets=function(t,e){if(window.CSJavascriptBridge.sendAssets){const s=csJSON.stringify(t);window.CSJavascriptBridge.sendAssets(s,e||null)}else window.CSJavascriptBridge.sendSRAssets&&window.CSJavascriptBridge.sendSRAssets(csArray.prototype.map.call(t,(t=>t.assetId)))},t.sendNativeSREvent=function(t){window.CSJavascriptBridge&&window.CSJavascriptBridge.sendNativeSREvent&&window.CSJavascriptBridge.sendNativeSREvent(csJSON.stringify(t))}}(rc||(rc={}));class oc{constructor(){}send(t,e,s=X.warn){const i={message:t,errorCode:e,level:s};rc.sendLog(i)}}try{const t=new Z(window.CS_CONF);window._uxa=window._uxa||[],t.processOptionOverrides(window._uxa);const e=new j(window,t);e.init();const s=new Ht;if(Gt=qt,qt.computeIsActive(t.validationRate),e.isTopWindowTracker()){const e=new bt(t,s);qt.setStrategy(e)}else if(e.isInIframeContext()){const e=new Bt(t);qt.setStrategy(e)}else if(e.isInWebViewContext()){const t=new oc;qt.setStrategy(t)}!function(t=50,e=.1){Te=qt.isPerfLoggingActive()&&function(){var t;if(!(null===(t=window.performance)||void 0===t?void 0:t.mark))return!1;const e="isPerformanceMeasureSupported",s=`${e}_a`;return performance.mark(s),void 0!==performance.measure(e,s)}(),Te&&(Re=t,Ae=e)}(),new nc(t,e,s).start()}catch{}})();